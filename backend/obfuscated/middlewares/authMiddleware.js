const a0_0x5d8bce=a0_0x88a1;(function(_0x12fd52,_0x56f33b){const _0x38ab6f=a0_0x88a1,_0x55026f=_0x12fd52();while(!![]){try{const _0x22c52f=parseInt(_0x38ab6f(0x98))/0x1*(-parseInt(_0x38ab6f(0x8b))/0x2)+-parseInt(_0x38ab6f(0x80))/0x3+-parseInt(_0x38ab6f(0x6a))/0x4+parseInt(_0x38ab6f(0x72))/0x5*(parseInt(_0x38ab6f(0x69))/0x6)+-parseInt(_0x38ab6f(0x7c))/0x7*(-parseInt(_0x38ab6f(0x97))/0x8)+parseInt(_0x38ab6f(0x7d))/0x9*(-parseInt(_0x38ab6f(0x7e))/0xa)+-parseInt(_0x38ab6f(0x85))/0xb*(-parseInt(_0x38ab6f(0x68))/0xc);if(_0x22c52f===_0x56f33b)break;else _0x55026f['push'](_0x55026f['shift']());}catch(_0x355f90){_0x55026f['push'](_0x55026f['shift']());}}}(a0_0xd38f,0xba49e),require('dotenv')[a0_0x5d8bce(0x92)]());function a0_0xd38f(){const _0x5dcaf2=['MnfXW','headers','error','HclwP','user','1143625UxhmoA','386037jnkZZB','210MniLrh','whrdR','3540702idHlsh','❌\x20Token\x20extraction\x20failed\x20from\x20Authorization\x20header.','status','Bearer\x20','rFKhO','55429AstNGN','SELECT\x20token\x20FROM\x20AuthTokens\x20ORDER\x20BY\x20id\x20DESC\x20LIMIT\x201','Unauthorized:\x20No\x20token\x20provided','TYTcU','❌\x20Could\x20not\x20retrieve\x20stored\x20token\x20from\x20DB:','json','1640878GNdTTY','❌\x20Token\x20verification\x20failed:','❌\x20No\x20stored\x20token\x20found.','oCcBK','SdqcD','startsWith','ezBAk','config','YWlvs','warn','Unauthorized:\x20Invalid\x20token\x20format','KNFHl','8HCnrVf','1jleLDD','GJWHZ','Internal\x20server\x20error','8460dQvhAU','1950MVZBaF','791924vfLlpf','Server\x20error\x20while\x20verifying\x20token','Unauthorized:\x20Token\x20mismatch','token','../db/localDB','UVJEy','message','nbHhE','2255PvtYVw','oUNmA','❌\x20No\x20Authorization\x20header\x20received.','❌\x20Error\x20fetching\x20token:','fqHYD'];a0_0xd38f=function(){return _0x5dcaf2;};return a0_0xd38f();}function a0_0x88a1(_0x5862d6,_0x4035e0){const _0xd38f4=a0_0xd38f();return a0_0x88a1=function(_0x88a1ff,_0x3940f6){_0x88a1ff=_0x88a1ff-0x67;let _0x6c1498=_0xd38f4[_0x88a1ff];return _0x6c1498;},a0_0x88a1(_0x5862d6,_0x4035e0);}const db=require(a0_0x5d8bce(0x6e)),getStoredToken=()=>{const _0x3dd64e=a0_0x5d8bce,_0x15996e={'oUNmA':_0x3dd64e(0x75),'oCcBK':function(_0x5049e6,_0x4afa68){return _0x5049e6(_0x4afa68);},'whrdR':'Database\x20Error','HclwP':_0x3dd64e(0x8d),'UUjWz':'No\x20stored\x20token\x20found.','KNFHl':_0x3dd64e(0x86)};return new Promise((_0x254f48,_0x57fca5)=>{const _0x4f737d=_0x3dd64e;db['get'](_0x15996e[_0x4f737d(0x96)],[],(_0x301b08,_0x463441)=>{const _0x131948=_0x4f737d;if(_0x301b08)return console[_0x131948(0x79)](_0x15996e[_0x131948(0x73)],_0x301b08[_0x131948(0x70)]),_0x15996e[_0x131948(0x8e)](_0x57fca5,_0x15996e[_0x131948(0x7f)]);if(!_0x463441||!_0x463441[_0x131948(0x6d)])return console[_0x131948(0x79)](_0x15996e[_0x131948(0x7a)]),_0x57fca5(_0x15996e['UUjWz']);_0x15996e['oCcBK'](_0x254f48,_0x463441['token']);});});},verifyAuthToken=async(_0x1b96a1,_0x1d7ec6,_0x233087)=>{const _0x2afc1b=a0_0x5d8bce,_0x2ec4e7={'nbHhE':_0x2afc1b(0x74),'fqHYD':_0x2afc1b(0x87),'SdqcD':_0x2afc1b(0x81),'TYTcU':_0x2afc1b(0x95),'XyBlc':function(_0x289c75){return _0x289c75();},'UVJEy':_0x2afc1b(0x89),'GJWHZ':_0x2afc1b(0x6b),'YWlvs':function(_0x19dd1a,_0x1ee2fa){return _0x19dd1a!==_0x1ee2fa;},'TDqBc':'❌\x20Provided\x20token\x20does\x20not\x20match\x20stored\x20token.','MnfXW':_0x2afc1b(0x6c),'ezBAk':function(_0x81c421){return _0x81c421();},'rFKhO':_0x2afc1b(0x8c),'XEaAQ':_0x2afc1b(0x67)};try{const _0xb5b1b0=_0x1b96a1[_0x2afc1b(0x78)]['authorization'];if(!_0xb5b1b0)return console[_0x2afc1b(0x79)](_0x2ec4e7[_0x2afc1b(0x71)]),_0x1d7ec6['status'](0x191)[_0x2afc1b(0x8a)]({'message':_0x2ec4e7[_0x2afc1b(0x76)]});const _0x55ae63=_0xb5b1b0[_0x2afc1b(0x90)](_0x2afc1b(0x83))?_0xb5b1b0['split']('\x20')[0x1]:_0xb5b1b0;if(!_0x55ae63)return console[_0x2afc1b(0x79)](_0x2ec4e7[_0x2afc1b(0x8f)]),_0x1d7ec6['status'](0x191)[_0x2afc1b(0x8a)]({'message':_0x2ec4e7[_0x2afc1b(0x88)]});let _0x542366;try{_0x542366=await _0x2ec4e7['XyBlc'](getStoredToken);}catch(_0x56f704){return console['error'](_0x2ec4e7[_0x2afc1b(0x6f)],_0x56f704),_0x1d7ec6[_0x2afc1b(0x82)](0x1f4)[_0x2afc1b(0x8a)]({'message':_0x2ec4e7[_0x2afc1b(0x99)]});}if(_0x2ec4e7[_0x2afc1b(0x93)](_0x542366,_0x55ae63))return console[_0x2afc1b(0x94)](_0x2ec4e7['TDqBc']),_0x1d7ec6['status'](0x191)['json']({'message':_0x2ec4e7[_0x2afc1b(0x77)]});_0x1b96a1[_0x2afc1b(0x7b)]={'token':_0x55ae63},_0x2ec4e7[_0x2afc1b(0x91)](_0x233087);}catch(_0x2bd782){return console[_0x2afc1b(0x79)](_0x2ec4e7[_0x2afc1b(0x84)],_0x2bd782['message']),_0x1d7ec6[_0x2afc1b(0x82)](0x1f4)['json']({'message':_0x2ec4e7['XEaAQ']});}};module['exports']={'verifyAuthToken':verifyAuthToken};