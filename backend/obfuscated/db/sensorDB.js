const a2_0x3378f7=a2_0xc116;function a2_0xc116(_0x43258b,_0x5d9dcd){const _0x237610=a2_0x2376();return a2_0xc116=function(_0xc116ce,_0x2a585c){_0xc116ce=_0xc116ce-0xf3;let _0xc3caa2=_0x237610[_0xc116ce];return _0xc3caa2;},a2_0xc116(_0x43258b,_0x5d9dcd);}(function(_0x5e6f6a,_0x22792c){const _0x1f0662=a2_0xc116,_0x4fe849=_0x5e6f6a();while(!![]){try{const _0xeba052=-parseInt(_0x1f0662(0x125))/0x1*(-parseInt(_0x1f0662(0x124))/0x2)+-parseInt(_0x1f0662(0x11f))/0x3+parseInt(_0x1f0662(0x10e))/0x4*(-parseInt(_0x1f0662(0x10b))/0x5)+parseInt(_0x1f0662(0xfc))/0x6+parseInt(_0x1f0662(0x117))/0x7+-parseInt(_0x1f0662(0x11a))/0x8+parseInt(_0x1f0662(0x10d))/0x9;if(_0xeba052===_0x22792c)break;else _0x4fe849['push'](_0x4fe849['shift']());}catch(_0x3ba12f){_0x4fe849['push'](_0x4fe849['shift']());}}}(a2_0x2376,0xdd735));const sqlite3=require(a2_0x3378f7(0x127))['verbose'](),dbPath=require(a2_0x3378f7(0xf3)),db=new sqlite3[(a2_0x3378f7(0x123))](dbPath,_0x59b8f4=>{const _0x3b9e53=a2_0x3378f7,_0x46c1fe={'YoOPV':_0x3b9e53(0x109),'wXczG':_0x3b9e53(0xfb),'tGAjC':_0x3b9e53(0x122)};_0x59b8f4?console['error']('‚ùå\x20Error\x20opening\x20database:',_0x59b8f4['message']):(console[_0x3b9e53(0xf7)](_0x46c1fe[_0x3b9e53(0x103)]),db['run'](_0x46c1fe[_0x3b9e53(0xf5)],_0x328cce=>{const _0x3e0119=_0x3b9e53;if(_0x328cce)console['error'](_0x46c1fe['YoOPV'],_0x328cce[_0x3e0119(0x100)]);else console['log'](_0x3e0119(0x106));}));}),createSensorBankTable=a2_0x3378f7(0x10a),createActiveSensorsTable='\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20LocalActiveSensors\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20bank_id\x20INTEGER\x20NOT\x20NULL\x20UNIQUE,\x20\x20--\x20‚úÖ\x20Add\x20UNIQUE\x20here!\x0a\x20\x20\x20\x20\x20\x20\x20\x20mode\x20TEXT\x20CHECK(\x20mode\x20IN\x20(\x27real_time\x27,\x20\x27manual\x27)\x20)\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20interval_seconds\x20INTEGER\x20CHECK(\x20interval_seconds\x20>=\x205\x20AND\x20interval_seconds\x20<=\x20100\x20),\x0a\x20\x20\x20\x20\x20\x20\x20\x20batch_size\x20INTEGER\x20DEFAULT\x201,\x0a\x20\x20\x20\x20\x20\x20\x20\x20is_active\x20BOOLEAN\x20DEFAULT\x201,\x0a\x20\x20\x20\x20\x20\x20\x20\x20created_at\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20\x20\x20updated_at\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(bank_id)\x20REFERENCES\x20LocalSensorBank(id)\x20ON\x20DELETE\x20CASCADE\x0a\x20\x20\x20\x20);\x0a',createSensorAPITable=a2_0x3378f7(0x115),createDesigoAuthTable=a2_0x3378f7(0x101),createSensorLogsTable=a2_0x3378f7(0x119),createUpdateTrigger='\x0a\x20\x20\x20\x20CREATE\x20TRIGGER\x20IF\x20NOT\x20EXISTS\x20update_timestamp\x0a\x20\x20\x20\x20AFTER\x20UPDATE\x20ON\x20LocalSensorBank\x0a\x20\x20\x20\x20FOR\x20EACH\x20ROW\x0a\x20\x20\x20\x20BEGIN\x0a\x20\x20\x20\x20\x20\x20\x20\x20UPDATE\x20LocalSensorBank\x20SET\x20updated_at\x20=\x20CURRENT_TIMESTAMP\x20WHERE\x20id\x20=\x20OLD.id;\x0a\x20\x20\x20\x20END;\x0a',createUpdateTriggerActive=a2_0x3378f7(0x10f);db['serialize'](()=>{const _0x23388b=a2_0x3378f7,_0x20e27d={'OIEkQ':_0x23388b(0x120),'cYLoQ':_0x23388b(0x11e),'fcJtf':_0x23388b(0xf6),'CyTjh':_0x23388b(0x121),'NzsOn':_0x23388b(0x108),'nZDjC':_0x23388b(0xf4),'WdXbg':_0x23388b(0x111),'lvQJl':'‚úÖ\x20Update\x20trigger\x20for\x20LocalActiveSensors\x20created.','jdYhc':_0x23388b(0x112),'QYgPH':'‚úÖ\x20DesigoAuthTokens\x20table\x20created\x20(or\x20already\x20exists).','DJlLi':'‚ùå\x20Error\x20creating\x20SensorLogs:','TBfLM':_0x23388b(0xf8)};db['run'](createSensorBankTable,_0x1db742=>{const _0x52b75b=_0x23388b;if(_0x1db742)console['error'](_0x20e27d['OIEkQ'],_0x1db742[_0x52b75b(0x100)]);else console['log']('‚úÖ\x20LocalSensorBank\x20table\x20created\x20(or\x20already\x20exists).');}),db[_0x23388b(0xff)](createActiveSensorsTable,_0x299cee=>{const _0xfb9804=_0x23388b;if(_0x299cee)console[_0xfb9804(0x11b)](_0x20e27d['cYLoQ'],_0x299cee['message']);else console[_0xfb9804(0xf7)](_0x20e27d[_0xfb9804(0x107)]);}),db[_0x23388b(0xff)](createSensorAPITable,_0x4c2987=>{const _0x50c5ae=_0x23388b;if(_0x4c2987)console[_0x50c5ae(0x11b)](_0x20e27d[_0x50c5ae(0x114)],_0x4c2987[_0x50c5ae(0x100)]);else console[_0x50c5ae(0xf7)](_0x20e27d[_0x50c5ae(0x11d)]);}),db['run'](createUpdateTrigger,_0x135ded=>{const _0x2dab52=_0x23388b;if(_0x135ded)console[_0x2dab52(0x11b)](_0x20e27d[_0x2dab52(0x116)],_0x135ded[_0x2dab52(0x100)]);else console[_0x2dab52(0xf7)](_0x20e27d[_0x2dab52(0xf9)]);}),db[_0x23388b(0xff)](createUpdateTriggerActive,_0x2cc240=>{const _0x4daea0=_0x23388b;if(_0x2cc240)console[_0x4daea0(0x11b)](_0x4daea0(0xf4),_0x2cc240[_0x4daea0(0x100)]);else console[_0x4daea0(0xf7)](_0x20e27d[_0x4daea0(0x110)]);}),db[_0x23388b(0xff)](createDesigoAuthTable,_0x320bfa=>{const _0x18997d=_0x23388b;if(_0x320bfa)console[_0x18997d(0x11b)](_0x20e27d[_0x18997d(0x104)],_0x320bfa[_0x18997d(0x100)]);else console[_0x18997d(0xf7)](_0x20e27d[_0x18997d(0x102)]);}),db[_0x23388b(0xff)](createSensorLogsTable,_0x3d4069=>{const _0x715125=_0x23388b;if(_0x3d4069)console[_0x715125(0x11b)](_0x20e27d['DJlLi'],_0x3d4069['message']);else console[_0x715125(0xf7)](_0x20e27d[_0x715125(0x11c)]);});});const createSensorDataTable=async(_0x42f56,_0x9b84bb)=>{const _0x266e5c={'jJqff':function(_0x446e7a,_0x400e2d){return _0x446e7a(_0x400e2d);},'JOFAh':function(_0x1e58d2){return _0x1e58d2();}};return new Promise((_0x147937,_0x74cccf)=>{const _0x3cf326=a2_0xc116,_0x2041e4=_0x3cf326(0x126)+_0x42f56+'_'+_0x9b84bb;console[_0x3cf326(0xf7)]('üìå\x20Creating\x20local\x20sensor\x20data\x20table:\x20'+_0x2041e4);const _0x17e770=_0x3cf326(0xfd)+_0x2041e4+'\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20sensor_id\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20value\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20quality\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20quality_good\x20BOOLEAN\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20timestamp\x20TIMESTAMP\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20sent_to_cloud\x20BOOLEAN\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(sensor_id)\x20REFERENCES\x20LocalActiveSensors(id)\x20ON\x20DELETE\x20CASCADE\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20);\x0a\x20\x20\x20\x20\x20\x20\x20\x20';db[_0x3cf326(0xff)](_0x17e770,_0x1af3c8=>{const _0xecdf86=_0x3cf326;_0x1af3c8?(console[_0xecdf86(0x11b)](_0xecdf86(0xfa)+_0x2041e4+':',_0x1af3c8['message']),_0x266e5c[_0xecdf86(0x105)](_0x74cccf,_0x1af3c8)):(console[_0xecdf86(0xf7)](_0xecdf86(0x10c)+_0x2041e4+_0xecdf86(0x118)),_0x266e5c[_0xecdf86(0xfe)](_0x147937));});});};function a2_0x2376(){const _0x4a06fb=['fcJtf','‚úÖ\x20LocalSensorAPIs\x20table\x20created\x20(or\x20already\x20exists).','‚ùå\x20Failed\x20to\x20enable\x20foreign\x20keys:','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20LocalSensorBank\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20name\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20description\x20TEXT\x20DEFAULT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20object_id\x20TEXT\x20UNIQUE\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20property_name\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20data_type\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20is_active\x20BOOLEAN\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20\x20\x20created_at\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20\x20\x20updated_at\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP\x0a\x20\x20\x20\x20);\x0a','25gGVfNc','‚úÖ\x20Table\x20','6306111nTqsdt','1151272PBZnKC','\x0a\x20\x20\x20\x20CREATE\x20TRIGGER\x20IF\x20NOT\x20EXISTS\x20update_timestamp_active\x0a\x20\x20\x20\x20AFTER\x20UPDATE\x20ON\x20LocalActiveSensors\x0a\x20\x20\x20\x20FOR\x20EACH\x20ROW\x0a\x20\x20\x20\x20BEGIN\x0a\x20\x20\x20\x20\x20\x20\x20\x20UPDATE\x20LocalActiveSensors\x20SET\x20updated_at\x20=\x20CURRENT_TIMESTAMP\x20WHERE\x20id\x20=\x20OLD.id;\x0a\x20\x20\x20\x20END;\x0a','lvQJl','‚úÖ\x20Update\x20trigger\x20for\x20LocalSensorBank\x20created.','‚ùå\x20Error\x20creating\x20DesigoAuthTokens:','exports','CyTjh','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20LocalSensorAPIs\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20sensor_id\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20api_endpoint\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(sensor_id)\x20REFERENCES\x20LocalSensorBank(id)\x20ON\x20DELETE\x20CASCADE\x0a\x20\x20\x20\x20);\x0a','nZDjC','7892360lkaDRo','\x20created.','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20SensorLogs\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20sensor_id\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20log\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20timestamp\x20DATETIME\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(sensor_id)\x20REFERENCES\x20LocalActiveSensors(bank_id)\x20ON\x20DELETE\x20CASCADE\x0a\x20\x20\x20\x20);\x0a','637344lKHWqO','error','TBfLM','NzsOn','‚ùå\x20Error\x20creating\x20LocalActiveSensors:','4141989EDQNgX','‚ùå\x20Error\x20creating\x20LocalSensorBank:','‚ùå\x20Error\x20creating\x20LocalSensorAPIs:','PRAGMA\x20foreign_keys\x20=\x20ON','Database','2347784VzFlHJ','1bBKcLM','SensorData_','sqlite3','./dbPath','‚ùå\x20Error\x20creating\x20update\x20trigger:','tGAjC','‚úÖ\x20LocalActiveSensors\x20table\x20created\x20(or\x20already\x20exists).','log','‚úÖ\x20SensorLogs\x20table\x20created\x20(or\x20already\x20exists).','WdXbg','‚ùå\x20Error\x20creating\x20','‚úÖ\x20Local\x20database\x20connected.','4826586BosNro','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20','JOFAh','run','message','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20DesigoAuthTokens\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20username\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20token\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20expires_at\x20TIMESTAMP\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20created_at\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP\x0a\x20\x20\x20\x20);\x0a','QYgPH','wXczG','jdYhc','jJqff','üîó\x20Foreign\x20key\x20enforcement\x20is\x20ON'];a2_0x2376=function(){return _0x4a06fb;};return a2_0x2376();}module[a2_0x3378f7(0x113)]={'db':db,'createSensorDataTable':createSensorDataTable};