const a0_0x1d2290=a0_0x3c06;(function(_0x3316dc,_0x456c9c){const _0x5c91d9=a0_0x3c06,_0x4aa29b=_0x3316dc();while(!![]){try{const _0x4cdb71=parseInt(_0x5c91d9(0x96))/0x1*(-parseInt(_0x5c91d9(0x7b))/0x2)+parseInt(_0x5c91d9(0x71))/0x3+parseInt(_0x5c91d9(0x7a))/0x4*(parseInt(_0x5c91d9(0x9a))/0x5)+-parseInt(_0x5c91d9(0x81))/0x6*(parseInt(_0x5c91d9(0x88))/0x7)+-parseInt(_0x5c91d9(0x9b))/0x8+-parseInt(_0x5c91d9(0xa2))/0x9*(parseInt(_0x5c91d9(0x91))/0xa)+parseInt(_0x5c91d9(0x73))/0xb;if(_0x4cdb71===_0x456c9c)break;else _0x4aa29b['push'](_0x4aa29b['shift']());}catch(_0x1a3b1c){_0x4aa29b['push'](_0x4aa29b['shift']());}}}(a0_0x27a9,0x42761));const sqlite3=require(a0_0x1d2290(0x7f))['verbose'](),dbPath=require('./dbPath'),db=new sqlite3['Database'](dbPath,_0x170be9=>{const _0x41a70e=a0_0x1d2290,_0x2df4f1={'MwtXs':'🔗\x20Foreign\x20key\x20enforcement\x20is\x20ON','qdRwE':_0x41a70e(0x83),'eMhLb':_0x41a70e(0x95),'GRrcj':_0x41a70e(0x84)};_0x170be9?console['error'](_0x2df4f1['qdRwE'],_0x170be9[_0x41a70e(0x8b)]):(console['log'](_0x2df4f1[_0x41a70e(0x87)]),db[_0x41a70e(0x9d)](_0x2df4f1[_0x41a70e(0x8e)],_0x484416=>{const _0x5f49bd=_0x41a70e;if(_0x484416)console['error'](_0x5f49bd(0xa4),_0x484416[_0x5f49bd(0x8b)]);else console[_0x5f49bd(0x8d)](_0x2df4f1[_0x5f49bd(0x9f)]);}));}),createSensorBankTable=a0_0x1d2290(0x92),createActiveSensorsTable=a0_0x1d2290(0x8c),createSensorAPITable=a0_0x1d2290(0x8f),createDesigoAuthTable=a0_0x1d2290(0x7e),createSensorLogsTable='\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20SensorLogs\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20sensor_id\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20log\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20timestamp\x20DATETIME\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(sensor_id)\x20REFERENCES\x20LocalActiveSensors(bank_id)\x20ON\x20DELETE\x20CASCADE\x0a\x20\x20\x20\x20);\x0a',createUpdateTrigger=a0_0x1d2290(0x80),createUpdateTriggerActive=a0_0x1d2290(0xa1);db[a0_0x1d2290(0x74)](()=>{const _0x3ccc8f=a0_0x1d2290,_0x527148={'LcuEw':_0x3ccc8f(0x9e),'CPkcA':_0x3ccc8f(0x99),'cPaDh':_0x3ccc8f(0xa0),'AxLPT':_0x3ccc8f(0x77),'MFFal':_0x3ccc8f(0x93),'IdPJm':_0x3ccc8f(0x7d),'svOPa':_0x3ccc8f(0xa3),'PgPpt':_0x3ccc8f(0xa5)};db[_0x3ccc8f(0x9d)](createSensorBankTable,_0x3c2b6c=>{const _0x141b24=_0x3ccc8f;if(_0x3c2b6c)console[_0x141b24(0x72)](_0x527148[_0x141b24(0x98)],_0x3c2b6c[_0x141b24(0x8b)]);else console['log'](_0x527148[_0x141b24(0x86)]);}),db['run'](createActiveSensorsTable,_0x4fbefe=>{const _0x3b32c8=_0x3ccc8f;if(_0x4fbefe)console['error'](_0x527148[_0x3b32c8(0x79)],_0x4fbefe[_0x3b32c8(0x8b)]);else console[_0x3b32c8(0x8d)](_0x527148[_0x3b32c8(0x78)]);}),db[_0x3ccc8f(0x9d)](createSensorAPITable,_0x32af65=>{const _0x3d7771=_0x3ccc8f;if(_0x32af65)console[_0x3d7771(0x72)](_0x3d7771(0x7c),_0x32af65['message']);else console[_0x3d7771(0x8d)](_0x527148[_0x3d7771(0x75)]);}),db[_0x3ccc8f(0x9d)](createUpdateTrigger,_0x1765a6=>{const _0x2c77a1=_0x3ccc8f;if(_0x1765a6)console['error'](_0x2c77a1(0x82),_0x1765a6[_0x2c77a1(0x8b)]);else console['log'](_0x2c77a1(0x89));}),db[_0x3ccc8f(0x9d)](createUpdateTriggerActive,_0x31dfdf=>{const _0x4643c5=_0x3ccc8f;if(_0x31dfdf)console[_0x4643c5(0x72)](_0x4643c5(0x82),_0x31dfdf[_0x4643c5(0x8b)]);else console['log'](_0x527148['IdPJm']);}),db[_0x3ccc8f(0x9d)](createDesigoAuthTable,_0x3b0b6d=>{const _0x33c2dc=_0x3ccc8f;if(_0x3b0b6d)console[_0x33c2dc(0x72)](_0x527148[_0x33c2dc(0x90)],_0x3b0b6d[_0x33c2dc(0x8b)]);else console[_0x33c2dc(0x8d)](_0x33c2dc(0x9c));}),db[_0x3ccc8f(0x9d)](createSensorLogsTable,_0x9ee6ea=>{const _0x3601fb=_0x3ccc8f;if(_0x9ee6ea)console[_0x3601fb(0x72)](_0x527148['PgPpt'],_0x9ee6ea[_0x3601fb(0x8b)]);else console[_0x3601fb(0x8d)](_0x3601fb(0x85));});});const createSensorDataTable=async(_0x51c709,_0x43db3f)=>{const _0x5b6283={'noYrd':function(_0x342402,_0xd4e230){return _0x342402(_0xd4e230);}};return new Promise((_0x46e9cd,_0x58440b)=>{const _0x90d415=a0_0x3c06,_0x43d47a={'TJgGf':function(_0xcf7e0f,_0x327dae){return _0x5b6283['noYrd'](_0xcf7e0f,_0x327dae);}},_0x2d0156='SensorData_'+_0x51c709+'_'+_0x43db3f;console['log'](_0x90d415(0x94)+_0x2d0156);const _0xeac23b=_0x90d415(0x76)+_0x2d0156+_0x90d415(0x97);db['run'](_0xeac23b,_0x278c45=>{const _0x5d9d88=_0x90d415;_0x278c45?(console[_0x5d9d88(0x72)]('❌\x20Error\x20creating\x20'+_0x2d0156+':',_0x278c45[_0x5d9d88(0x8b)]),_0x43d47a['TJgGf'](_0x58440b,_0x278c45)):(console[_0x5d9d88(0x8d)]('✅\x20Table\x20'+_0x2d0156+'\x20created.'),_0x46e9cd());});});};function a0_0x3c06(_0x3d5962,_0x1979f0){const _0x27a9a7=a0_0x27a9();return a0_0x3c06=function(_0x3c06bf,_0x3ff843){_0x3c06bf=_0x3c06bf-0x71;let _0x20ec9e=_0x27a9a7[_0x3c06bf];return _0x20ec9e;},a0_0x3c06(_0x3d5962,_0x1979f0);}function a0_0x27a9(){const _0x10a928=['✅\x20SensorLogs\x20table\x20created\x20(or\x20already\x20exists).','CPkcA','eMhLb','91FnxwIN','✅\x20Update\x20trigger\x20for\x20LocalSensorBank\x20created.','exports','message','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20LocalActiveSensors\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20bank_id\x20INTEGER\x20NOT\x20NULL\x20UNIQUE,\x20\x20--\x20✅\x20Add\x20UNIQUE\x20here!\x0a\x20\x20\x20\x20\x20\x20\x20\x20mode\x20TEXT\x20CHECK(\x20mode\x20IN\x20(\x27real_time\x27,\x20\x27manual\x27)\x20)\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20interval_seconds\x20INTEGER\x20CHECK(\x20interval_seconds\x20>=\x205\x20AND\x20interval_seconds\x20<=\x20100\x20),\x0a\x20\x20\x20\x20\x20\x20\x20\x20batch_size\x20INTEGER\x20DEFAULT\x201,\x0a\x20\x20\x20\x20\x20\x20\x20\x20is_active\x20BOOLEAN\x20DEFAULT\x201,\x0a\x20\x20\x20\x20\x20\x20\x20\x20created_at\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20\x20\x20updated_at\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(bank_id)\x20REFERENCES\x20LocalSensorBank(id)\x20ON\x20DELETE\x20CASCADE\x0a\x20\x20\x20\x20);\x0a','log','GRrcj','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20LocalSensorAPIs\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20sensor_id\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20api_endpoint\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20created_at\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(sensor_id)\x20REFERENCES\x20LocalSensorBank(id)\x20ON\x20DELETE\x20CASCADE\x0a\x20\x20\x20\x20);\x0a','svOPa','150070MIDwtB','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20LocalSensorBank\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20name\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20description\x20TEXT\x20DEFAULT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20object_id\x20TEXT\x20UNIQUE\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20property_name\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20data_type\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20is_active\x20BOOLEAN\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20\x20\x20created_at\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20\x20\x20updated_at\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP\x0a\x20\x20\x20\x20);\x0a','✅\x20LocalSensorAPIs\x20table\x20created\x20(or\x20already\x20exists).','📌\x20Creating\x20local\x20sensor\x20data\x20table:\x20','✅\x20Local\x20database\x20connected.','205LCBRbs','\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20sensor_id\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20value\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20quality\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20quality_good\x20BOOLEAN\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20timestamp\x20TIMESTAMP\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20sent_to_cloud\x20BOOLEAN\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(sensor_id)\x20REFERENCES\x20LocalActiveSensors(id)\x20ON\x20DELETE\x20CASCADE\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20);\x0a\x20\x20\x20\x20\x20\x20\x20\x20','LcuEw','✅\x20LocalSensorBank\x20table\x20created\x20(or\x20already\x20exists).','3495qZQlMe','3088768DKXtvO','✅\x20DesigoAuthTokens\x20table\x20created\x20(or\x20already\x20exists).','run','❌\x20Error\x20creating\x20LocalSensorBank:','MwtXs','❌\x20Error\x20creating\x20LocalActiveSensors:','\x0a\x20\x20\x20\x20CREATE\x20TRIGGER\x20IF\x20NOT\x20EXISTS\x20update_timestamp_active\x0a\x20\x20\x20\x20AFTER\x20UPDATE\x20ON\x20LocalActiveSensors\x0a\x20\x20\x20\x20FOR\x20EACH\x20ROW\x0a\x20\x20\x20\x20BEGIN\x0a\x20\x20\x20\x20\x20\x20\x20\x20UPDATE\x20LocalActiveSensors\x20SET\x20updated_at\x20=\x20CURRENT_TIMESTAMP\x20WHERE\x20id\x20=\x20OLD.id;\x0a\x20\x20\x20\x20END;\x0a','117GCvGVG','❌\x20Error\x20creating\x20DesigoAuthTokens:','❌\x20Failed\x20to\x20enable\x20foreign\x20keys:','❌\x20Error\x20creating\x20SensorLogs:','905022EBFtHo','error','9270514gfwUAQ','serialize','MFFal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20','✅\x20LocalActiveSensors\x20table\x20created\x20(or\x20already\x20exists).','AxLPT','cPaDh','2944NYeGaW','3670fzmdjF','❌\x20Error\x20creating\x20LocalSensorAPIs:','✅\x20Update\x20trigger\x20for\x20LocalActiveSensors\x20created.','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20DesigoAuthTokens\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20username\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20token\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20expires_at\x20TIMESTAMP\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20created_at\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP\x0a\x20\x20\x20\x20);\x0a','sqlite3','\x0a\x20\x20\x20\x20CREATE\x20TRIGGER\x20IF\x20NOT\x20EXISTS\x20update_timestamp\x0a\x20\x20\x20\x20AFTER\x20UPDATE\x20ON\x20LocalSensorBank\x0a\x20\x20\x20\x20FOR\x20EACH\x20ROW\x0a\x20\x20\x20\x20BEGIN\x0a\x20\x20\x20\x20\x20\x20\x20\x20UPDATE\x20LocalSensorBank\x20SET\x20updated_at\x20=\x20CURRENT_TIMESTAMP\x20WHERE\x20id\x20=\x20OLD.id;\x0a\x20\x20\x20\x20END;\x0a','198150SIqdDK','❌\x20Error\x20creating\x20update\x20trigger:','❌\x20Error\x20opening\x20database:','PRAGMA\x20foreign_keys\x20=\x20ON'];a0_0x27a9=function(){return _0x10a928;};return a0_0x27a9();}module[a0_0x1d2290(0x8a)]={'db':db,'createSensorDataTable':createSensorDataTable};