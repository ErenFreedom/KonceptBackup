const a0_0x5ef5b6=a0_0x571d;(function(_0x147144,_0x1843ff){const _0x4313c1=a0_0x571d,_0x4c7306=_0x147144();while(!![]){try{const _0xefd216=-parseInt(_0x4313c1(0x107))/0x1*(-parseInt(_0x4313c1(0xf4))/0x2)+-parseInt(_0x4313c1(0xf1))/0x3+parseInt(_0x4313c1(0x105))/0x4*(parseInt(_0x4313c1(0xf9))/0x5)+parseInt(_0x4313c1(0x103))/0x6+-parseInt(_0x4313c1(0xe6))/0x7+parseInt(_0x4313c1(0xee))/0x8+-parseInt(_0x4313c1(0xe7))/0x9;if(_0xefd216===_0x1843ff)break;else _0x4c7306['push'](_0x4c7306['shift']());}catch(_0x2db355){_0x4c7306['push'](_0x4c7306['shift']());}}}(a0_0x3cf0,0x97928));const sqlite3=require(a0_0x5ef5b6(0x106))[a0_0x5ef5b6(0xea)](),dbPath=require(a0_0x5ef5b6(0xec)),db=new sqlite3[(a0_0x5ef5b6(0x100))](dbPath,_0x27db6f=>{const _0xfc247e=a0_0x5ef5b6,_0x30fded={'hddeY':_0xfc247e(0xf8),'WKtwj':'‚ùå\x20Error\x20opening\x20database:','WGPdj':_0xfc247e(0xe5)};_0x27db6f?console[_0xfc247e(0xe8)](_0x30fded[_0xfc247e(0x109)],_0x27db6f[_0xfc247e(0x102)]):(console[_0xfc247e(0x10c)](_0x30fded['WGPdj']),db['run']('PRAGMA\x20foreign_keys\x20=\x20ON',_0x397608=>{const _0x2a358e=_0xfc247e;if(_0x397608)console[_0x2a358e(0xe8)](_0x2a358e(0xf5),_0x397608['message']);else console[_0x2a358e(0x10c)](_0x30fded[_0x2a358e(0xe9)]);}));}),createSensorBankTable='\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20LocalSensorBank\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20\x20\x20name\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20description\x20TEXT\x20DEFAULT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20object_id\x20TEXT\x20UNIQUE\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20property_name\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20data_type\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20is_active\x20BOOLEAN\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20\x20\x20room_id\x20INTEGER\x20DEFAULT\x20NULL,\x20\x20--\x20‚úÖ\x20Purely\x20informational\x0a\x20\x20\x20\x20\x20\x20\x20\x20created_at\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20\x20\x20updated_at\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP\x0a\x20\x20\x20\x20);\x0a',createActiveSensorsTable='\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20LocalActiveSensors\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20bank_id\x20INTEGER\x20NOT\x20NULL\x20UNIQUE,\x20\x20--\x20‚úÖ\x20Add\x20UNIQUE\x20here!\x0a\x20\x20\x20\x20\x20\x20\x20\x20mode\x20TEXT\x20CHECK(\x20mode\x20IN\x20(\x27real_time\x27,\x20\x27manual\x27)\x20)\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20interval_seconds\x20INTEGER\x20CHECK(\x20interval_seconds\x20>=\x205\x20AND\x20interval_seconds\x20<=\x20100\x20),\x0a\x20\x20\x20\x20\x20\x20\x20\x20batch_size\x20INTEGER\x20DEFAULT\x201,\x0a\x20\x20\x20\x20\x20\x20\x20\x20is_active\x20BOOLEAN\x20DEFAULT\x201,\x0a\x20\x20\x20\x20\x20\x20\x20\x20created_at\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20\x20\x20updated_at\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(bank_id)\x20REFERENCES\x20LocalSensorBank(id)\x20ON\x20DELETE\x20CASCADE\x0a\x20\x20\x20\x20);\x0a',createSensorAPITable='\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20LocalSensorAPIs\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20sensor_id\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20api_endpoint\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20created_at\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(sensor_id)\x20REFERENCES\x20LocalSensorBank(id)\x20ON\x20DELETE\x20CASCADE\x0a\x20\x20\x20\x20);\x0a',createDesigoAuthTable=a0_0x5ef5b6(0xfb),createSensorLogsTable=a0_0x5ef5b6(0xf7),createUpdateTrigger=a0_0x5ef5b6(0xef),createUpdateTriggerActive=a0_0x5ef5b6(0xf6);db[a0_0x5ef5b6(0x104)](()=>{const _0x5093c8=a0_0x5ef5b6,_0x50c81b={'lBAlH':_0x5093c8(0xf2),'Qnivb':_0x5093c8(0xe4),'UnNHn':_0x5093c8(0xed),'kKixd':_0x5093c8(0x10f),'gzQRn':_0x5093c8(0x10b),'EmMnd':_0x5093c8(0xfa),'DxmXR':_0x5093c8(0x110),'DibLB':_0x5093c8(0xf3)};db[_0x5093c8(0x112)](createSensorBankTable,_0x5a4f7f=>{const _0x37a37c=_0x5093c8;if(_0x5a4f7f)console[_0x37a37c(0xe8)]('‚ùå\x20Error\x20creating\x20LocalSensorBank:',_0x5a4f7f[_0x37a37c(0x102)]);else console['log'](_0x50c81b['lBAlH']);}),db[_0x5093c8(0x112)](createActiveSensorsTable,_0x167b3a=>{const _0x1544ba=_0x5093c8;if(_0x167b3a)console[_0x1544ba(0xe8)](_0x50c81b['Qnivb'],_0x167b3a['message']);else console[_0x1544ba(0x10c)](_0x1544ba(0xeb));}),db[_0x5093c8(0x112)](createSensorAPITable,_0x32e4ab=>{const _0x172947=_0x5093c8;if(_0x32e4ab)console['error'](_0x50c81b[_0x172947(0x115)],_0x32e4ab[_0x172947(0x102)]);else console[_0x172947(0x10c)](_0x50c81b[_0x172947(0xff)]);}),db[_0x5093c8(0x112)](createUpdateTrigger,_0x3121d5=>{const _0x3fe81a=_0x5093c8;if(_0x3121d5)console['error'](_0x50c81b[_0x3fe81a(0x113)],_0x3121d5[_0x3fe81a(0x102)]);else console[_0x3fe81a(0x10c)](_0x50c81b['EmMnd']);}),db['run'](createUpdateTriggerActive,_0x1d06cf=>{const _0x508900=_0x5093c8;if(_0x1d06cf)console[_0x508900(0xe8)](_0x50c81b['gzQRn'],_0x1d06cf[_0x508900(0x102)]);else console[_0x508900(0x10c)](_0x508900(0xfe));}),db[_0x5093c8(0x112)](createDesigoAuthTable,_0x5df6bd=>{const _0x44ec27=_0x5093c8;if(_0x5df6bd)console['error'](_0x44ec27(0x101),_0x5df6bd[_0x44ec27(0x102)]);else console['log'](_0x50c81b[_0x44ec27(0x10d)]);}),db[_0x5093c8(0x112)](createSensorLogsTable,_0x186f5d=>{const _0x228fe5=_0x5093c8;if(_0x186f5d)console[_0x228fe5(0xe8)](_0x50c81b[_0x228fe5(0x10e)],_0x186f5d[_0x228fe5(0x102)]);else console[_0x228fe5(0x10c)](_0x228fe5(0xfc));});});function a0_0x571d(_0x22b6d8,_0x4fc232){const _0x3cf0dd=a0_0x3cf0();return a0_0x571d=function(_0x571d01,_0xfee128){_0x571d01=_0x571d01-0xe4;let _0x5573e0=_0x3cf0dd[_0x571d01];return _0x5573e0;},a0_0x571d(_0x22b6d8,_0x4fc232);}const createSensorDataTable=async(_0x159b98,_0x3bf52d)=>{return new Promise((_0x5bbe2c,_0x26454f)=>{const _0xea0b2=a0_0x571d,_0x8dd0f2=_0xea0b2(0x10a)+_0x159b98+'_'+_0x3bf52d;console[_0xea0b2(0x10c)](_0xea0b2(0x108)+_0x8dd0f2);const _0x48b689=_0xea0b2(0x111)+_0x8dd0f2+_0xea0b2(0xfd);db[_0xea0b2(0x112)](_0x48b689,_0x57ede1=>{const _0x476b92=_0xea0b2;_0x57ede1?(console[_0x476b92(0xe8)]('‚ùå\x20Error\x20creating\x20'+_0x8dd0f2+':',_0x57ede1[_0x476b92(0x102)]),_0x26454f(_0x57ede1)):(console[_0x476b92(0x10c)](_0x476b92(0x114)+_0x8dd0f2+_0x476b92(0xf0)),_0x5bbe2c());});});};function a0_0x3cf0(){const _0x26224d=['‚ùå\x20Failed\x20to\x20enable\x20foreign\x20keys:','\x0a\x20\x20\x20\x20CREATE\x20TRIGGER\x20IF\x20NOT\x20EXISTS\x20update_timestamp_active\x0a\x20\x20\x20\x20AFTER\x20UPDATE\x20ON\x20LocalActiveSensors\x0a\x20\x20\x20\x20FOR\x20EACH\x20ROW\x0a\x20\x20\x20\x20BEGIN\x0a\x20\x20\x20\x20\x20\x20\x20\x20UPDATE\x20LocalActiveSensors\x20SET\x20updated_at\x20=\x20CURRENT_TIMESTAMP\x20WHERE\x20id\x20=\x20OLD.id;\x0a\x20\x20\x20\x20END;\x0a','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20SensorLogs\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20sensor_id\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20log\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20timestamp\x20DATETIME\x20DEFAULT\x20CURRENT_TIMESTAMP,\x0a\x20\x20\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(sensor_id)\x20REFERENCES\x20LocalActiveSensors(bank_id)\x20ON\x20DELETE\x20CASCADE\x0a\x20\x20\x20\x20);\x0a','üîó\x20Foreign\x20key\x20enforcement\x20is\x20ON','5DyiSDI','‚úÖ\x20Update\x20trigger\x20for\x20LocalSensorBank\x20created.','\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20DesigoAuthTokens\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20username\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20token\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20expires_at\x20TIMESTAMP\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20created_at\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP\x0a\x20\x20\x20\x20);\x0a','‚úÖ\x20SensorLogs\x20table\x20created\x20(or\x20already\x20exists).','\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20sensor_id\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20value\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20quality\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20quality_good\x20BOOLEAN\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20timestamp\x20TIMESTAMP\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20sent_to_cloud\x20BOOLEAN\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY\x20(sensor_id)\x20REFERENCES\x20LocalActiveSensors(id)\x20ON\x20DELETE\x20CASCADE\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20);\x0a\x20\x20\x20\x20\x20\x20\x20\x20','‚úÖ\x20Update\x20trigger\x20for\x20LocalActiveSensors\x20created.','kKixd','Database','‚ùå\x20Error\x20creating\x20DesigoAuthTokens:','message','6297906AffNDj','serialize','3526296twGMoN','sqlite3','1RQUQxf','üìå\x20Creating\x20local\x20sensor\x20data\x20table:\x20','WKtwj','SensorData_','‚ùå\x20Error\x20creating\x20update\x20trigger:','log','DxmXR','DibLB','‚úÖ\x20LocalSensorAPIs\x20table\x20created\x20(or\x20already\x20exists).','‚úÖ\x20DesigoAuthTokens\x20table\x20created\x20(or\x20already\x20exists).','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20','run','gzQRn','‚úÖ\x20Table\x20','UnNHn','‚ùå\x20Error\x20creating\x20LocalActiveSensors:','‚úÖ\x20Local\x20database\x20connected.','5117280HkglRV','11202093HlWpef','error','hddeY','verbose','‚úÖ\x20LocalActiveSensors\x20table\x20created\x20(or\x20already\x20exists).','./dbPath','‚ùå\x20Error\x20creating\x20LocalSensorAPIs:','5813624hnZklA','\x0a\x20\x20\x20\x20CREATE\x20TRIGGER\x20IF\x20NOT\x20EXISTS\x20update_timestamp\x0a\x20\x20\x20\x20AFTER\x20UPDATE\x20ON\x20LocalSensorBank\x0a\x20\x20\x20\x20FOR\x20EACH\x20ROW\x0a\x20\x20\x20\x20BEGIN\x0a\x20\x20\x20\x20\x20\x20\x20\x20UPDATE\x20LocalSensorBank\x20SET\x20updated_at\x20=\x20CURRENT_TIMESTAMP\x20WHERE\x20id\x20=\x20OLD.id;\x0a\x20\x20\x20\x20END;\x0a','\x20created.','610896UzOQKr','‚úÖ\x20LocalSensorBank\x20table\x20created\x20(or\x20already\x20exists).','‚ùå\x20Error\x20creating\x20SensorLogs:','284522oMdznp'];a0_0x3cf0=function(){return _0x26224d;};return a0_0x3cf0();}module['exports']={'db':db,'createSensorDataTable':createSensorDataTable};