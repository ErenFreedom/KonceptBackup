const a0_0x544c7b=a0_0x17f5;(function(_0x4607b0,_0x39224f){const _0x2bbda1=a0_0x17f5,_0x2e567d=_0x4607b0();while(!![]){try{const _0x46b602=parseInt(_0x2bbda1(0x19b))/0x1+-parseInt(_0x2bbda1(0x18b))/0x2*(-parseInt(_0x2bbda1(0x1a5))/0x3)+-parseInt(_0x2bbda1(0x1b6))/0x4*(-parseInt(_0x2bbda1(0x198))/0x5)+-parseInt(_0x2bbda1(0x1a8))/0x6+-parseInt(_0x2bbda1(0x1b7))/0x7*(-parseInt(_0x2bbda1(0x1a6))/0x8)+-parseInt(_0x2bbda1(0x19d))/0x9+-parseInt(_0x2bbda1(0x1ac))/0xa*(parseInt(_0x2bbda1(0x193))/0xb);if(_0x46b602===_0x39224f)break;else _0x2e567d['push'](_0x2e567d['shift']());}catch(_0x3d5380){_0x2e567d['push'](_0x2e567d['shift']());}}}(a0_0x45bc,0x7da3f));function a0_0x17f5(_0x5c7245,_0x4f194c){const _0x45bc90=a0_0x45bc();return a0_0x17f5=function(_0x17f5db,_0x4ef663){_0x17f5db=_0x17f5db-0x183;let _0x33e4b3=_0x45bc90[_0x17f5db];return _0x33e4b3;},a0_0x17f5(_0x5c7245,_0x4f194c);}const axios=require('axios'),{db,createSensorDataTable}=require(a0_0x544c7b(0x1a4)),CLOUD_SYNC_ENDPOINT=process[a0_0x544c7b(0x1a1)][a0_0x544c7b(0x199)]+a0_0x544c7b(0x1a3),syncFromCloud=async(_0x55100c,_0x260e8e)=>{const _0x3a12d1=a0_0x544c7b,_0xa5e4c6={'rRCPJ':'❌\x20Failed\x20to\x20insert\x20into\x20LocalSensorBank:','jdlao':_0x3a12d1(0x1af),'ufyqx':_0x3a12d1(0x190),'LUejs':function(_0x3eb8c,_0x22c05b,_0x1941cf){return _0x3eb8c(_0x22c05b,_0x1941cf);},'cLtmk':_0x3a12d1(0x192),'RkKsO':'SELECT\x20id\x20FROM\x20LocalSensorBank\x20WHERE\x20id\x20=\x20?','LIXwU':_0x3a12d1(0x18f),'akeTu':_0x3a12d1(0x19f)};try{const _0x18cf1a=_0x55100c[_0x3a12d1(0x1a0)][_0x3a12d1(0x1b2)]?.[_0x3a12d1(0x197)]('\x20')[0x1];if(!_0x18cf1a)return _0x260e8e['status'](0x191)['json']({'message':_0xa5e4c6['cLtmk']});const _0x304437=await axios[_0x3a12d1(0x1ae)](CLOUD_SYNC_ENDPOINT,{'headers':{'Authorization':_0x3a12d1(0x184)+_0x18cf1a}}),{sensorBank:_0x5eab73,activeSensors:_0x29ab20,sensorApis:_0x50bb3a,sensorDataTables:_0x4ea2f6}=_0x304437[_0x3a12d1(0x188)];for(const _0x4421fd of _0x5eab73){db[_0x3a12d1(0x1ae)](_0xa5e4c6[_0x3a12d1(0x1b4)],[_0x4421fd['id']],async(_0x290fec,_0x5b3d55)=>{const _0x1468ba=_0x3a12d1,_0x2b07e9={'mQJKg':_0xa5e4c6[_0x1468ba(0x185)]};if(_0x290fec)return console['error'](_0xa5e4c6[_0x1468ba(0x18d)],_0x290fec[_0x1468ba(0x1b8)]);if(!_0x5b3d55){db[_0x1468ba(0x18c)](_0x1468ba(0x1ab),[_0x4421fd['id'],_0x4421fd[_0x1468ba(0x1a7)],_0x4421fd['description']||null,_0x4421fd[_0x1468ba(0x186)],_0x4421fd[_0x1468ba(0x189)],_0x4421fd['data_type'],_0x4421fd['is_active'],_0x4421fd[_0x1468ba(0x1a9)],_0x4421fd[_0x1468ba(0x1b5)]],_0x24bed3=>{const _0x413689=_0x1468ba;if(_0x24bed3)console[_0x413689(0x183)](_0xa5e4c6[_0x413689(0x1b1)],_0x24bed3[_0x413689(0x1b8)]);});const _0x2d7e25=_0x29ab20[_0x1468ba(0x195)](_0x11b574=>_0x11b574[_0x1468ba(0x196)]===_0x4421fd['id']);_0x2d7e25&&db['run'](_0x1468ba(0x18a),[_0x2d7e25['id'],_0x2d7e25[_0x1468ba(0x196)],_0x2d7e25[_0x1468ba(0x1ad)],_0x2d7e25['created_at'],_0x2d7e25[_0x1468ba(0x1b5)]],_0x3166e4=>{const _0x3ccf49=_0x1468ba;if(_0x3166e4)console[_0x3ccf49(0x183)](_0x2b07e9[_0x3ccf49(0x1b3)],_0x3166e4['message']);});const _0x24e493=_0x50bb3a['filter'](_0x31abf0=>_0x31abf0[_0x1468ba(0x191)]===_0x4421fd['id']);for(const _0x2555ca of _0x24e493){db[_0x1468ba(0x18c)](_0x1468ba(0x187),[_0x2555ca['id'],_0x2555ca[_0x1468ba(0x191)],_0x2555ca['api_endpoint'],_0x2555ca[_0x1468ba(0x1a9)]],_0x537bb1=>{const _0x358e8c=_0x1468ba;if(_0x537bb1)console[_0x358e8c(0x183)]('❌\x20Failed\x20to\x20insert\x20into\x20LocalSensorAPIs:',_0x537bb1[_0x358e8c(0x1b8)]);});}const _0x19e25c=_0x4ea2f6[_0x1468ba(0x1aa)](_0x649ce8=>_0x649ce8[_0x1468ba(0x18e)]('_'+_0x4421fd['id']));for(const _0x1f3da6 of _0x19e25c){const _0x4cf548=_0x1f3da6[_0x1468ba(0x197)]('_'),_0x51c9e7=_0x4cf548[0x1],_0x54e31f=_0x4cf548[0x2];await _0xa5e4c6[_0x1468ba(0x1a2)](createSensorDataTable,_0x51c9e7,_0x54e31f);}}else console['log'](_0x1468ba(0x19c)+_0x4421fd['id']+_0x1468ba(0x194));});}_0x260e8e['status'](0xc8)[_0x3a12d1(0x19e)]({'message':_0x3a12d1(0x1b0)});}catch(_0x4e5f0f){console[_0x3a12d1(0x183)](_0xa5e4c6['LIXwU'],_0x4e5f0f['message']),_0x260e8e['status'](0x1f4)['json']({'message':_0xa5e4c6[_0x3a12d1(0x19a)],'error':_0x4e5f0f[_0x3a12d1(0x1b8)]});}};function a0_0x45bc(){const _0x286a2a=['authorization','mQJKg','RkKsO','updated_at','21724PrxxWO','6727TaBmto','message','error','Bearer\x20','jdlao','object_id','INSERT\x20INTO\x20LocalSensorAPIs\x20(id,\x20sensor_id,\x20api_endpoint,\x20created_at)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?,\x20?)','data','property_name','INSERT\x20INTO\x20LocalActiveSensors\x20(id,\x20bank_id,\x20mode,\x20interval_seconds,\x20batch_size,\x20is_active,\x20created_at,\x20updated_at)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20\x27manual\x27,\x2010,\x201,\x20?,\x20?,\x20?)','2uEjupm','run','ufyqx','endsWith','❌\x20Sync\x20from\x20cloud\x20failed:','❌\x20Error\x20checking\x20LocalSensorBank:','sensor_id','Authorization\x20token\x20missing','44fAppRu','\x20as\x20it\x20already\x20exists\x20locally.','find','bank_id','split','740vOLBOS','CLOUD_API_URL','akeTu','577445WbOjft','⏩\x20Skipping\x20sensor\x20','2957355sPYarp','json','Failed\x20to\x20sync\x20from\x20cloud','headers','env','LUejs','/api/cloud/sync/local-db','../db/sensorDB','1301649RXKLHR','7856LZwZmn','name','2434872APNbUp','created_at','filter','INSERT\x20INTO\x20LocalSensorBank\x20(id,\x20name,\x20description,\x20object_id,\x20property_name,\x20data_type,\x20is_active,\x20created_at,\x20updated_at)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)','3774470uPvtOx','is_active','get','❌\x20Failed\x20to\x20insert\x20into\x20LocalActiveSensors:','✅\x20Local\x20DB\x20synced\x20from\x20cloud\x20(without\x20duplication).','rRCPJ'];a0_0x45bc=function(){return _0x286a2a;};return a0_0x45bc();}module['exports']={'syncFromCloud':syncFromCloud};