function a0_0x3a0d(_0x2d5798,_0x521793){const _0x3f6042=a0_0x3f60();return a0_0x3a0d=function(_0x3a0d7f,_0x161848){_0x3a0d7f=_0x3a0d7f-0xf3;let _0x2f105d=_0x3f6042[_0x3a0d7f];return _0x2f105d;},a0_0x3a0d(_0x2d5798,_0x521793);}function a0_0x3f60(){const _0x1c3dbf=['JSYkH','startFetch','message','SlCpr','❌\x20Failed\x20to\x20update\x20IntervalControl:','SegQG','Fetching\x20started\x20for\x20sensor','error','BtCsH','Bearer\x20','5179MJHuRw','SensorData_','RazFD','AClSO','❌\x20Fetch\x20failed:\x20','❌\x20DB\x20Insert\x20Error\x20in\x20','https','headers','945205TYfggc','cQIYv','2717060lHlEfQ','❌\x20No\x20matching\x20LocalActiveSensor\x20row\x20found\x20for\x20bank_id=','nDGna','❌\x20Sensor\x20is\x20not\x20active\x20or\x20not\x20found.','❌\x20Failed\x20to\x20map\x20bank_id\x20to\x20local\x20id.','NCRsX','187goSxsM','6hbmvHY','BVQSA','❌\x20No\x20matching\x20sensor_id\x20in\x20LocalActiveSensors\x20for\x20bank_id=','\x0a\x20\x20\x20\x20\x20\x20\x20\x20INSERT\x20INTO\x20','SELECT\x20id\x20FROM\x20LocalActiveSensors\x20WHERE\x20bank_id\x20=\x20?','❌\x20Error\x20in\x20processSensorByAPI:','🔍\x20API:\x20','❌\x20Interval\x20crash\x20(fetch):\x20','OQZmb','❌\x20Mapping\x20bank_id\x20to\x20id\x20failed:','Error\x20fetching\x20token','JWT_SECRET_APP','✅\x20Data\x20saved\x20successfully\x20to\x20','Failed\x20to\x20update\x20fetch\x20status.','is_fetching','exports','KuDog','1319358IPZSOZ','run','❌\x20Error\x20fetching\x20from\x20Desigo\x20CC\x20for\x20sensor\x20','idYCq','❌\x20Interval\x20crash\x20(fetch)\x20for\x20sensor\x20','2120521JUbTEV','YsSIg','4OmqTkD','companyId','9cGBBjd','data','sensor_id','UsMBi','../utils/intervalManager','Internal\x20mapping\x20error.','xoPNf','env','JACxI','No\x20stored\x20token','❌\x20Failed\x20to\x20insert\x20data\x20into\x20','../utils/logHelpers','sXlTm','tLjBH','PdNGK','NANQw','Agent','HLyeo','PTIRL','bzgcF','axios','11796lmYphw','XVwAR','58Mnyxrg','Sensor\x20not\x20active\x20or\x20not\x20found\x20in\x20LocalActiveSensors.','status','12411kygxMQ','get','yqtJK','\x20(sensor_id,\x20value,\x20quality,\x20quality_good,\x20timestamp)\x0a\x20\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20\x20\x20\x20\x20','KxAiD','RSHBu','../db/sensorDB','1112tzEmnv','SELECT\x20is_fetching\x20FROM\x20IntervalControl\x20WHERE\x20sensor_id\x20=\x20?','WcqIe','LzSBI','API\x20endpoint,\x20sensor\x20ID,\x20and\x20Desigo\x20token\x20are\x20required.','token','bqrPJ','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20INSERT\x20INTO\x20IntervalControl\x20(sensor_id,\x20is_fetching)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x201)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ON\x20CONFLICT(sensor_id)\x20DO\x20UPDATE\x20SET\x20is_fetching\x20=\x201;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','SELECT\x20api_endpoint\x20FROM\x20LocalSensorAPIs\x20WHERE\x20api_endpoint\x20=\x20?','DKPqg','xVeKC','UCeKK','json','Sensor\x20API\x20not\x20found\x20in\x20LocalSensorAPIs.'];a0_0x3f60=function(){return _0x1c3dbf;};return a0_0x3f60();}const a0_0x51b622=a0_0x3a0d;(function(_0x8471a1,_0x431b1b){const _0x54c732=a0_0x3a0d,_0x4eda80=_0x8471a1();while(!![]){try{const _0x39e582=parseInt(_0x54c732(0x129))/0x1*(-parseInt(_0x54c732(0x107))/0x2)+parseInt(_0x54c732(0x14b))/0x3*(-parseInt(_0x54c732(0x152))/0x4)+parseInt(_0x54c732(0x131))/0x5*(parseInt(_0x54c732(0x13a))/0x6)+-parseInt(_0x54c732(0x10a))/0x7*(-parseInt(_0x54c732(0x111))/0x8)+parseInt(_0x54c732(0x154))/0x9*(parseInt(_0x54c732(0x133))/0xa)+-parseInt(_0x54c732(0x139))/0xb*(parseInt(_0x54c732(0x105))/0xc)+parseInt(_0x54c732(0x150))/0xd;if(_0x39e582===_0x431b1b)break;else _0x4eda80['push'](_0x4eda80['shift']());}catch(_0x4132ca){_0x4eda80['push'](_0x4eda80['shift']());}}}(a0_0x3f60,0x405c7));const axios=require(a0_0x51b622(0x104)),jwt=require('jsonwebtoken'),https=require(a0_0x51b622(0x12f)),{db}=require(a0_0x51b622(0x110)),{insertLog}=require(a0_0x51b622(0xfb)),intervalManager=require(a0_0x51b622(0xf4)),agent=new https[(a0_0x51b622(0x100))]({'rejectUnauthorized':![]}),getStoredToken=()=>{const _0x4b1fa3=a0_0x51b622,_0x19168a={'NANQw':function(_0x402699,_0x551465){return _0x402699(_0x551465);},'idYCq':_0x4b1fa3(0xf9),'KxAiD':'SELECT\x20token\x20FROM\x20AuthTokens\x20ORDER\x20BY\x20id\x20DESC\x20LIMIT\x201'};return new Promise((_0x5960b8,_0x47dd9d)=>{const _0x209798=_0x4b1fa3;db[_0x209798(0x10b)](_0x19168a[_0x209798(0x10e)],[],(_0x9bdbaf,_0x4268af)=>{const _0x33e86f=_0x209798;if(_0x9bdbaf)_0x19168a[_0x33e86f(0xff)](_0x47dd9d,_0x33e86f(0x144));else{if(!_0x4268af)_0x19168a[_0x33e86f(0xff)](_0x47dd9d,_0x19168a[_0x33e86f(0x14e)]);else _0x5960b8(_0x4268af[_0x33e86f(0x116)]);}});});},getCompanyIdFromToken=async()=>{const _0x52c5cd=a0_0x51b622,_0x432fad={'xoPNf':function(_0x17a78d){return _0x17a78d();}},_0x585e17=await _0x432fad[_0x52c5cd(0xf6)](getStoredToken),_0x506473=jwt['verify'](_0x585e17,process[_0x52c5cd(0xf7)][_0x52c5cd(0x145)]);return _0x506473[_0x52c5cd(0x153)];},fetchAndStoreSensorData=async(_0x6e2ac8,_0x2eb107,_0x1bd603)=>{const _0x822f82=a0_0x51b622,_0x7677aa={'DKPqg':function(_0x13cace,_0x281c4c,_0x3d49ce){return _0x13cace(_0x281c4c,_0x3d49ce);},'WcqIe':function(_0x33371f,_0xec2d5){return _0x33371f||_0xec2d5;},'bzgcF':'⚠️\x20No\x20data\x20returned\x20from\x20Desigo\x20endpoint.'};try{const {sensor_id:_0x59d281,api_endpoint:_0x26e937}=_0x6e2ac8,_0x4d3bae=await axios[_0x822f82(0x10b)](_0x26e937,{'headers':{'Authorization':_0x822f82(0x128)+_0x1bd603},'httpsAgent':agent}),_0x203f68=_0x4d3bae[_0x822f82(0x155)]?.[0x0]?.['Value'];if(!_0x203f68){_0x7677aa[_0x822f82(0x11a)](insertLog,_0x59d281,_0x7677aa[_0x822f82(0x103)]);return;}const {Value:_0x3bfa82,Quality:_0x227fd0,QualityGood:_0xe1d392,Timestamp:_0x29b7ec}=_0x203f68,_0x227378=_0x822f82(0x12a)+_0x2eb107+'_'+_0x59d281;db[_0x822f82(0x10b)](_0x822f82(0x13e),[_0x59d281],(_0x27da2d,_0xc2fa80)=>{const _0x1eee20=_0x822f82,_0x45480a={'UCeKK':function(_0xd118fd,_0x293a24,_0x495947){return _0xd118fd(_0x293a24,_0x495947);},'PdNGK':function(_0x20a0a5,_0x17b2c5,_0x2e45c5){return _0x7677aa['DKPqg'](_0x20a0a5,_0x17b2c5,_0x2e45c5);}};if(_0x7677aa[_0x1eee20(0x113)](_0x27da2d,!_0xc2fa80)){console[_0x1eee20(0x126)](_0x1eee20(0x134)+_0x59d281),_0x7677aa[_0x1eee20(0x11a)](insertLog,_0x59d281,_0x1eee20(0x13c)+_0x59d281);return;}const _0x6d0144=_0xc2fa80['id'],_0x42223e=_0x1eee20(0x13d)+_0x227378+_0x1eee20(0x10d);db[_0x1eee20(0x14c)](_0x42223e,[_0x6d0144,_0x3bfa82,_0x227fd0,_0xe1d392,_0x29b7ec],_0x578cb5=>{const _0x1453f4=_0x1eee20;_0x578cb5?(console[_0x1453f4(0x126)](_0x1453f4(0x12e)+_0x227378+':',_0x578cb5[_0x1453f4(0x121)]),_0x45480a[_0x1453f4(0x11c)](insertLog,_0x59d281,_0x1453f4(0xfa)+_0x227378+':\x20'+_0x578cb5[_0x1453f4(0x121)])):_0x45480a[_0x1453f4(0xfe)](insertLog,_0x59d281,_0x1453f4(0x146)+_0x227378);});});}catch(_0x55bab8){console[_0x822f82(0x126)](_0x822f82(0x14d)+_0x6e2ac8[_0x822f82(0x156)]+':',_0x55bab8[_0x822f82(0x121)]),insertLog(_0x6e2ac8['sensor_id'],_0x822f82(0x12d)+_0x55bab8[_0x822f82(0x121)]);}},processSensorByAPI=async(_0x9ca491,_0x4375fc)=>{const _0x286fb2=a0_0x51b622,_0x40c11a={'YsSIg':function(_0x42df0d,_0x34a018,_0x162483){return _0x42df0d(_0x34a018,_0x162483);},'tLjBH':_0x286fb2(0x147),'HLyeo':function(_0x1078d4,_0x3b99c6){return _0x1078d4*_0x3b99c6;},'RazFD':_0x286fb2(0x125),'nDGna':_0x286fb2(0x143),'bqrPJ':_0x286fb2(0xf5),'LzSBI':function(_0x35863f,_0x48d06c){return _0x35863f||_0x48d06c;},'xVeKC':_0x286fb2(0x136),'MuMTb':function(_0x3081b5,_0x544e22){return _0x3081b5||_0x544e22;},'QHwwU':'❌\x20Sensor\x20API\x20not\x20found\x20in\x20LocalSensorAPIs.','XVwAR':'x-desigo-token','mcudl':_0x286fb2(0x115),'BVQSA':_0x286fb2(0x13f)};try{const {api_endpoint:_0x940a2,sensor_id:_0x1d49f3}=_0x9ca491['query'],_0x37eff6=_0x9ca491[_0x286fb2(0x130)][_0x40c11a[_0x286fb2(0x106)]];if(_0x40c11a[_0x286fb2(0x114)](!_0x940a2,!_0x1d49f3)||!_0x37eff6)return _0x4375fc['status'](0x190)[_0x286fb2(0x11d)]({'message':_0x40c11a['mcudl']});console['log'](_0x286fb2(0x140)+_0x940a2+'\x20|\x20Sensor\x20ID:\x20'+_0x1d49f3);const _0x217287=await getCompanyIdFromToken();db[_0x286fb2(0x10b)](_0x286fb2(0x119),[_0x940a2],(_0x236112,_0x1483f9)=>{const _0x24d522=_0x286fb2,_0xc2fd4={'BtCsH':function(_0x9124c9,_0x259080){return _0x9124c9!==_0x259080;},'ndYau':function(_0xc620bc,_0x3c01e7,_0x1c5ce6){const _0x5a31f5=a0_0x3a0d;return _0x40c11a[_0x5a31f5(0x151)](_0xc620bc,_0x3c01e7,_0x1c5ce6);},'NCRsX':_0x40c11a[_0x24d522(0xfd)],'yqtJK':function(_0x3855c0,_0x23bd45){const _0x409d68=_0x24d522;return _0x40c11a[_0x409d68(0x101)](_0x3855c0,_0x23bd45);},'JSYkH':_0x40c11a[_0x24d522(0x12b)],'UsMBi':_0x40c11a[_0x24d522(0x135)],'AFNwc':function(_0x1b7cde,_0x1ae860,_0xcdd1f5){const _0xc250b3=_0x24d522;return _0x40c11a[_0xc250b3(0x151)](_0x1b7cde,_0x1ae860,_0xcdd1f5);},'OQZmb':_0x40c11a[_0x24d522(0x117)],'sXlTm':function(_0x4c1078,_0x8bc254){const _0x2c668b=_0x24d522;return _0x40c11a[_0x2c668b(0x114)](_0x4c1078,_0x8bc254);},'AClSO':function(_0xd50bfe,_0x283e6d,_0x5d1a22){const _0x5756aa=_0x24d522;return _0x40c11a[_0x5756aa(0x151)](_0xd50bfe,_0x283e6d,_0x5d1a22);},'HpueF':_0x40c11a[_0x24d522(0x11b)]};if(_0x40c11a['MuMTb'](_0x236112,!_0x1483f9))return insertLog(_0x1d49f3,_0x40c11a['QHwwU']),_0x4375fc['status'](0x194)[_0x24d522(0x11d)]({'message':_0x24d522(0x11e)});db['get']('SELECT\x20bank_id,\x20interval_seconds,\x20is_active\x20FROM\x20LocalActiveSensors\x20WHERE\x20bank_id\x20=\x20?\x20AND\x20is_active\x20=\x201',[_0x1d49f3],(_0xfa7fed,_0x2bc729)=>{const _0x1bf429=_0x24d522;if(_0xc2fd4[_0x1bf429(0xfc)](_0xfa7fed,!_0x2bc729))return _0xc2fd4[_0x1bf429(0x12c)](insertLog,_0x1d49f3,_0xc2fd4['HpueF']),_0x4375fc[_0x1bf429(0x109)](0x194)[_0x1bf429(0x11d)]({'message':_0x1bf429(0x108)});const {bank_id:_0x164170,interval_seconds:_0x1662b2}=_0x2bc729;db[_0x1bf429(0x10b)](_0x1bf429(0x13e),[_0x164170],(_0x473dac,_0x5c2e4b)=>{const _0x2e145f=_0x1bf429,_0x3e2e9b={'cQIYv':function(_0x409060,_0x26b35c){const _0x42670e=a0_0x3a0d;return _0xc2fd4[_0x42670e(0x127)](_0x409060,_0x26b35c);},'SegQG':function(_0x1443cc,_0x456386,_0xfe3929){return _0xc2fd4['ndYau'](_0x1443cc,_0x456386,_0xfe3929);},'JACxI':_0x2e145f(0x123),'SlCpr':_0xc2fd4[_0x2e145f(0x138)],'hrNwq':function(_0x198a43,_0x5be215){const _0x23dd3e=_0x2e145f;return _0xc2fd4[_0x23dd3e(0x10c)](_0x198a43,_0x5be215);},'PTIRL':_0xc2fd4[_0x2e145f(0x11f)]};if(_0x473dac||!_0x5c2e4b)return console[_0x2e145f(0x126)](_0xc2fd4[_0x2e145f(0xf3)],_0x473dac?.[_0x2e145f(0x121)]),_0xc2fd4['AFNwc'](insertLog,_0x164170,_0x2e145f(0x137)),_0x4375fc[_0x2e145f(0x109)](0x1f4)[_0x2e145f(0x11d)]({'message':_0xc2fd4[_0x2e145f(0x142)]});const _0x293a45=_0x5c2e4b['id'];db[_0x2e145f(0x14c)](_0x2e145f(0x118),[_0x293a45],_0x195ca4=>{const _0x13d922=_0x2e145f;if(_0x195ca4)return console[_0x13d922(0x126)](_0x3e2e9b[_0x13d922(0xf8)],_0x195ca4[_0x13d922(0x121)]),_0x3e2e9b[_0x13d922(0x124)](insertLog,_0x164170,'❌\x20Failed\x20to\x20update\x20fetch\x20control:\x20'+_0x195ca4['message']),_0x4375fc[_0x13d922(0x109)](0x1f4)[_0x13d922(0x11d)]({'message':_0x3e2e9b[_0x13d922(0x122)]});return intervalManager[_0x13d922(0x120)](_0x164170,async()=>{const _0x34c48d=_0x13d922,_0x4a104b={'RSHBu':function(_0x3c5a23,_0x3c6515){return _0x3c5a23||_0x3c6515;},'KuDog':function(_0x362f11,_0x6031d3){const _0x1b8a50=a0_0x3a0d;return _0x3e2e9b[_0x1b8a50(0x132)](_0x362f11,_0x6031d3);}};try{db[_0x34c48d(0x10b)](_0x34c48d(0x112),[_0x293a45],(_0x3d82ee,_0x5df631)=>{const _0x149f46=_0x34c48d;if(_0x4a104b[_0x149f46(0x10f)](_0x3d82ee,!_0x5df631)||_0x4a104b[_0x149f46(0x14a)](_0x5df631[_0x149f46(0x148)],0x1))return;fetchAndStoreSensorData({'sensor_id':_0x164170,'api_endpoint':_0x940a2,'interval_seconds':_0x1662b2},_0x217287,_0x37eff6);});}catch(_0x51ea57){console[_0x34c48d(0x126)](_0x34c48d(0x14f)+_0x164170+':',_0x51ea57[_0x34c48d(0x121)]),_0x3e2e9b[_0x34c48d(0x124)](insertLog,_0x164170,_0x34c48d(0x141)+_0x51ea57[_0x34c48d(0x121)]);}},_0x3e2e9b['hrNwq'](_0x1662b2,0x3e8)),_0x3e2e9b['SegQG'](insertLog,_0x164170,'🚀\x20Started\x20persistent\x20fetch\x20every\x20'+_0x1662b2+'s'),_0x4375fc[_0x13d922(0x109)](0xc8)['json']({'message':_0x3e2e9b[_0x13d922(0x102)],'sensor_id':_0x164170,'companyId':_0x217287,'interval_seconds':_0x1662b2});});});});});}catch(_0x129e4b){return console[_0x286fb2(0x126)](_0x40c11a[_0x286fb2(0x13b)],_0x129e4b[_0x286fb2(0x121)]),_0x4375fc[_0x286fb2(0x109)](0x1f4)[_0x286fb2(0x11d)]({'message':'Internal\x20Server\x20Error','error':_0x129e4b[_0x286fb2(0x121)]});}};module[a0_0x51b622(0x149)]={'processSensorByAPI':processSensorByAPI,'fetchAndStoreSensorData':fetchAndStoreSensorData};