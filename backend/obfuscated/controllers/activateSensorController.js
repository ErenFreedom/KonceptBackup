const a0_0x23bf89=a0_0x3d53;(function(_0x51f3ee,_0x4497b7){const _0x4aef00=a0_0x3d53,_0x6222cd=_0x51f3ee();while(!![]){try{const _0x32de19=-parseInt(_0x4aef00(0x15b))/0x1+parseInt(_0x4aef00(0x189))/0x2+parseInt(_0x4aef00(0x1c1))/0x3+parseInt(_0x4aef00(0x199))/0x4+-parseInt(_0x4aef00(0x1e6))/0x5+parseInt(_0x4aef00(0x1d9))/0x6*(parseInt(_0x4aef00(0x1c7))/0x7)+-parseInt(_0x4aef00(0x1da))/0x8;if(_0x32de19===_0x4497b7)break;else _0x6222cd['push'](_0x6222cd['shift']());}catch(_0x657c0d){_0x6222cd['push'](_0x6222cd['shift']());}}}(a0_0x4577,0xcadb2));function a0_0x4577(){const _0x62456f=['heJxW','response','exlNP','data','ZnFOV','uSYPb','/api/sensors/activate','error','vwbnA','Sensor\x20activated\x20successfully','‚ùå\x20Error\x20inserting\x20into\x20LocalActiveSensors:','‚ùå\x20Error\x20deleting\x20from\x20Local\x20DB:','tlDFp','kIRYs','/api/sensors/deactivate','üìã\x20Attempting\x20to\x20insert\x20into\x20LocalActiveSensors:','find','‚ùå\x20Failed\x20to\x20reactivate\x20sensor\x20in\x20Cloud:','uGavs','\x20removed\x20from\x20Local\x20DB.','üì§\x20Sending\x20Activation\x20Request\x20with\x20Token:\x20','‚ùå\x20Error\x20fetching\x20token:','üîç\x20Using\x20Token:\x20','changes','3527331wCMfWG','MACWl','üì§\x20Deactivating\x20Sensor\x20in\x20Cloud:\x20','‚úÖ\x20Sensor\x20','Lrdkn','‚ùå\x20Error\x20reactivating\x20sensor:','3586394aMKRLY','sensors','s\x20and\x20Batch\x20','\x20reactivated\x20in\x20Local\x20DB.','Sensor\x20ID,\x20interval_seconds,\x20and\x20batch_size\x20are\x20required','AbEWe','get','sdATa','‚úÖ\x20Table\x20','üîç\x20Extracted\x20companyId:\x20','JWT_SECRET_APP','../db/sensorDB','‚ùå\x20Failed\x20to\x20activate\x20sensor\x20in\x20Cloud:','UIYXd','interval_seconds','CxnbU','OXGxk','SensorData_','12WoVKfs','14426544faUUWV','NKixS','Sensor\x20ID\x20is\x20required','Failed\x20to\x20fetch\x20local\x20sensors','xmarT','Sensor\x20must\x20be\x20deactivated\x20to\x20update\x20settings','WwQAc','Sensor\x20deactivated\x20successfully','/api/sensors/reactivate','‚ùå\x20Error\x20updating\x20Local\x20DB:','mMsna','GkyxF','3366020kEKHot','IJwMB','message','token','SELECT\x20is_fetching,\x20is_sending\x20FROM\x20IntervalControl\x20WHERE\x20sensor_id\x20=\x20?','Database\x20error','axios','gPKBQ','aJyOe','log','env','‚ùå\x20Error\x20removing\x20sensor:','wWrUL','PeUVN','HXnuq','295042lNyJTc','‚ùå\x20Error\x20decoding\x20JWT:','bWpxW','\x20settings\x20updated\x20locally.','SELECT\x20bank_id,\x20interval_seconds,\x20batch_size\x20FROM\x20LocalActiveSensors\x20WHERE\x20is_active\x20=\x201','json','‚ùå\x20Error\x20deactivating\x20sensor:','map','Fetched\x20active\x20sensors\x20with\x20local\x20settings','‚ùå\x20Sensor\x20is\x20actively\x20fetching\x20or\x20sending.\x20Please\x20stop\x20it\x20first\x20before\x20deactivating.','UPDATE\x20LocalActiveSensors\x20SET\x20is_active\x20=\x201\x20WHERE\x20bank_id\x20=\x20?','Bpqln','üì§\x20Re-activating\x20Sensor\x20in\x20Cloud:\x20','\x20activated\x20in\x20Local\x20DB\x20with\x20Interval\x20','is_sending','UPDATE\x20LocalActiveSensors\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20SET\x20interval_seconds\x20=\x20?,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20batch_size\x20=\x20?,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20updated_at\x20=\x20CURRENT_TIMESTAMP\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20bank_id\x20=\x20?\x20AND\x20is_active\x20=\x200','\x20settings\x20updated\x20successfully','CMEwx','üì§\x20Sending\x20Removal\x20Request\x20with\x20Token:\x20','tDETh','kPHUT','DROP\x20TABLE\x20IF\x20EXISTS\x20','Failed\x20to\x20reactivate\x20sensor\x20in\x20Cloud','Invalid\x20token','/api/sensors/active','body','‚ùå\x20Error\x20deleting\x20table\x20','Sensor\x20','UPDATE\x20LocalActiveSensors\x20SET\x20is_active\x20=\x200\x20WHERE\x20bank_id\x20=\x20?','bank_id','jsonwebtoken','üì§\x20Removing\x20Sensor\x20from\x20Active\x20in\x20Cloud:\x20','CLOUD_API_URL','post','‚ö†Ô∏è\x20No\x20IntervalControl\x20entry\x20found.\x20Proceeding\x20with\x20caution.','Internal\x20Server\x20Error','‚úÖ\x20Sensor\x20activated\x20successfully\x20in\x20Cloud:','WXPlK','NoSGl','üìå\x20Creating\x20sensor\x20data\x20table:\x20','JxeNE','kaSDr','vivzz','Sensor\x20removed\x20successfully','SELECT\x20token\x20FROM\x20AuthTokens\x20ORDER\x20BY\x20id\x20DESC\x20LIMIT\x201','No\x20stored\x20token\x20found.','2608962FgymWn','run','‚úÖ\x20Sensor\x20deactivated\x20successfully\x20in\x20Cloud:','SelXL','‚ùå\x20Error\x20fetching\x20from\x20Local\x20DB:','SSmLe','is_fetching','config','MbebU','companyId','rUMGE','kFZSQ','‚ùå\x20Error\x20in\x20getAllActiveSensors:','kwiNJ','üóë\x20Dropping\x20sensor\x20data\x20table:\x20','status','390080gxoYWf','‚ùå\x20Error\x20checking\x20IntervalControl:','tmYfI','batch_size','‚úÖ\x20Sensor\x20removed\x20from\x20Cloud:','Bearer\x20','YsLjO','Unauthorized:\x20Token\x20missing\x20or\x20invalid','qMljh','Qbfgo','Failed\x20to\x20deactivate\x20sensor\x20in\x20Cloud','Sensor\x20reactivated\x20successfully','CcHLi','../utils/syncAllSensorTables','ZQPPH','cagMx'];a0_0x4577=function(){return _0x62456f;};return a0_0x4577();}const axios=require(a0_0x23bf89(0x1ec)),jwt=require(a0_0x23bf89(0x179)),{db,createSensorDataTable}=require(a0_0x23bf89(0x1d2)),{syncAllSensorTables}=require(a0_0x23bf89(0x1a6));require('dotenv')[a0_0x23bf89(0x190)]();function a0_0x3d53(_0x2c1f6d,_0x3c99ae){const _0x457761=a0_0x4577();return a0_0x3d53=function(_0x3d53fc,_0x5cf46c){_0x3d53fc=_0x3d53fc-0x155;let _0x2b161f=_0x457761[_0x3d53fc];return _0x2b161f;},a0_0x3d53(_0x2c1f6d,_0x3c99ae);}const getStoredToken=()=>{const _0x30a806={'MbebU':'‚ùå\x20Error\x20fetching\x20token:','heJxW':function(_0x42dd76,_0x29c957){return _0x42dd76(_0x29c957);},'aJyOe':'Error\x20fetching\x20token\x20from\x20database','Jqrqc':'SELECT\x20token\x20FROM\x20AuthTokens\x20ORDER\x20BY\x20id\x20DESC\x20LIMIT\x201'};return new Promise((_0x52cea6,_0x3d73e2)=>{const _0x41db28=a0_0x3d53,_0x4fdea5={'FRcpF':_0x30a806[_0x41db28(0x191)],'kaSDr':function(_0x2b09ff,_0x410419){return _0x30a806['heJxW'](_0x2b09ff,_0x410419);},'oNbbs':_0x30a806[_0x41db28(0x1ee)],'KXJYu':function(_0x26d764,_0x5eae3c){const _0x508346=_0x41db28;return _0x30a806[_0x508346(0x1a9)](_0x26d764,_0x5eae3c);}};db[_0x41db28(0x1cd)](_0x30a806['Jqrqc'],[],(_0x24242a,_0x56317c)=>{const _0x3d2a3f=_0x41db28;if(_0x24242a)console[_0x3d2a3f(0x1b0)](_0x4fdea5['FRcpF'],_0x24242a['message']),_0x4fdea5['kaSDr'](_0x3d73e2,_0x4fdea5['oNbbs']);else!_0x56317c?_0x4fdea5[_0x3d2a3f(0x184)](_0x3d73e2,_0x3d2a3f(0x188)):_0x4fdea5['KXJYu'](_0x52cea6,_0x56317c[_0x3d2a3f(0x1e9)]);});});},getCompanyIdFromToken=()=>{const _0x2cc0dd=a0_0x23bf89,_0x4baf88={'pJfTs':function(_0x22adf6,_0x4cb65f){return _0x22adf6||_0x4cb65f;},'kFZSQ':'No\x20token\x20found','HXnuq':function(_0x1b3453,_0x235f70){return _0x1b3453(_0x235f70);},'kIRYs':'Error\x20fetching\x20token\x20from\x20database','dMYnF':_0x2cc0dd(0x15c),'qMljh':function(_0x48224d,_0x280c4f){return _0x48224d(_0x280c4f);}};return new Promise((_0x5c8264,_0x7fe60a)=>{const _0x122199=_0x2cc0dd;db[_0x122199(0x1cd)](_0x122199(0x187),[],(_0x6fc8b,_0x33428f)=>{const _0x3d0c99=_0x122199;if(_0x4baf88['pJfTs'](_0x6fc8b,!_0x33428f))return console[_0x3d0c99(0x1b0)](_0x3d0c99(0x1be),_0x6fc8b?.[_0x3d0c99(0x1e8)]||_0x4baf88[_0x3d0c99(0x194)]),_0x4baf88[_0x3d0c99(0x15a)](_0x7fe60a,_0x4baf88[_0x3d0c99(0x1b6)]);try{const _0x3b85b3=jwt['verify'](_0x33428f[_0x3d0c99(0x1e9)],process[_0x3d0c99(0x156)][_0x3d0c99(0x1d1)]);console['log'](_0x3d0c99(0x1d0)+_0x3b85b3[_0x3d0c99(0x192)]),_0x4baf88['HXnuq'](_0x5c8264,_0x3b85b3[_0x3d0c99(0x192)]);}catch(_0x57c36e){console['error'](_0x4baf88['dMYnF'],_0x57c36e[_0x3d0c99(0x1e8)]),_0x4baf88[_0x3d0c99(0x1a1)](_0x7fe60a,_0x3d0c99(0x172));}});});},activateSensor=async(_0x30c10a,_0x5cf00a)=>{const _0x3e44d3=a0_0x23bf89,_0x2dcb1a={'cagMx':function(_0x7c4c05){return _0x7c4c05();},'oSnDq':_0x3e44d3(0x1dc),'NoSGl':'Unauthorized:\x20Failed\x20to\x20get\x20company\x20ID','YsLjO':function(_0x150b36,_0x2e58df){return _0x150b36??_0x2e58df;},'aqNLI':_0x3e44d3(0x17f),'CMEwx':_0x3e44d3(0x1b8),'CcHLi':_0x3e44d3(0x1b2),'xmarT':_0x3e44d3(0x1d3),'tDETh':'Failed\x20to\x20activate\x20sensor\x20in\x20Cloud','GkyxF':'‚ùå\x20Error\x20activating\x20sensor:','uSYPb':'Internal\x20Server\x20Error'};try{const {sensorId:_0x1f3919,interval_seconds:_0x3a37e1,batch_size:_0x1083dd}=_0x30c10a[_0x3e44d3(0x174)];if(!_0x1f3919)return _0x5cf00a[_0x3e44d3(0x198)](0x190)['json']({'message':_0x2dcb1a['oSnDq']});let _0x40134f;try{_0x40134f=await getCompanyIdFromToken();}catch(_0x30ec31){return _0x5cf00a[_0x3e44d3(0x198)](0x191)[_0x3e44d3(0x160)]({'message':_0x2dcb1a[_0x3e44d3(0x181)]});}const _0x43c4d2=_0x2dcb1a['YsLjO'](_0x3a37e1,0xa),_0x156ef6=_0x2dcb1a[_0x3e44d3(0x19f)](_0x1083dd,0x1);let _0x43d02e;try{_0x43d02e=await getStoredToken(),console['log'](_0x3e44d3(0x1bf)+_0x43d02e);}catch(_0x4cc460){return _0x5cf00a[_0x3e44d3(0x198)](0x191)[_0x3e44d3(0x160)]({'message':_0x3e44d3(0x1a0)});}console[_0x3e44d3(0x155)](_0x3e44d3(0x1bd)+_0x43d02e);const _0x2777b8=process[_0x3e44d3(0x156)]['CLOUD_API_URL']+_0x3e44d3(0x1af);try{const _0x4261fb=await axios[_0x3e44d3(0x17c)](_0x2777b8,{'sensorId':_0x1f3919,'companyId':_0x40134f},{'headers':{'Authorization':_0x3e44d3(0x19e)+_0x43d02e}});console[_0x3e44d3(0x155)](_0x2dcb1a['aqNLI'],_0x4261fb[_0x3e44d3(0x1ac)]),console['log'](_0x2dcb1a[_0x3e44d3(0x16c)],_0x1f3919,_0x43c4d2,_0x156ef6),await new Promise((_0x1ce945,_0x21e315)=>{const _0x3e3552=_0x3e44d3,_0x24933a={'WoOUS':_0x3e3552(0x1b3),'Qbfgo':function(_0x3265fc,_0x2f49ef){return _0x3265fc(_0x2f49ef);},'OXGxk':function(_0x1506db,_0x19035d,_0x5f1c87){return _0x1506db(_0x19035d,_0x5f1c87);},'wWrUL':function(_0x6bdfd8){const _0x14183c=_0x3e3552;return _0x2dcb1a[_0x14183c(0x1a8)](_0x6bdfd8);}};db[_0x3e3552(0x18a)]('INSERT\x20INTO\x20LocalActiveSensors\x20(bank_id,\x20is_active,\x20mode,\x20interval_seconds,\x20batch_size)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x201,\x20\x27manual\x27,\x20?,\x20?)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ON\x20CONFLICT(bank_id)\x20DO\x20UPDATE\x20SET\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20is_active\x20=\x201,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20mode\x20=\x20\x27manual\x27,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20interval_seconds\x20=\x20excluded.interval_seconds,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20batch_size\x20=\x20excluded.batch_size',[_0x1f3919,_0x43c4d2,_0x156ef6],async _0x350273=>{const _0x55c14f=_0x3e3552;if(_0x350273)return console['error'](_0x24933a['WoOUS'],_0x350273[_0x55c14f(0x1e8)]),_0x24933a[_0x55c14f(0x1a2)](_0x21e315,_0x350273);console[_0x55c14f(0x155)]('‚úÖ\x20Sensor\x20'+_0x1f3919+_0x55c14f(0x168)+_0x43c4d2+_0x55c14f(0x1c9)+_0x156ef6+'.');const _0x2d5537=_0x55c14f(0x1d8)+_0x40134f+'_'+_0x1f3919;console['log'](_0x55c14f(0x182)+_0x2d5537),await _0x24933a[_0x55c14f(0x1d7)](createSensorDataTable,_0x40134f,_0x1f3919),await _0x24933a[_0x55c14f(0x158)](syncAllSensorTables),_0x1ce945();});}),_0x5cf00a[_0x3e44d3(0x198)](0xc8)[_0x3e44d3(0x160)]({'message':_0x2dcb1a[_0x3e44d3(0x1a5)],'cloudResponse':_0x4261fb[_0x3e44d3(0x1ac)],'settings':{'interval_seconds':_0x43c4d2,'batch_size':_0x156ef6}});}catch(_0x5b1e51){console['error'](_0x2dcb1a[_0x3e44d3(0x1de)],_0x5b1e51['response']?.[_0x3e44d3(0x1ac)]||_0x5b1e51[_0x3e44d3(0x1e8)]),_0x5cf00a[_0x3e44d3(0x198)](0x1f4)[_0x3e44d3(0x160)]({'message':_0x2dcb1a[_0x3e44d3(0x16e)],'error':_0x5b1e51['response']?.[_0x3e44d3(0x1ac)]||_0x5b1e51[_0x3e44d3(0x1e8)]});}}catch(_0x329fb7){console[_0x3e44d3(0x1b0)](_0x2dcb1a[_0x3e44d3(0x1e5)],_0x329fb7),_0x5cf00a[_0x3e44d3(0x198)](0x1f4)[_0x3e44d3(0x160)]({'message':_0x2dcb1a[_0x3e44d3(0x1ae)],'error':_0x329fb7['message']});}},deactivateSensor=async(_0x2c990b,_0x19e5fa)=>{const _0x489970=a0_0x23bf89,_0x3c54e5={'NKixS':_0x489970(0x1e3),'IJwMB':_0x489970(0x19a),'GMSNE':_0x489970(0x1eb),'MACWl':_0x489970(0x17d),'UIYXd':function(_0x7028bd,_0x3cea64){return _0x7028bd===_0x3cea64;},'ZQPPH':_0x489970(0x1a0),'qZAnY':_0x489970(0x18b),'vwbnA':'Internal\x20Server\x20Error'};try{const {sensorId:_0x20a42c}=_0x2c990b[_0x489970(0x174)];if(!_0x20a42c)return _0x19e5fa[_0x489970(0x198)](0x190)[_0x489970(0x160)]({'message':_0x489970(0x1dc)});db[_0x489970(0x1cd)](_0x489970(0x1ea),[_0x20a42c],async(_0x3d5e8b,_0x3094bb)=>{const _0x28a268=_0x489970;if(_0x3d5e8b)return console[_0x28a268(0x1b0)](_0x3c54e5[_0x28a268(0x1e7)],_0x3d5e8b[_0x28a268(0x1e8)]),_0x19e5fa[_0x28a268(0x198)](0x1f4)[_0x28a268(0x160)]({'message':_0x3c54e5['GMSNE']});if(!_0x3094bb)console['warn'](_0x3c54e5[_0x28a268(0x1c2)]);else{if(_0x3094bb[_0x28a268(0x18f)]===0x1||_0x3c54e5[_0x28a268(0x1d4)](_0x3094bb[_0x28a268(0x169)],0x1))return _0x19e5fa[_0x28a268(0x198)](0x193)[_0x28a268(0x160)]({'message':_0x28a268(0x164),'is_fetching':_0x3094bb[_0x28a268(0x18f)]===0x1,'is_sending':_0x3c54e5[_0x28a268(0x1d4)](_0x3094bb[_0x28a268(0x169)],0x1)});}let _0x3e7c43;try{_0x3e7c43=await getStoredToken(),console[_0x28a268(0x155)](_0x28a268(0x1bf)+_0x3e7c43);}catch(_0x344b24){return _0x19e5fa[_0x28a268(0x198)](0x191)[_0x28a268(0x160)]({'message':_0x3c54e5[_0x28a268(0x1a7)]});}const _0x17187a=process[_0x28a268(0x156)]['CLOUD_API_URL']+_0x28a268(0x1b7);console[_0x28a268(0x155)](_0x28a268(0x1c3)+_0x17187a);try{const _0x3aba28=await axios[_0x28a268(0x17c)](_0x17187a,{'sensorId':_0x20a42c},{'headers':{'Authorization':_0x28a268(0x19e)+_0x3e7c43}});return console[_0x28a268(0x155)](_0x3c54e5['qZAnY'],_0x3aba28[_0x28a268(0x1ac)]),db[_0x28a268(0x18a)](_0x28a268(0x177),[_0x20a42c],_0x3e10a1=>{const _0x382f97=_0x28a268;if(_0x3e10a1)console[_0x382f97(0x1b0)](_0x3c54e5[_0x382f97(0x1db)],_0x3e10a1[_0x382f97(0x1e8)]);else console[_0x382f97(0x155)](_0x382f97(0x1c4)+_0x20a42c+'\x20deactivated\x20in\x20Local\x20DB.');}),_0x19e5fa[_0x28a268(0x198)](0xc8)[_0x28a268(0x160)]({'message':_0x28a268(0x1e1),'cloudResponse':_0x3aba28['data']});}catch(_0x5444f8){return console[_0x28a268(0x1b0)]('‚ùå\x20Failed\x20to\x20deactivate\x20sensor\x20in\x20Cloud:',_0x5444f8[_0x28a268(0x1aa)]?.['data']||_0x5444f8[_0x28a268(0x1e8)]),_0x19e5fa['status'](0x1f4)[_0x28a268(0x160)]({'message':_0x28a268(0x1a3),'error':_0x5444f8[_0x28a268(0x1aa)]?.[_0x28a268(0x1ac)]||_0x5444f8[_0x28a268(0x1e8)]});}});}catch(_0x1ed63f){return console['error'](_0x489970(0x161),_0x1ed63f),_0x19e5fa[_0x489970(0x198)](0x1f4)[_0x489970(0x160)]({'message':_0x3c54e5[_0x489970(0x1b1)],'error':_0x1ed63f['message']});}},removeActiveSensor=async(_0x3b02ef,_0xfcc67b)=>{const _0x74312c=a0_0x23bf89,_0x187092={'sdATa':function(_0x4e67f7){return _0x4e67f7();},'tmYfI':_0x74312c(0x1b4),'ZnFOV':'Sensor\x20ID\x20is\x20required','SelXL':function(_0x20c410){return _0x20c410();},'uGavs':'Unauthorized:\x20Failed\x20to\x20fetch\x20company\x20ID','SSmLe':_0x74312c(0x1a0),'rUMGE':_0x74312c(0x19d),'dzROF':_0x74312c(0x186),'vivzz':'‚ùå\x20Failed\x20to\x20remove\x20sensor\x20in\x20Cloud:','Lrdkn':'Failed\x20to\x20remove\x20sensor\x20in\x20Cloud','kwiNJ':_0x74312c(0x17e)};try{const {sensorId:_0x1a3773}=_0x3b02ef[_0x74312c(0x174)];if(!_0x1a3773)return _0xfcc67b[_0x74312c(0x198)](0x190)[_0x74312c(0x160)]({'message':_0x187092[_0x74312c(0x1ad)]});let _0x2fab1a;try{_0x2fab1a=await _0x187092[_0x74312c(0x18c)](getCompanyIdFromToken);}catch(_0x404427){return _0xfcc67b[_0x74312c(0x198)](0x191)['json']({'message':_0x187092[_0x74312c(0x1bb)]});}let _0x554db5;try{_0x554db5=await _0x187092[_0x74312c(0x1ce)](getStoredToken),console['log'](_0x74312c(0x1bf)+_0x554db5);}catch(_0x583a97){return _0xfcc67b[_0x74312c(0x198)](0x191)['json']({'message':_0x187092[_0x74312c(0x18e)]});}console[_0x74312c(0x155)](_0x74312c(0x16d)+_0x554db5);const _0x137eaf=process['env'][_0x74312c(0x17b)]+'/api/sensors/remove';console[_0x74312c(0x155)](_0x74312c(0x17a)+_0x137eaf);try{const _0x4e291e=await axios[_0x74312c(0x17c)](_0x137eaf,{'sensorId':_0x1a3773,'companyId':_0x2fab1a},{'headers':{'Authorization':'Bearer\x20'+_0x554db5}});console[_0x74312c(0x155)](_0x187092[_0x74312c(0x193)],_0x4e291e[_0x74312c(0x1ac)]),db[_0x74312c(0x18a)]('DELETE\x20FROM\x20LocalActiveSensors\x20WHERE\x20bank_id\x20=\x20?',[_0x1a3773],async _0x1b60b0=>{const _0x4ce841=_0x74312c;if(_0x1b60b0)console[_0x4ce841(0x1b0)](_0x187092[_0x4ce841(0x19b)],_0x1b60b0[_0x4ce841(0x1e8)]);else{console[_0x4ce841(0x155)]('‚úÖ\x20Sensor\x20'+_0x1a3773+_0x4ce841(0x1bc));const _0x1effd8=_0x4ce841(0x1d8)+_0x2fab1a+'_'+_0x1a3773;console[_0x4ce841(0x155)](_0x4ce841(0x197)+_0x1effd8),db[_0x4ce841(0x18a)](_0x4ce841(0x170)+_0x1effd8,async _0x2ae9e0=>{const _0x7ff095=_0x4ce841;_0x2ae9e0?console[_0x7ff095(0x1b0)](_0x7ff095(0x175)+_0x1effd8+':',_0x2ae9e0[_0x7ff095(0x1e8)]):(console[_0x7ff095(0x155)](_0x7ff095(0x1cf)+_0x1effd8+'\x20deleted.'),await _0x187092[_0x7ff095(0x1ce)](syncAllSensorTables));});}}),_0xfcc67b[_0x74312c(0x198)](0xc8)[_0x74312c(0x160)]({'message':_0x187092['dzROF'],'cloudResponse':_0x4e291e['data']});}catch(_0x3d84cb){console[_0x74312c(0x1b0)](_0x187092[_0x74312c(0x185)],_0x3d84cb[_0x74312c(0x1aa)]?.[_0x74312c(0x1ac)]||_0x3d84cb[_0x74312c(0x1e8)]),_0xfcc67b['status'](0x1f4)[_0x74312c(0x160)]({'message':_0x187092[_0x74312c(0x1c5)],'error':_0x3d84cb[_0x74312c(0x1aa)]?.[_0x74312c(0x1ac)]||_0x3d84cb[_0x74312c(0x1e8)]});}}catch(_0x4f994a){console[_0x74312c(0x1b0)](_0x74312c(0x157),_0x4f994a),_0xfcc67b[_0x74312c(0x198)](0x1f4)['json']({'message':_0x187092[_0x74312c(0x196)],'error':_0x4f994a[_0x74312c(0x1e8)]});}},getAllActiveSensors=async(_0x2a85ab,_0x349840)=>{const _0x3aa14f=a0_0x23bf89,_0x2949e9={'fJxFY':_0x3aa14f(0x18d),'bWpxW':_0x3aa14f(0x1dd),'AbEWe':function(_0x5b7978,_0x3aff34){return _0x5b7978(_0x3aff34);},'exlNP':function(_0x400630){return _0x400630();},'WXPlK':_0x3aa14f(0x163),'TdiQw':_0x3aa14f(0x195),'ZMwWx':_0x3aa14f(0x17e)};try{const _0x4888a3=await _0x2949e9[_0x3aa14f(0x1ab)](getStoredToken),_0x461af5=await _0x2949e9[_0x3aa14f(0x1ab)](getCompanyIdFromToken),_0x59ab97=process[_0x3aa14f(0x156)][_0x3aa14f(0x17b)]+_0x3aa14f(0x173),_0x352797=await axios['get'](_0x59ab97,{'headers':{'Authorization':_0x3aa14f(0x19e)+_0x4888a3}}),_0x1622df=_0x352797[_0x3aa14f(0x1ac)]?.[_0x3aa14f(0x1c8)]||[],_0x885050=await new Promise((_0x5bbdc5,_0x5a2908)=>{const _0x1bc17e=_0x3aa14f;db['all'](_0x1bc17e(0x15f),[],(_0x49812d,_0x5b6ccb)=>{const _0x2ee8aa=_0x1bc17e;if(_0x49812d)return console[_0x2ee8aa(0x1b0)](_0x2949e9['fJxFY'],_0x49812d[_0x2ee8aa(0x1e8)]),_0x5a2908(_0x2949e9[_0x2ee8aa(0x15d)]);_0x2949e9[_0x2ee8aa(0x1cc)](_0x5bbdc5,_0x5b6ccb);});}),_0xdfdad7=_0x1622df[_0x3aa14f(0x162)](_0x1b3483=>{const _0x3dabfd=_0x3aa14f,_0x443fc3=_0x885050[_0x3dabfd(0x1b9)](_0x54db3e=>Number(_0x54db3e[_0x3dabfd(0x178)])===Number(_0x1b3483[_0x3dabfd(0x178)]));return{..._0x1b3483,'interval_seconds':_0x443fc3?.[_0x3dabfd(0x1d5)]||0xa,'batch_size':_0x443fc3?.[_0x3dabfd(0x19c)]||0x1};});_0x349840[_0x3aa14f(0x198)](0xc8)[_0x3aa14f(0x160)]({'message':_0x2949e9[_0x3aa14f(0x180)],'sensors':_0xdfdad7});}catch(_0x4c623a){console[_0x3aa14f(0x1b0)](_0x2949e9['TdiQw'],_0x4c623a),_0x349840['status'](0x1f4)[_0x3aa14f(0x160)]({'message':_0x2949e9['ZMwWx'],'error':_0x4c623a[_0x3aa14f(0x1e8)]});}},reactivateSensor=async(_0x28f15b,_0x343cfe)=>{const _0x196879=a0_0x23bf89,_0x352ffd={'CxnbU':_0x196879(0x1dc),'tlDFp':function(_0x1d1bb8){return _0x1d1bb8();},'QNPHL':_0x196879(0x1a0),'mMsna':'Unauthorized:\x20Failed\x20to\x20fetch\x20company\x20ID','PeUVN':'‚úÖ\x20Sensor\x20reactivated\x20successfully\x20in\x20Cloud:','WwQAc':_0x196879(0x1a4),'JxeNE':_0x196879(0x1ba),'kPHUT':_0x196879(0x171)};try{const {sensorId:_0x5e5a3c}=_0x28f15b[_0x196879(0x174)];if(!_0x5e5a3c)return _0x343cfe['status'](0x190)['json']({'message':_0x352ffd[_0x196879(0x1d6)]});let _0x50bb15;try{_0x50bb15=await _0x352ffd[_0x196879(0x1b5)](getStoredToken),console[_0x196879(0x155)]('üîç\x20Using\x20Token:\x20'+_0x50bb15);}catch(_0x261c36){return _0x343cfe[_0x196879(0x198)](0x191)[_0x196879(0x160)]({'message':_0x352ffd['QNPHL']});}let _0x23413b;try{_0x23413b=await _0x352ffd['tlDFp'](getCompanyIdFromToken);}catch(_0x32c29e){return _0x343cfe['status'](0x191)[_0x196879(0x160)]({'message':_0x352ffd[_0x196879(0x1e4)]});}const _0x8c0df3=process[_0x196879(0x156)][_0x196879(0x17b)]+_0x196879(0x1e2);console[_0x196879(0x155)](_0x196879(0x167)+_0x8c0df3);try{const _0x30db1b=await axios[_0x196879(0x17c)](_0x8c0df3,{'sensorId':_0x5e5a3c},{'headers':{'Authorization':_0x196879(0x19e)+_0x50bb15}});console['log'](_0x352ffd[_0x196879(0x159)],_0x30db1b[_0x196879(0x1ac)]),db[_0x196879(0x18a)](_0x196879(0x165),[_0x5e5a3c],_0x431460=>{const _0x2aad5e=_0x196879;_0x431460?console[_0x2aad5e(0x1b0)](_0x2aad5e(0x1e3),_0x431460['message']):console[_0x2aad5e(0x155)](_0x2aad5e(0x1c4)+_0x5e5a3c+_0x2aad5e(0x1ca));}),_0x343cfe[_0x196879(0x198)](0xc8)[_0x196879(0x160)]({'message':_0x352ffd[_0x196879(0x1e0)],'cloudResponse':_0x30db1b[_0x196879(0x1ac)]});}catch(_0x35d3fe){console[_0x196879(0x1b0)](_0x352ffd[_0x196879(0x183)],_0x35d3fe[_0x196879(0x1aa)]?.[_0x196879(0x1ac)]||_0x35d3fe['message']),_0x343cfe[_0x196879(0x198)](0x1f4)[_0x196879(0x160)]({'message':_0x352ffd[_0x196879(0x16f)],'error':_0x35d3fe[_0x196879(0x1aa)]?.[_0x196879(0x1ac)]||_0x35d3fe[_0x196879(0x1e8)]});}}catch(_0x49bc89){console['error'](_0x196879(0x1c6),_0x49bc89),_0x343cfe[_0x196879(0x198)](0x1f4)[_0x196879(0x160)]({'message':_0x196879(0x17e),'error':_0x49bc89['message']});}},updateSensorSettings=async(_0x2b73e2,_0x44bc54)=>{const _0x3c46d7=a0_0x23bf89,_0x1bc3df={'YJdQF':'Failed\x20to\x20update\x20settings','MQmoW':function(_0x80f08a,_0x5afeda){return _0x80f08a===_0x5afeda;},'cWcKq':function(_0x20737d,_0x386892){return _0x20737d==_0x386892;},'gPKBQ':_0x3c46d7(0x1cb),'RwfiC':'‚ùå\x20Error\x20updating\x20sensor\x20settings:','Bpqln':_0x3c46d7(0x17e)};try{const {sensorId:_0x3de498,interval_seconds:_0x5cea15,batch_size:_0x117291}=_0x2b73e2[_0x3c46d7(0x174)];if(!_0x3de498||_0x1bc3df['cWcKq'](_0x5cea15,null)||_0x117291==null)return _0x44bc54[_0x3c46d7(0x198)](0x190)['json']({'message':_0x1bc3df[_0x3c46d7(0x1ed)]});db[_0x3c46d7(0x18a)](_0x3c46d7(0x16a),[_0x5cea15,_0x117291,_0x3de498],function(_0x54b6da){const _0x3b3e21=_0x3c46d7;if(_0x54b6da)return console['error'](_0x3b3e21(0x1e3),_0x54b6da[_0x3b3e21(0x1e8)]),_0x44bc54[_0x3b3e21(0x198)](0x1f4)[_0x3b3e21(0x160)]({'message':_0x1bc3df['YJdQF'],'error':_0x54b6da[_0x3b3e21(0x1e8)]});if(_0x1bc3df['MQmoW'](this[_0x3b3e21(0x1c0)],0x0))return _0x44bc54[_0x3b3e21(0x198)](0x190)['json']({'message':_0x3b3e21(0x1df)});console['log'](_0x3b3e21(0x1c4)+_0x3de498+_0x3b3e21(0x15e)),_0x44bc54['status'](0xc8)[_0x3b3e21(0x160)]({'message':_0x3b3e21(0x176)+_0x3de498+_0x3b3e21(0x16b)});});}catch(_0xe3b784){console[_0x3c46d7(0x1b0)](_0x1bc3df['RwfiC'],_0xe3b784),_0x44bc54[_0x3c46d7(0x198)](0x1f4)[_0x3c46d7(0x160)]({'message':_0x1bc3df[_0x3c46d7(0x166)],'error':_0xe3b784[_0x3c46d7(0x1e8)]});}};module['exports']={'activateSensor':activateSensor,'deactivateSensor':deactivateSensor,'removeActiveSensor':removeActiveSensor,'getAllActiveSensors':getAllActiveSensors,'reactivateSensor':reactivateSensor,'updateSensorSettings':updateSensorSettings};