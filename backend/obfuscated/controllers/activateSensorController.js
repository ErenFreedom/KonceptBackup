const a0_0x6ca14=a0_0x3e2e;function a0_0x3baf(){const _0x40a715=['Rejhz','‚ùå\x20Sensor\x20is\x20actively\x20fetching\x20or\x20sending.\x20Please\x20stop\x20it\x20first\x20before\x20deactivating.','warn','sxsFA','10zaIosA','companyId','XBwts','11512tqGcLv','DgvFq','QrQcw','get','‚úÖ\x20Sensor\x20reactivated\x20successfully\x20in\x20Cloud:','HiXPd','‚ùå\x20Failed\x20to\x20remove\x20sensor\x20in\x20Cloud:','eDetY','‚ùå\x20Error\x20removing\x20sensor:','qrlSy','find','status','Error\x20fetching\x20token\x20from\x20database','‚ùå\x20Error\x20inserting\x20into\x20LocalActiveSensors:','DELETE\x20FROM\x20LocalActiveSensors\x20WHERE\x20bank_id\x20=\x20?','‚ùå\x20Error\x20deactivating\x20sensor:','/api/sensors/active','Internal\x20Server\x20Error','‚ùå\x20Error\x20updating\x20Local\x20DB:','mbGSS','znxup','bank_id','run','DSmif','Bearer\x20','ZGNGN','üì§\x20Sending\x20Removal\x20Request\x20with\x20Token:\x20','RhxPZ','LZKvD','yIFZv','üîç\x20Using\x20Token:\x20','Temyo','SensorData_','RAwjC','Ipuae','‚úÖ\x20Sensor\x20activated\x20successfully\x20in\x20Cloud:','is_sending','xIiJo','Invalid\x20token','‚ùå\x20Failed\x20to\x20reactivate\x20sensor\x20in\x20Cloud:','UExvH','HxNiE','Failed\x20to\x20reactivate\x20sensor\x20in\x20Cloud','Failed\x20to\x20deactivate\x20sensor\x20in\x20Cloud','‚úÖ\x20Table\x20','3532727ZmXgMO','\x20deleted.','TPdgW','jsonwebtoken','CLOUD_API_URL','EYJRU','Sensor\x20ID\x20is\x20required','Fetched\x20active\x20sensors\x20with\x20local\x20settings','Sensor\x20activated\x20successfully','PZocs','JmawN','‚ùå\x20Error\x20activating\x20sensor:','IpWKS','kAfoK','WqYBD','sHBHb','üì§\x20Sending\x20Activation\x20Request\x20with\x20Token:\x20','/api/sensors/reactivate','Unauthorized:\x20Failed\x20to\x20fetch\x20company\x20ID','NbOsf','token','xrWvo','dotenv','\x20deactivated\x20in\x20Local\x20DB.','/api/sensors/remove','sPKta','‚úÖ\x20Sensor\x20','response','7450520ZRaBMO','DROP\x20TABLE\x20IF\x20EXISTS\x20','gKjsO','vrIYE','mHNjE','rOCVn','UwFOO','‚úÖ\x20Sensor\x20deactivated\x20successfully\x20in\x20Cloud:','‚ùå\x20Error\x20fetching\x20token:','Database\x20error','map','10110vfuPfl','wahUg','\x20reactivated\x20in\x20Local\x20DB.','62hPArDQ','\x20settings\x20updated\x20successfully','39511dGfgce','MzUMz','QaCuA','AqdOH','No\x20stored\x20token\x20found.','interval_seconds','‚ùå\x20Error\x20deleting\x20table\x20','üìå\x20Creating\x20sensor\x20data\x20table:\x20','üì§\x20Deactivating\x20Sensor\x20in\x20Cloud:\x20','changes','QMfcB','data','error','sensors','UPDATE\x20LocalActiveSensors\x20SET\x20is_active\x20=\x201\x20WHERE\x20bank_id\x20=\x20?','SELECT\x20token\x20FROM\x20AuthTokens\x20ORDER\x20BY\x20id\x20DESC\x20LIMIT\x201','5756739xcBLrj','10728KtHgQU','Failed\x20to\x20fetch\x20local\x20sensors','‚úÖ\x20Sensor\x20removed\x20from\x20Cloud:','is_fetching','../db/sensorDB','log','qlPqB','‚ùå\x20Error\x20reactivating\x20sensor:','‚ùå\x20Error\x20in\x20getAllActiveSensors:','Unauthorized:\x20Token\x20missing\x20or\x20invalid','‚ùå\x20Failed\x20to\x20deactivate\x20sensor\x20in\x20Cloud:','NqCsZ','5226935OZYLpj','Unauthorized:\x20Failed\x20to\x20get\x20company\x20ID','json','mpwRz','xTuOQ','üì§\x20Re-activating\x20Sensor\x20in\x20Cloud:\x20','../utils/syncAllSensorTables','UPDATE\x20LocalActiveSensors\x20SET\x20is_active\x20=\x200\x20WHERE\x20bank_id\x20=\x20?','QukQn','Sensor\x20ID,\x20interval_seconds,\x20and\x20batch_size\x20are\x20required','s\x20and\x20Batch\x20','jzmHs','CSikl','HxgfN','qFoVD','xbbPo','axios','SELECT\x20is_fetching,\x20is_sending\x20FROM\x20IntervalControl\x20WHERE\x20sensor_id\x20=\x20?','VQdCu','verify','\x20settings\x20updated\x20locally.','gtSHg','env','TGEOw','ZUjNv','CZVKV','iOAfZ','1695MbxIEs','post','Failed\x20to\x20activate\x20sensor\x20in\x20Cloud','message','body','Sensor\x20removed\x20successfully','SELECT\x20bank_id,\x20interval_seconds,\x20batch_size\x20FROM\x20LocalActiveSensors\x20WHERE\x20is_active\x20=\x201'];a0_0x3baf=function(){return _0x40a715;};return a0_0x3baf();}(function(_0x193308,_0x15310f){const _0x20eaad=a0_0x3e2e,_0x52977b=_0x193308();while(!![]){try{const _0x1cdb39=-parseInt(_0x20eaad(0x1ac))/0x1*(parseInt(_0x20eaad(0x1aa))/0x2)+parseInt(_0x20eaad(0x1bc))/0x3+parseInt(_0x20eaad(0x19c))/0x4+-parseInt(_0x20eaad(0x1e4))/0x5*(-parseInt(_0x20eaad(0x1a7))/0x6)+-parseInt(_0x20eaad(0x1c9))/0x7+-parseInt(_0x20eaad(0x1f2))/0x8*(parseInt(_0x20eaad(0x1bd))/0x9)+parseInt(_0x20eaad(0x1ef))/0xa*(parseInt(_0x20eaad(0x180))/0xb);if(_0x1cdb39===_0x15310f)break;else _0x52977b['push'](_0x52977b['shift']());}catch(_0xba6642){_0x52977b['push'](_0x52977b['shift']());}}}(a0_0x3baf,0xf0fc9));const axios=require(a0_0x6ca14(0x1d9)),jwt=require(a0_0x6ca14(0x183)),{db,createSensorDataTable}=require(a0_0x6ca14(0x1c1)),{syncAllSensorTables}=require(a0_0x6ca14(0x1cf));require(a0_0x6ca14(0x196))['config']();const getStoredToken=()=>{const _0xb134a4={'eDetY':function(_0x139d33,_0xfe1e74){return _0x139d33(_0xfe1e74);}};return new Promise((_0x404659,_0xe01f4d)=>{const _0x2af0ee=a0_0x3e2e,_0x59d1b3={'sxsFA':_0x2af0ee(0x1a4),'NqCsZ':_0x2af0ee(0x1fe),'Temyo':function(_0x1e2227,_0x1d1de4){const _0x5514ad=_0x2af0ee;return _0xb134a4[_0x5514ad(0x1f9)](_0x1e2227,_0x1d1de4);}};db['get'](_0x2af0ee(0x1bb),[],(_0x260555,_0x2f0706)=>{const _0x136c03=_0x2af0ee;if(_0x260555)console['error'](_0x59d1b3[_0x136c03(0x1ee)],_0x260555[_0x136c03(0x1e7)]),_0xe01f4d(_0x59d1b3[_0x136c03(0x1c8)]);else!_0x2f0706?_0x59d1b3['Temyo'](_0xe01f4d,_0x136c03(0x1b0)):_0x59d1b3[_0x136c03(0x172)](_0x404659,_0x2f0706[_0x136c03(0x194)]);});});},getCompanyIdFromToken=()=>{const _0x3f87a6=a0_0x6ca14,_0x443f94={'TGEOw':function(_0x4191ce,_0x28298a){return _0x4191ce||_0x28298a;},'HxNiE':function(_0x5affec,_0x581854){return _0x5affec(_0x581854);},'CXrpi':_0x3f87a6(0x1fe),'UwFOO':function(_0x1b128a,_0x17ebd3){return _0x1b128a(_0x17ebd3);},'MzUMz':'‚ùå\x20Error\x20decoding\x20JWT:','HxgfN':_0x3f87a6(0x179),'WqYBD':'SELECT\x20token\x20FROM\x20AuthTokens\x20ORDER\x20BY\x20id\x20DESC\x20LIMIT\x201'};return new Promise((_0x569517,_0x58d15f)=>{const _0x194734=_0x3f87a6,_0x24b97e={'QaCuA':function(_0x18149e,_0x11805f){const _0x1ccb41=a0_0x3e2e;return _0x443f94[_0x1ccb41(0x1e0)](_0x18149e,_0x11805f);},'znxup':function(_0x4f44b4,_0x231149){const _0x1f2809=a0_0x3e2e;return _0x443f94[_0x1f2809(0x17c)](_0x4f44b4,_0x231149);},'EYJRU':_0x443f94['CXrpi'],'qrlSy':function(_0xfe8f3,_0x15d63a){const _0x2232e3=a0_0x3e2e;return _0x443f94[_0x2232e3(0x1a2)](_0xfe8f3,_0x15d63a);},'gKjsO':_0x443f94[_0x194734(0x1ad)],'VQdCu':_0x443f94[_0x194734(0x1d6)]};db[_0x194734(0x1f5)](_0x443f94[_0x194734(0x18e)],[],(_0x74c4a0,_0xf8039c)=>{const _0x4ee55b=_0x194734;if(_0x24b97e[_0x4ee55b(0x1ae)](_0x74c4a0,!_0xf8039c))return console['error']('‚ùå\x20Error\x20fetching\x20token:',_0x74c4a0?.[_0x4ee55b(0x1e7)]||'No\x20token\x20found'),_0x24b97e[_0x4ee55b(0x167)](_0x58d15f,_0x24b97e[_0x4ee55b(0x185)]);try{const _0x31d509=jwt[_0x4ee55b(0x1dc)](_0xf8039c[_0x4ee55b(0x194)],process[_0x4ee55b(0x1df)]['JWT_SECRET_APP']);console[_0x4ee55b(0x1c2)]('üîç\x20Extracted\x20companyId:\x20'+_0x31d509[_0x4ee55b(0x1f0)]),_0x24b97e[_0x4ee55b(0x1fb)](_0x569517,_0x31d509[_0x4ee55b(0x1f0)]);}catch(_0x231f79){console[_0x4ee55b(0x1b8)](_0x24b97e[_0x4ee55b(0x19e)],_0x231f79['message']),_0x24b97e[_0x4ee55b(0x167)](_0x58d15f,_0x24b97e[_0x4ee55b(0x1db)]);}});});},activateSensor=async(_0x5d5c32,_0x3336f6)=>{const _0x4e1056=a0_0x6ca14,_0x2ee01f={'CSikl':_0x4e1056(0x1ff),'uttDw':function(_0x39a882,_0x18c249,_0x114faf){return _0x39a882(_0x18c249,_0x114faf);},'QMfcB':function(_0x232fe6){return _0x232fe6();},'ZtNSJ':_0x4e1056(0x186),'xbbPo':_0x4e1056(0x1ca),'mHNjE':function(_0xb4f753,_0x20b046){return _0xb4f753??_0x20b046;},'tiwDA':function(_0x5eb4b0){return _0x5eb4b0();},'ZGNGN':_0x4e1056(0x176),'rOCVn':'‚ùå\x20Failed\x20to\x20activate\x20sensor\x20in\x20Cloud:','LZKvD':_0x4e1056(0x18b),'iOAfZ':_0x4e1056(0x164)};try{const {sensorId:_0x5aecf1,interval_seconds:_0x4cbf55,batch_size:_0x43852a}=_0x5d5c32['body'];if(!_0x5aecf1)return _0x3336f6[_0x4e1056(0x1fd)](0x190)['json']({'message':_0x2ee01f['ZtNSJ']});let _0x374a45;try{_0x374a45=await getCompanyIdFromToken();}catch(_0x9a03b9){return _0x3336f6['status'](0x191)[_0x4e1056(0x1cb)]({'message':_0x2ee01f[_0x4e1056(0x1d8)]});}const _0xa592b2=_0x2ee01f[_0x4e1056(0x1a0)](_0x4cbf55,0xa),_0x1e580e=_0x2ee01f['mHNjE'](_0x43852a,0x1);let _0x4bd3dc;try{_0x4bd3dc=await _0x2ee01f['tiwDA'](getStoredToken),console[_0x4e1056(0x1c2)](_0x4e1056(0x171)+_0x4bd3dc);}catch(_0x2ed6df){return _0x3336f6[_0x4e1056(0x1fd)](0x191)[_0x4e1056(0x1cb)]({'message':'Unauthorized:\x20Token\x20missing\x20or\x20invalid'});}console[_0x4e1056(0x1c2)](_0x4e1056(0x190)+_0x4bd3dc);const _0xacf2f4=process[_0x4e1056(0x1df)][_0x4e1056(0x184)]+'/api/sensors/activate';try{const _0x59961e=await axios[_0x4e1056(0x1e5)](_0xacf2f4,{'sensorId':_0x5aecf1,'companyId':_0x374a45},{'headers':{'Authorization':'Bearer\x20'+_0x4bd3dc}});console['log'](_0x2ee01f[_0x4e1056(0x16c)],_0x59961e['data']),db[_0x4e1056(0x169)]('INSERT\x20INTO\x20LocalActiveSensors\x20(bank_id,\x20is_active,\x20mode,\x20interval_seconds,\x20batch_size)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x201,\x20\x27manual\x27,\x20?,\x20?)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ON\x20CONFLICT(bank_id)\x20DO\x20UPDATE\x20SET\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20is_active\x20=\x201,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20mode\x20=\x20\x27manual\x27,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20interval_seconds\x20=\x20excluded.interval_seconds,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20batch_size\x20=\x20excluded.batch_size',[_0x5aecf1,_0xa592b2,_0x1e580e],async _0x164c9a=>{const _0x1e99dc=_0x4e1056;if(_0x164c9a)console['error'](_0x2ee01f[_0x1e99dc(0x1d5)],_0x164c9a[_0x1e99dc(0x1e7)]);else{console[_0x1e99dc(0x1c2)]('‚úÖ\x20Sensor\x20'+_0x5aecf1+'\x20activated\x20in\x20Local\x20DB\x20with\x20Interval\x20'+_0xa592b2+_0x1e99dc(0x1d3)+_0x1e580e+'.');const _0x44f4ab=_0x1e99dc(0x173)+_0x374a45+'_'+_0x5aecf1;console[_0x1e99dc(0x1c2)](_0x1e99dc(0x1b3)+_0x44f4ab),await _0x2ee01f['uttDw'](createSensorDataTable,_0x374a45,_0x5aecf1),await _0x2ee01f[_0x1e99dc(0x1b6)](syncAllSensorTables);}}),_0x3336f6['status'](0xc8)['json']({'message':_0x4e1056(0x188),'cloudResponse':_0x59961e[_0x4e1056(0x1b7)],'settings':{'interval_seconds':_0xa592b2,'batch_size':_0x1e580e}});}catch(_0x1959b0){console[_0x4e1056(0x1b8)](_0x2ee01f[_0x4e1056(0x1a1)],_0x1959b0['response']?.[_0x4e1056(0x1b7)]||_0x1959b0[_0x4e1056(0x1e7)]),_0x3336f6[_0x4e1056(0x1fd)](0x1f4)['json']({'message':_0x4e1056(0x1e6),'error':_0x1959b0[_0x4e1056(0x19b)]?.[_0x4e1056(0x1b7)]||_0x1959b0[_0x4e1056(0x1e7)]});}}catch(_0x27261c){console[_0x4e1056(0x1b8)](_0x2ee01f[_0x4e1056(0x16f)],_0x27261c),_0x3336f6[_0x4e1056(0x1fd)](0x1f4)['json']({'message':_0x2ee01f[_0x4e1056(0x1e3)],'error':_0x27261c[_0x4e1056(0x1e7)]});}},deactivateSensor=async(_0x4fac3e,_0x4bf448)=>{const _0x4fcba8=a0_0x6ca14,_0x31a19c={'DVXkW':_0x4fcba8(0x165),'JmawN':'‚ùå\x20Error\x20checking\x20IntervalControl:','ZUjNv':_0x4fcba8(0x1a5),'Ipuae':function(_0x38ccb5,_0x343d81){return _0x38ccb5===_0x343d81;},'RAwjC':function(_0x1c4f81,_0x3a4aaf){return _0x1c4f81===_0x3a4aaf;},'IpWKS':function(_0x1851f){return _0x1851f();},'FDkTf':_0x4fcba8(0x1c6),'xTuOQ':_0x4fcba8(0x1a3),'qlPqB':'Sensor\x20deactivated\x20successfully','GbByM':_0x4fcba8(0x1c7),'fWycT':_0x4fcba8(0x186),'gtSHg':_0x4fcba8(0x201),'RhxPZ':_0x4fcba8(0x164)};try{const {sensorId:_0x1c9724}=_0x4fac3e['body'];if(!_0x1c9724)return _0x4bf448[_0x4fcba8(0x1fd)](0x190)['json']({'message':_0x31a19c['fWycT']});db[_0x4fcba8(0x1f5)](_0x4fcba8(0x1da),[_0x1c9724],async(_0x54dd49,_0x100c4e)=>{const _0x599de4=_0x4fcba8,_0x587f9d={'qFoVD':_0x31a19c['DVXkW']};if(_0x54dd49)return console[_0x599de4(0x1b8)](_0x31a19c[_0x599de4(0x18a)],_0x54dd49['message']),_0x4bf448['status'](0x1f4)[_0x599de4(0x1cb)]({'message':_0x31a19c[_0x599de4(0x1e1)]});if(!_0x100c4e)console[_0x599de4(0x1ed)]('‚ö†Ô∏è\x20No\x20IntervalControl\x20entry\x20found.\x20Proceeding\x20with\x20caution.');else{if(_0x31a19c[_0x599de4(0x175)](_0x100c4e['is_fetching'],0x1)||_0x31a19c[_0x599de4(0x175)](_0x100c4e[_0x599de4(0x177)],0x1))return _0x4bf448['status'](0x193)['json']({'message':_0x599de4(0x1ec),'is_fetching':_0x100c4e[_0x599de4(0x1c0)]===0x1,'is_sending':_0x31a19c[_0x599de4(0x174)](_0x100c4e['is_sending'],0x1)});}let _0x169bfd;try{_0x169bfd=await _0x31a19c[_0x599de4(0x18c)](getStoredToken),console[_0x599de4(0x1c2)](_0x599de4(0x171)+_0x169bfd);}catch(_0x30517b){return _0x4bf448[_0x599de4(0x1fd)](0x191)[_0x599de4(0x1cb)]({'message':_0x31a19c['FDkTf']});}const _0x5e1e57=process[_0x599de4(0x1df)][_0x599de4(0x184)]+'/api/sensors/deactivate';console[_0x599de4(0x1c2)](_0x599de4(0x1b4)+_0x5e1e57);try{const _0x26120c=await axios[_0x599de4(0x1e5)](_0x5e1e57,{'sensorId':_0x1c9724},{'headers':{'Authorization':_0x599de4(0x16b)+_0x169bfd}});return console[_0x599de4(0x1c2)](_0x31a19c[_0x599de4(0x1cd)],_0x26120c[_0x599de4(0x1b7)]),db['run'](_0x599de4(0x1d0),[_0x1c9724],_0x271320=>{const _0x520809=_0x599de4;if(_0x271320)console['error'](_0x587f9d[_0x520809(0x1d7)],_0x271320['message']);else console['log'](_0x520809(0x19a)+_0x1c9724+_0x520809(0x197));}),_0x4bf448['status'](0xc8)[_0x599de4(0x1cb)]({'message':_0x31a19c[_0x599de4(0x1c3)],'cloudResponse':_0x26120c['data']});}catch(_0x14cd7a){return console[_0x599de4(0x1b8)](_0x31a19c['GbByM'],_0x14cd7a[_0x599de4(0x19b)]?.['data']||_0x14cd7a[_0x599de4(0x1e7)]),_0x4bf448[_0x599de4(0x1fd)](0x1f4)['json']({'message':_0x599de4(0x17e),'error':_0x14cd7a[_0x599de4(0x19b)]?.['data']||_0x14cd7a[_0x599de4(0x1e7)]});}});}catch(_0x26ff2e){return console['error'](_0x31a19c[_0x4fcba8(0x1de)],_0x26ff2e),_0x4bf448[_0x4fcba8(0x1fd)](0x1f4)[_0x4fcba8(0x1cb)]({'message':_0x31a19c[_0x4fcba8(0x16e)],'error':_0x26ff2e['message']});}},removeActiveSensor=async(_0x57c5a5,_0x2f0f73)=>{const _0x8aaf00=a0_0x6ca14,_0x502b40={'sHBHb':'‚ùå\x20Error\x20deleting\x20from\x20Local\x20DB:','EOnuQ':'Sensor\x20ID\x20is\x20required','fdeWz':_0x8aaf00(0x192),'Wexhz':function(_0x4dd201){return _0x4dd201();},'mpwRz':'Unauthorized:\x20Token\x20missing\x20or\x20invalid','HiXPd':_0x8aaf00(0x1bf),'mbGSS':_0x8aaf00(0x1f8),'jzmHs':'Failed\x20to\x20remove\x20sensor\x20in\x20Cloud','fVUDO':_0x8aaf00(0x1fa)};try{const {sensorId:_0x185f85}=_0x57c5a5['body'];if(!_0x185f85)return _0x2f0f73[_0x8aaf00(0x1fd)](0x190)[_0x8aaf00(0x1cb)]({'message':_0x502b40['EOnuQ']});let _0x47ee74;try{_0x47ee74=await getCompanyIdFromToken();}catch(_0x527b33){return _0x2f0f73[_0x8aaf00(0x1fd)](0x191)[_0x8aaf00(0x1cb)]({'message':_0x502b40['fdeWz']});}let _0x316092;try{_0x316092=await _0x502b40['Wexhz'](getStoredToken),console['log'](_0x8aaf00(0x171)+_0x316092);}catch(_0x4339ba){return _0x2f0f73['status'](0x191)[_0x8aaf00(0x1cb)]({'message':_0x502b40[_0x8aaf00(0x1cc)]});}console[_0x8aaf00(0x1c2)](_0x8aaf00(0x16d)+_0x316092);const _0x552a85=process[_0x8aaf00(0x1df)][_0x8aaf00(0x184)]+_0x8aaf00(0x198);console[_0x8aaf00(0x1c2)]('üì§\x20Removing\x20Sensor\x20from\x20Active\x20in\x20Cloud:\x20'+_0x552a85);try{const _0x4dff14=await axios['post'](_0x552a85,{'sensorId':_0x185f85,'companyId':_0x47ee74},{'headers':{'Authorization':_0x8aaf00(0x16b)+_0x316092}});console['log'](_0x502b40[_0x8aaf00(0x1f7)],_0x4dff14[_0x8aaf00(0x1b7)]),db[_0x8aaf00(0x169)](_0x8aaf00(0x200),[_0x185f85],async _0x413ca7=>{const _0x52f71f=_0x8aaf00,_0x37e6a9={'QukQn':function(_0x16d016){return _0x16d016();}};if(_0x413ca7)console['error'](_0x502b40[_0x52f71f(0x18f)],_0x413ca7[_0x52f71f(0x1e7)]);else{console[_0x52f71f(0x1c2)](_0x52f71f(0x19a)+_0x185f85+'\x20removed\x20from\x20Local\x20DB.');const _0x17a894=_0x52f71f(0x173)+_0x47ee74+'_'+_0x185f85;console[_0x52f71f(0x1c2)]('üóë\x20Dropping\x20sensor\x20data\x20table:\x20'+_0x17a894),db[_0x52f71f(0x169)](_0x52f71f(0x19d)+_0x17a894,async _0x409716=>{const _0x9b9eee=_0x52f71f;_0x409716?console[_0x9b9eee(0x1b8)](_0x9b9eee(0x1b2)+_0x17a894+':',_0x409716[_0x9b9eee(0x1e7)]):(console[_0x9b9eee(0x1c2)](_0x9b9eee(0x17f)+_0x17a894+_0x9b9eee(0x181)),await _0x37e6a9[_0x9b9eee(0x1d1)](syncAllSensorTables));});}}),_0x2f0f73[_0x8aaf00(0x1fd)](0xc8)[_0x8aaf00(0x1cb)]({'message':_0x8aaf00(0x1e9),'cloudResponse':_0x4dff14[_0x8aaf00(0x1b7)]});}catch(_0x591b17){console['error'](_0x502b40[_0x8aaf00(0x166)],_0x591b17[_0x8aaf00(0x19b)]?.[_0x8aaf00(0x1b7)]||_0x591b17['message']),_0x2f0f73[_0x8aaf00(0x1fd)](0x1f4)[_0x8aaf00(0x1cb)]({'message':_0x502b40[_0x8aaf00(0x1d4)],'error':_0x591b17[_0x8aaf00(0x19b)]?.['data']||_0x591b17[_0x8aaf00(0x1e7)]});}}catch(_0x59f0b9){console['error'](_0x502b40['fVUDO'],_0x59f0b9),_0x2f0f73[_0x8aaf00(0x1fd)](0x1f4)[_0x8aaf00(0x1cb)]({'message':_0x8aaf00(0x164),'error':_0x59f0b9[_0x8aaf00(0x1e7)]});}},getAllActiveSensors=async(_0x21c9de,_0x1ccf5f)=>{const _0x20e039=a0_0x6ca14,_0x1eecba={'lUlvK':_0x20e039(0x1be),'wahUg':function(_0x3fe1cb,_0x2393a8){return _0x3fe1cb(_0x2393a8);},'DgvFq':function(_0x445951){return _0x445951();},'kAfoK':_0x20e039(0x187),'AqdOH':_0x20e039(0x1c5),'yIFZv':'Internal\x20Server\x20Error'};try{const _0x6b53ef=await getStoredToken(),_0x354de4=await _0x1eecba[_0x20e039(0x1f3)](getCompanyIdFromToken),_0x2bca01=process['env'][_0x20e039(0x184)]+_0x20e039(0x163),_0x12e523=await axios['get'](_0x2bca01,{'headers':{'Authorization':_0x20e039(0x16b)+_0x6b53ef}}),_0x3ea245=_0x12e523[_0x20e039(0x1b7)]?.[_0x20e039(0x1b9)]||[],_0x1280f3=await new Promise((_0xa492d,_0x597cbb)=>{const _0x1a60c9=_0x20e039;db['all'](_0x1a60c9(0x1ea),[],(_0x566f76,_0x90cfcd)=>{const _0x5ba0eb=_0x1a60c9;if(_0x566f76)return console[_0x5ba0eb(0x1b8)]('‚ùå\x20Error\x20fetching\x20from\x20Local\x20DB:',_0x566f76[_0x5ba0eb(0x1e7)]),_0x597cbb(_0x1eecba['lUlvK']);_0x1eecba[_0x5ba0eb(0x1a8)](_0xa492d,_0x90cfcd);});}),_0x2a29b8=_0x3ea245[_0x20e039(0x1a6)](_0x54875f=>{const _0x3084cd=_0x20e039,_0x261186=_0x1280f3[_0x3084cd(0x1fc)](_0x1eb32f=>Number(_0x1eb32f[_0x3084cd(0x168)])===Number(_0x54875f[_0x3084cd(0x168)]));return{..._0x54875f,'interval_seconds':_0x261186?.[_0x3084cd(0x1b1)]||0xa,'batch_size':_0x261186?.['batch_size']||0x1};});_0x1ccf5f[_0x20e039(0x1fd)](0xc8)['json']({'message':_0x1eecba[_0x20e039(0x18d)],'sensors':_0x2a29b8});}catch(_0x22b4ce){console[_0x20e039(0x1b8)](_0x1eecba[_0x20e039(0x1af)],_0x22b4ce),_0x1ccf5f[_0x20e039(0x1fd)](0x1f4)[_0x20e039(0x1cb)]({'message':_0x1eecba[_0x20e039(0x170)],'error':_0x22b4ce[_0x20e039(0x1e7)]});}},reactivateSensor=async(_0x319b2a,_0x21673d)=>{const _0x5b7234=a0_0x6ca14,_0x3b5dc1={'XBwts':_0x5b7234(0x165),'xrWvo':function(_0x567ee){return _0x567ee();},'HaZXm':function(_0x22daf2){return _0x22daf2();},'xIiJo':_0x5b7234(0x192),'vrIYE':'Sensor\x20reactivated\x20successfully','Wrqux':_0x5b7234(0x17a),'NbOsf':_0x5b7234(0x17d),'sPKta':_0x5b7234(0x1c4),'uqwzY':_0x5b7234(0x164)};try{const {sensorId:_0x4f8116}=_0x319b2a[_0x5b7234(0x1e8)];if(!_0x4f8116)return _0x21673d[_0x5b7234(0x1fd)](0x190)[_0x5b7234(0x1cb)]({'message':_0x5b7234(0x186)});let _0x445d95;try{_0x445d95=await _0x3b5dc1[_0x5b7234(0x195)](getStoredToken),console[_0x5b7234(0x1c2)](_0x5b7234(0x171)+_0x445d95);}catch(_0x275c99){return _0x21673d[_0x5b7234(0x1fd)](0x191)[_0x5b7234(0x1cb)]({'message':'Unauthorized:\x20Token\x20missing\x20or\x20invalid'});}let _0x28fc0e;try{_0x28fc0e=await _0x3b5dc1['HaZXm'](getCompanyIdFromToken);}catch(_0x4f5fff){return _0x21673d[_0x5b7234(0x1fd)](0x191)[_0x5b7234(0x1cb)]({'message':_0x3b5dc1[_0x5b7234(0x178)]});}const _0x2a6d9e=process[_0x5b7234(0x1df)]['CLOUD_API_URL']+_0x5b7234(0x191);console['log'](_0x5b7234(0x1ce)+_0x2a6d9e);try{const _0x408788=await axios[_0x5b7234(0x1e5)](_0x2a6d9e,{'sensorId':_0x4f8116},{'headers':{'Authorization':_0x5b7234(0x16b)+_0x445d95}});console[_0x5b7234(0x1c2)](_0x5b7234(0x1f6),_0x408788[_0x5b7234(0x1b7)]),db[_0x5b7234(0x169)](_0x5b7234(0x1ba),[_0x4f8116],_0xcfd6cc=>{const _0x4c20cd=_0x5b7234;_0xcfd6cc?console[_0x4c20cd(0x1b8)](_0x3b5dc1[_0x4c20cd(0x1f1)],_0xcfd6cc['message']):console[_0x4c20cd(0x1c2)]('‚úÖ\x20Sensor\x20'+_0x4f8116+_0x4c20cd(0x1a9));}),_0x21673d['status'](0xc8)[_0x5b7234(0x1cb)]({'message':_0x3b5dc1[_0x5b7234(0x19f)],'cloudResponse':_0x408788[_0x5b7234(0x1b7)]});}catch(_0x518c78){console[_0x5b7234(0x1b8)](_0x3b5dc1['Wrqux'],_0x518c78[_0x5b7234(0x19b)]?.[_0x5b7234(0x1b7)]||_0x518c78[_0x5b7234(0x1e7)]),_0x21673d[_0x5b7234(0x1fd)](0x1f4)[_0x5b7234(0x1cb)]({'message':_0x3b5dc1[_0x5b7234(0x193)],'error':_0x518c78['response']?.['data']||_0x518c78[_0x5b7234(0x1e7)]});}}catch(_0x162871){console[_0x5b7234(0x1b8)](_0x3b5dc1[_0x5b7234(0x199)],_0x162871),_0x21673d[_0x5b7234(0x1fd)](0x1f4)[_0x5b7234(0x1cb)]({'message':_0x3b5dc1['uqwzY'],'error':_0x162871[_0x5b7234(0x1e7)]});}},updateSensorSettings=async(_0x161c0d,_0x438036)=>{const _0x577a44=a0_0x6ca14,_0x103145={'QrQcw':_0x577a44(0x165),'CZVKV':'Failed\x20to\x20update\x20settings','BzGAk':function(_0x3d21e1,_0x158b81){return _0x3d21e1===_0x158b81;},'PZocs':'Sensor\x20must\x20be\x20deactivated\x20to\x20update\x20settings','DSmif':function(_0x4c745a,_0x2d728){return _0x4c745a==_0x2d728;},'UExvH':_0x577a44(0x1d2),'TPdgW':'‚ùå\x20Error\x20updating\x20sensor\x20settings:','Rejhz':_0x577a44(0x164)};try{const {sensorId:_0x17854d,interval_seconds:_0xce9110,batch_size:_0x295674}=_0x161c0d[_0x577a44(0x1e8)];if(!_0x17854d||_0x103145[_0x577a44(0x16a)](_0xce9110,null)||_0x103145[_0x577a44(0x16a)](_0x295674,null))return _0x438036[_0x577a44(0x1fd)](0x190)[_0x577a44(0x1cb)]({'message':_0x103145[_0x577a44(0x17b)]});db[_0x577a44(0x169)]('UPDATE\x20LocalActiveSensors\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20SET\x20interval_seconds\x20=\x20?,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20batch_size\x20=\x20?,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20updated_at\x20=\x20CURRENT_TIMESTAMP\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20bank_id\x20=\x20?\x20AND\x20is_active\x20=\x200',[_0xce9110,_0x295674,_0x17854d],function(_0x5667bd){const _0x316d97=_0x577a44;if(_0x5667bd)return console[_0x316d97(0x1b8)](_0x103145[_0x316d97(0x1f4)],_0x5667bd[_0x316d97(0x1e7)]),_0x438036[_0x316d97(0x1fd)](0x1f4)[_0x316d97(0x1cb)]({'message':_0x103145[_0x316d97(0x1e2)],'error':_0x5667bd[_0x316d97(0x1e7)]});if(_0x103145['BzGAk'](this[_0x316d97(0x1b5)],0x0))return _0x438036['status'](0x190)[_0x316d97(0x1cb)]({'message':_0x103145[_0x316d97(0x189)]});console[_0x316d97(0x1c2)]('‚úÖ\x20Sensor\x20'+_0x17854d+_0x316d97(0x1dd)),_0x438036[_0x316d97(0x1fd)](0xc8)[_0x316d97(0x1cb)]({'message':'Sensor\x20'+_0x17854d+_0x316d97(0x1ab)});});}catch(_0x41c772){console[_0x577a44(0x1b8)](_0x103145[_0x577a44(0x182)],_0x41c772),_0x438036[_0x577a44(0x1fd)](0x1f4)['json']({'message':_0x103145[_0x577a44(0x1eb)],'error':_0x41c772[_0x577a44(0x1e7)]});}};function a0_0x3e2e(_0x4ad5d7,_0x545137){const _0x3baf06=a0_0x3baf();return a0_0x3e2e=function(_0x3baf9c,_0x3e2ee8){_0x3baf9c=_0x3baf9c-0x163;let _0x14f834=_0x3baf06[_0x3baf9c];return _0x14f834;},a0_0x3e2e(_0x4ad5d7,_0x545137);}module['exports']={'activateSensor':activateSensor,'deactivateSensor':deactivateSensor,'removeActiveSensor':removeActiveSensor,'getAllActiveSensors':getAllActiveSensors,'reactivateSensor':reactivateSensor,'updateSensorSettings':updateSensorSettings};