const a0_0x5b8833=a0_0x5666;function a0_0x4efd(){const _0x3da7f0=['879276SVaRoO','Failed\x20to\x20deactivate\x20sensor\x20in\x20Cloud','Sensor\x20must\x20be\x20deactivated\x20to\x20update\x20settings','❌\x20Error\x20activating\x20sub-site\x20sensor:','4000098UpvFPg','SensorData_','/api/subsite/sensor/activation/activate','Update\x20failed','FsUWo','batch_size','all','Failed\x20to\x20fetch\x20local\x20sub-site\x20sensors','TJofb','LwFiq','6658638Onzsop','interval_seconds','SELECT\x20is_fetching,\x20is_sending\x20FROM\x20','json','2706375OAYsUH','✅\x20Sub-site\x20Sensor\x20','DROP\x20TABLE\x20IF\x20EXISTS\x20','(id)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','bpVCx','5MjTTzh','❌\x20DB\x20Insert\x20failed:','KirFD','❌\x20Failed\x20to\x20reactivate\x20sub-site\x20sensor:','HtLIu','oZRTI','body','log','dvxGc','ltAkA','vPJdb','⚠️\x20No\x20IntervalControl\x20entry\x20found.\x20Proceeding\x20with\x20caution.','uAleI','/api/subsite/sensor/activation/reactivate','split','data','Sensor\x20reactivated\x20successfully','6540416cTLKVP','qnRsa','❌\x20Failed\x20to\x20create\x20SensorData\x20table\x20','mnMDJ','verify','qnXNo','SELECT\x20token\x20FROM\x20AuthTokens\x20ORDER\x20BY\x20id\x20DESC\x20LIMIT\x201','1421613PDnCLP','Bearer\x20','message','LhsXK','vpunm','zeASF','❌\x20Cloud\x20deactivation\x20failed:','ZWnEQ','❌\x20Failed\x20to\x20delete\x20from\x20','pcAVE','✅\x20Sensor\x20','❌\x20Error\x20deactivating\x20subsite\x20sensor:','Table\x20creation\x20failed','BzWbE','zEIMG','HkbxS','❌\x20Sensor\x20is\x20actively\x20fetching\x20or\x20sending.\x20Please\x20stop\x20it\x20first\x20before\x20deactivating.','yLFlv','find','companyId','dotenv','Sensor\x20not\x20found\x20in\x20local\x20DB','sPlrX','OqhZK','❌\x20Local\x20DB\x20error:','✅\x20Sub-site\x20sensor\x20reactivated\x20in\x20Cloud:','\x20SET\x20is_active\x20=\x200\x20WHERE\x20bank_id\x20=\x20?','\x20WHERE\x20is_active\x20=\x201','iXLts','\x20deactivated\x20in\x20sub-site\x20','error','\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20sensor_id\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20value\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20quality\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20quality_good\x20BOOLEAN,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20timestamp\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY(sensor_id)\x20REFERENCES\x20SensorBank_','❌\x20DB\x20update\x20failed:','eKbVZ','status','Fetched\x20sub-site\x20active\x20sensors\x20with\x20local\x20settings','Sensor\x20ID\x20and\x20Subsite\x20ID\x20required','ymiFt','Internal\x20Server\x20Error','❌\x20Error\x20removing\x20subsite\x20sensor:','dRJGk','\x20reactivated\x20locally.','\x20settings\x20updated','Sensor\x20deactivated\x20successfully','SELECT\x20id\x20FROM\x20','HKHeH','/api/subsite/sensor/activation/deactivate','QvHWG','Authorization\x20token\x20missing','DELETE\x20FROM\x20','../db/sensorDB','cHITe','get','993998ZervUD','ecBoQ','BTTMO','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20(id,\x20bank_id,\x20mode,\x20interval_seconds,\x20batch_size,\x20is_active,\x20created_at,\x20updated_at)\x0a\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20\x27manual\x27,\x20?,\x20?,\x201,\x20datetime(\x27now\x27),\x20datetime(\x27now\x27))\x0a\x20\x20\x20\x20\x20\x20\x20ON\x20CONFLICT(id)\x20DO\x20UPDATE\x20SET\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20is_active\x20=\x201,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20interval_seconds\x20=\x20excluded.interval_seconds,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20batch_size\x20=\x20excluded.batch_size','Sensor\x20','JWT_SECRET_APP','qDSzt','INSERT\x20INTO\x20','chEBK','env','\x20settings\x20updated\x20successfully','axios','viSQS','❌\x20Error\x20updating\x20sub-site\x20sensor\x20settings:','No\x20token\x20found','sensors','bank_id','post','\x20WHERE\x20sensor_id\x20=\x20?','Activation\x20failed','Wsqgm','Sub-site\x20ID\x20is\x20required','run','gGERc','FlXjX','exports','UPDATE\x20','\x20WHERE\x20bank_id\x20=\x20?','is_sending','headers','❌\x20Error\x20updating\x20sensor\x20settings:','uBmHz','❌\x20IntervalControl\x20check\x20failed:','tkNqj','BNeBo','rCaDp','changes','/api/subsite/sensor/activation/remove','token','jsonwebtoken','Deactivation\x20failed','cNVmG','CLOUD_API_URL','query','1Xferif','50QdZJdS','jIhbc','Removal\x20failed','❌\x20Sensor\x20lookup\x20failed:','Sensor_','is_fetching','rAirk','LNljw','KqUBP','Local\x20DB\x20insert\x20failed','\x20SET\x20is_active\x20=\x201\x20WHERE\x20bank_id\x20=\x20?','response','KugnU','❌\x20Error\x20updating\x20local\x20sub-site\x20DB:'];a0_0x4efd=function(){return _0x3da7f0;};return a0_0x4efd();}(function(_0x13a675,_0x1c49a0){const _0x1c5c0c=a0_0x5666,_0x3ef6c7=_0x13a675();while(!![]){try{const _0x24ad55=parseInt(_0x1c5c0c(0x1f8))/0x1*(-parseInt(_0x1c5c0c(0x1cc))/0x2)+parseInt(_0x1c5c0c(0x17a))/0x3+-parseInt(_0x1c5c0c(0x207))/0x4+parseInt(_0x1c5c0c(0x17f))/0x5*(-parseInt(_0x1c5c0c(0x20b))/0x6)+parseInt(_0x1c5c0c(0x176))/0x7+parseInt(_0x1c5c0c(0x190))/0x8+-parseInt(_0x1c5c0c(0x197))/0x9*(parseInt(_0x1c5c0c(0x1f9))/0xa);if(_0x24ad55===_0x1c49a0)break;else _0x3ef6c7['push'](_0x3ef6c7['shift']());}catch(_0x2ebf3d){_0x3ef6c7['push'](_0x3ef6c7['shift']());}}}(a0_0x4efd,0x797d9));const axios=require(a0_0x5b8833(0x1d7)),jwt=require(a0_0x5b8833(0x1f3)),{db,createSensorDataTable}=require(a0_0x5b8833(0x1c9));function a0_0x5666(_0x1a121a,_0x59077e){const _0x4efd44=a0_0x4efd();return a0_0x5666=function(_0x566663,_0x14a8d2){_0x566663=_0x566663-0x170;let _0x548504=_0x4efd44[_0x566663];return _0x548504;},a0_0x5666(_0x1a121a,_0x59077e);}require(a0_0x5b8833(0x1ab))['config']();const getStoredToken=()=>{const _0xe7d0f3=a0_0x5b8833,_0x1b44c3={'BzWbE':function(_0x3388fc,_0x4fa8ca){return _0x3388fc||_0x4fa8ca;},'ecBoQ':function(_0x4e4022,_0x5a0ab1){return _0x4e4022(_0x5a0ab1);},'dRJGk':_0xe7d0f3(0x196)};return new Promise((_0x13dc6b,_0x3f3650)=>{const _0x11ccd2=_0xe7d0f3;db[_0x11ccd2(0x1cb)](_0x1b44c3[_0x11ccd2(0x1bf)],[],(_0xcdcf2e,_0x3cd1e8)=>{const _0x51ed5f=_0x11ccd2;if(_0x1b44c3[_0x51ed5f(0x1a4)](_0xcdcf2e,!_0x3cd1e8))return _0x1b44c3[_0x51ed5f(0x1cd)](_0x3f3650,_0x51ed5f(0x1da));_0x13dc6b(_0x3cd1e8[_0x51ed5f(0x1f2)]);});});},getAdminDetailsFromToken=async()=>{const _0x12eb96=a0_0x5b8833,_0x440aa1={'iXLts':function(_0x102325){return _0x102325();}},_0x424636=await _0x440aa1[_0x12eb96(0x1b3)](getStoredToken),_0x43b77f=jwt[_0x12eb96(0x194)](_0x424636,process[_0x12eb96(0x1d5)][_0x12eb96(0x1d1)]);return{'token':_0x424636,'companyId':_0x43b77f[_0x12eb96(0x1aa)]};},activateSubSiteSensor=async(_0x327e20,_0x5ef057)=>{const _0x2d7968=a0_0x5b8833,_0x5d9a60={'LcIcM':_0x2d7968(0x1a3),'ltAkA':'Sensor\x20activated\x20successfully','rCaDp':_0x2d7968(0x202),'cHITe':function(_0x2e1227,_0x241246){return _0x2e1227||_0x241246;},'OqhZK':_0x2d7968(0x1bb),'zEIMG':function(_0x2ca130,_0xd6fbf4){return _0x2ca130??_0xd6fbf4;},'jJFMf':_0x2d7968(0x20a),'qnRsa':_0x2d7968(0x1df)};try{const {sensorId:_0x333f35,subsiteId:_0x2ef2cf,interval_seconds:_0xfff6a6,batch_size:_0x556aa0}=_0x327e20[_0x2d7968(0x185)];if(_0x5d9a60[_0x2d7968(0x1ca)](!_0x333f35,!_0x2ef2cf))return _0x5ef057['status'](0x190)[_0x2d7968(0x179)]({'message':_0x5d9a60[_0x2d7968(0x1ae)]});const {token:_0x2510bf,companyId:_0x192510}=await getAdminDetailsFromToken(),_0x4dab38=_0x5d9a60[_0x2d7968(0x1a5)](_0xfff6a6,0xa),_0x423774=_0x5d9a60[_0x2d7968(0x1a5)](_0x556aa0,0x5),_0x3b2c45=process[_0x2d7968(0x1d5)][_0x2d7968(0x1f6)]+_0x2d7968(0x20d);await axios[_0x2d7968(0x1dd)](_0x3b2c45,{'sensorId':_0x333f35,'subsiteId':_0x2ef2cf,'companyId':_0x192510},{'headers':{'Authorization':_0x2d7968(0x198)+_0x2510bf}});const _0x47b04f=_0x2d7968(0x1fd)+_0x192510+'_'+_0x2ef2cf,_0x25b478=_0x2d7968(0x20c)+_0x192510+'_'+_0x2ef2cf+'_'+_0x333f35;db[_0x2d7968(0x1e2)](_0x2d7968(0x1d3)+_0x47b04f+_0x2d7968(0x1cf),[_0x333f35,_0x333f35,_0x4dab38,_0x423774],_0x18c67c=>{const _0x36f3bb=_0x2d7968;if(_0x18c67c)return console[_0x36f3bb(0x1b5)](_0x36f3bb(0x180),_0x18c67c[_0x36f3bb(0x199)]),_0x5ef057[_0x36f3bb(0x1b9)](0x1f4)[_0x36f3bb(0x179)]({'message':_0x5d9a60[_0x36f3bb(0x1ef)]});db[_0x36f3bb(0x1e2)]('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x25b478+_0x36f3bb(0x1b6)+_0x192510+'_'+_0x2ef2cf+_0x36f3bb(0x17d),_0x4f4a7f=>{const _0x5702a3=_0x36f3bb;if(_0x4f4a7f)return console['error'](_0x5702a3(0x192)+_0x25b478+':',_0x4f4a7f[_0x5702a3(0x199)]),_0x5ef057[_0x5702a3(0x1b9)](0x1f4)[_0x5702a3(0x179)]({'message':_0x5d9a60['LcIcM']});_0x5ef057[_0x5702a3(0x1b9)](0xc8)[_0x5702a3(0x179)]({'message':_0x5d9a60[_0x5702a3(0x188)]});});});}catch(_0x5c4e07){console[_0x2d7968(0x1b5)](_0x5d9a60['jJFMf'],_0x5c4e07[_0x2d7968(0x199)]),_0x5ef057['status'](0x1f4)[_0x2d7968(0x179)]({'message':_0x5d9a60[_0x2d7968(0x191)],'error':_0x5c4e07[_0x2d7968(0x199)]});}},deactivateSubSiteSensor=async(_0x395ace,_0x1e04fc)=>{const _0x3d0f9b=a0_0x5b8833,_0x3c4ee0={'KirFD':_0x3d0f9b(0x1c2),'uAleI':'Database\x20error\x20while\x20checking\x20IntervalControl','ymiFt':_0x3d0f9b(0x18a),'gGERc':function(_0x15bbe6,_0x5d996a){return _0x15bbe6===_0x5d996a;},'LwFiq':_0x3d0f9b(0x19d),'EYwPa':function(_0x5c3ed3,_0x30423b){return _0x5c3ed3||_0x30423b;},'LNljw':_0x3d0f9b(0x1fc),'FsUWo':_0x3d0f9b(0x1bb),'viSQS':function(_0x272aa3,_0x384f4d){return _0x272aa3(_0x384f4d);},'KugnU':_0x3d0f9b(0x1a2),'qDSzt':_0x3d0f9b(0x1f4)};try{const {sensorId:_0x45b6d5,subsiteId:_0x221d39}=_0x395ace[_0x3d0f9b(0x185)];if(!_0x45b6d5||!_0x221d39)return _0x1e04fc[_0x3d0f9b(0x1b9)](0x190)['json']({'message':_0x3c4ee0[_0x3d0f9b(0x170)]});const {token:_0x3687b9,companyId:_0x44851c}=await _0x3c4ee0[_0x3d0f9b(0x1d8)](getAdminDetailsFromToken,_0x395ace),_0x3c16ea='IntervalControl_'+_0x44851c+'_'+_0x221d39,_0x24bd93=_0x3d0f9b(0x1fd)+_0x44851c+'_'+_0x221d39;db['get'](_0x3d0f9b(0x1c3)+_0x24bd93+_0x3d0f9b(0x1e7),[_0x45b6d5],(_0x993c8f,_0x176b3c)=>{const _0x1796ce=_0x3d0f9b,_0x3ef6ef={'RTqCn':_0x1796ce(0x1b7),'tkNqj':'Local\x20deactivation\x20failed','HkbxS':_0x3c4ee0[_0x1796ce(0x181)],'KqUBP':_0x1796ce(0x1ec),'pzVJb':_0x3c4ee0[_0x1796ce(0x18b)],'ueflw':_0x3c4ee0[_0x1796ce(0x1bc)],'HtLIu':function(_0x47f141,_0x64c2fb){return _0x47f141===_0x64c2fb;},'QvHWG':function(_0x1add1b,_0x14844d){const _0x2ba939=_0x1796ce;return _0x3c4ee0[_0x2ba939(0x1e3)](_0x1add1b,_0x14844d);},'mnMDJ':function(_0x526df4,_0x57ae12){return _0x526df4===_0x57ae12;},'vpunm':_0x3c4ee0[_0x1796ce(0x175)]};if(_0x3c4ee0['EYwPa'](_0x993c8f,!_0x176b3c))return console[_0x1796ce(0x1b5)](_0x3c4ee0[_0x1796ce(0x200)],_0x993c8f?.[_0x1796ce(0x199)]),_0x1e04fc[_0x1796ce(0x1b9)](0x194)[_0x1796ce(0x179)]({'message':_0x1796ce(0x1ac)});const _0xc297fa=_0x176b3c['id'];db[_0x1796ce(0x1cb)](_0x1796ce(0x178)+_0x3c16ea+_0x1796ce(0x1de),[_0xc297fa],async(_0x5ad7a2,_0x397071)=>{const _0x338114=_0x1796ce;if(_0x5ad7a2)return console['error'](_0x3ef6ef[_0x338114(0x201)],_0x5ad7a2[_0x338114(0x199)]),_0x1e04fc[_0x338114(0x1b9)](0x1f4)[_0x338114(0x179)]({'message':_0x3ef6ef['pzVJb']});if(!_0x397071)console['warn'](_0x3ef6ef['ueflw']);else{if(_0x3ef6ef[_0x338114(0x183)](_0x397071[_0x338114(0x1fe)],0x1)||_0x3ef6ef[_0x338114(0x1c6)](_0x397071[_0x338114(0x1e8)],0x1))return _0x1e04fc[_0x338114(0x1b9)](0x193)[_0x338114(0x179)]({'message':_0x338114(0x1a7),'is_fetching':_0x3ef6ef[_0x338114(0x183)](_0x397071['is_fetching'],0x1),'is_sending':_0x3ef6ef[_0x338114(0x193)](_0x397071[_0x338114(0x1e8)],0x1)});}const _0x387fb1=process[_0x338114(0x1d5)]['CLOUD_API_URL']+_0x338114(0x1c5);try{await axios[_0x338114(0x1dd)](_0x387fb1,{'sensorId':_0x45b6d5,'subsiteId':_0x221d39},{'headers':{'Authorization':_0x338114(0x198)+_0x3687b9}}),db[_0x338114(0x1e2)](_0x338114(0x1e6)+_0x24bd93+_0x338114(0x1b1),[_0x45b6d5],_0x57a599=>{const _0x32c0c2=_0x338114;if(_0x57a599)return console[_0x32c0c2(0x1b5)](_0x3ef6ef['RTqCn'],_0x57a599[_0x32c0c2(0x199)]),_0x1e04fc[_0x32c0c2(0x1b9)](0x1f4)[_0x32c0c2(0x179)]({'message':_0x3ef6ef[_0x32c0c2(0x1ed)]});return console['log'](_0x32c0c2(0x1a1)+_0x45b6d5+_0x32c0c2(0x1b4)+_0x221d39),_0x1e04fc[_0x32c0c2(0x1b9)](0xc8)[_0x32c0c2(0x179)]({'message':_0x3ef6ef[_0x32c0c2(0x1a6)]});});}catch(_0x14303f){return console[_0x338114(0x1b5)](_0x3ef6ef[_0x338114(0x19b)],_0x14303f[_0x338114(0x204)]?.['data']||_0x14303f[_0x338114(0x199)]),_0x1e04fc[_0x338114(0x1b9)](0x1f4)[_0x338114(0x179)]({'message':_0x338114(0x208),'error':_0x14303f[_0x338114(0x204)]?.['data']||_0x14303f[_0x338114(0x199)]});}});});}catch(_0x2702ad){console['error'](_0x3c4ee0[_0x3d0f9b(0x205)],_0x2702ad[_0x3d0f9b(0x199)]),_0x1e04fc[_0x3d0f9b(0x1b9)](0x1f4)[_0x3d0f9b(0x179)]({'message':_0x3c4ee0[_0x3d0f9b(0x1d2)],'error':_0x2702ad[_0x3d0f9b(0x199)]});}},removeSubSiteSensor=async(_0x51cbd7,_0x4d18b4)=>{const _0x3c92e7=a0_0x5b8833,_0x387ab7={'oZRTI':'Sensor\x20removed\x20and\x20table\x20dropped','dvxGc':function(_0x69b2a3,_0x2bbc3c){return _0x69b2a3||_0x2bbc3c;},'eKbVZ':_0x3c92e7(0x1bb),'pcAVE':function(_0x1ba6ee){return _0x1ba6ee();},'vPJdb':_0x3c92e7(0x1fb)};try{const {sensorId:_0xb5091a,subsiteId:_0x3058f3}=_0x51cbd7['body'];if(_0x387ab7[_0x3c92e7(0x187)](!_0xb5091a,!_0x3058f3))return _0x4d18b4['status'](0x190)['json']({'message':_0x387ab7[_0x3c92e7(0x1b8)]});const {token:_0x1d4744,companyId:_0x1c5f1a}=await _0x387ab7[_0x3c92e7(0x1a0)](getAdminDetailsFromToken),_0x68f176=process['env'][_0x3c92e7(0x1f6)]+_0x3c92e7(0x1f1);await axios[_0x3c92e7(0x1dd)](_0x68f176,{'sensorId':_0xb5091a,'subsiteId':_0x3058f3},{'headers':{'Authorization':'Bearer\x20'+_0x1d4744}});const _0x2d5591=_0x3c92e7(0x1fd)+_0x1c5f1a+'_'+_0x3058f3,_0x50524a='SensorData_'+_0x1c5f1a+'_'+_0x3058f3+'_'+_0xb5091a;db[_0x3c92e7(0x1e2)](_0x3c92e7(0x1c8)+_0x2d5591+_0x3c92e7(0x1e7),[_0xb5091a],_0xab8de4=>{const _0x576471=_0x3c92e7,_0x2ca12e={'chEBK':_0x387ab7[_0x576471(0x184)]};if(_0xab8de4)console['error'](_0x576471(0x19f)+_0x2d5591+':',_0xab8de4[_0x576471(0x199)]);else db['run'](_0x576471(0x17c)+_0x50524a,async _0x1bd5fe=>{const _0x4e82ad=_0x576471;if(_0x1bd5fe)console['error']('❌\x20Failed\x20to\x20drop\x20table\x20'+_0x50524a+':',_0x1bd5fe[_0x4e82ad(0x199)]);else _0x4d18b4[_0x4e82ad(0x1b9)](0xc8)[_0x4e82ad(0x179)]({'message':_0x2ca12e[_0x4e82ad(0x1d4)]});});});}catch(_0x3d2644){console[_0x3c92e7(0x1b5)](_0x3c92e7(0x1be),_0x3d2644[_0x3c92e7(0x199)]),_0x4d18b4[_0x3c92e7(0x1b9)](0x1f4)['json']({'message':_0x387ab7[_0x3c92e7(0x189)],'error':_0x3d2644[_0x3c92e7(0x199)]});}},getAllActiveSubSiteSensors=async(_0x3e9d1a,_0x17ee8d)=>{const _0x4254bf=a0_0x5b8833,_0x10dcac={'apRHS':function(_0x3891e1,_0x205450){return _0x3891e1(_0x205450);},'Wsqgm':_0x4254bf(0x173),'cNVmG':function(_0x49a813,_0x2a663e){return _0x49a813(_0x2a663e);},'sPlrX':_0x4254bf(0x1bd)};try{const {subsiteId:_0x618b89}=_0x3e9d1a[_0x4254bf(0x1f7)];if(!_0x618b89)return _0x17ee8d[_0x4254bf(0x1b9)](0x190)['json']({'message':_0x4254bf(0x1e1)});const _0x2d9602=_0x3e9d1a[_0x4254bf(0x1e9)]['authorization']?.[_0x4254bf(0x18d)]('\x20')[0x1];if(!_0x2d9602)return _0x17ee8d['status'](0x191)[_0x4254bf(0x179)]({'message':_0x4254bf(0x1c7)});const {companyId:_0x43cb93}=_0x10dcac[_0x4254bf(0x1f5)](getAdminDetailsFromToken,_0x3e9d1a),_0x4e2d2a=process[_0x4254bf(0x1d5)][_0x4254bf(0x1f6)]+'/api/subsite/sensor/activation/active?subsite_id='+_0x618b89,_0x88707b=await axios[_0x4254bf(0x1cb)](_0x4e2d2a,{'headers':{'Authorization':_0x4254bf(0x198)+_0x2d9602}}),_0x493319=_0x88707b[_0x4254bf(0x18e)]?.[_0x4254bf(0x1db)]||[],_0xc1394f=_0x4254bf(0x1fd)+_0x43cb93+'_'+_0x618b89,_0x19defe=await new Promise((_0x2e05f4,_0x4f17c9)=>{const _0x11782b=_0x4254bf,_0x172dab={'HKHeH':_0x11782b(0x1af),'ZWnEQ':function(_0x372f5d,_0x3f1fb1){return _0x10dcac['apRHS'](_0x372f5d,_0x3f1fb1);},'uBmHz':_0x10dcac[_0x11782b(0x1e0)]};db[_0x11782b(0x172)]('SELECT\x20bank_id,\x20interval_seconds,\x20batch_size\x20FROM\x20'+_0xc1394f+_0x11782b(0x1b2),[],(_0x4e5436,_0x315559)=>{const _0x4edcb1=_0x11782b;if(_0x4e5436)return console[_0x4edcb1(0x1b5)](_0x172dab[_0x4edcb1(0x1c4)],_0x4e5436[_0x4edcb1(0x199)]),_0x172dab[_0x4edcb1(0x19e)](_0x4f17c9,_0x172dab[_0x4edcb1(0x1eb)]);_0x2e05f4(_0x315559);});}),_0x437886=_0x493319['map'](_0x4c6842=>{const _0xe21e87=_0x4254bf,_0x3d8fba=_0x19defe[_0xe21e87(0x1a9)](_0x23c656=>Number(_0x23c656[_0xe21e87(0x1dc)])===Number(_0x4c6842['bank_id']));return{..._0x4c6842,'interval_seconds':_0x3d8fba?.[_0xe21e87(0x177)]||0xa,'batch_size':_0x3d8fba?.[_0xe21e87(0x171)]||0x1};});_0x17ee8d[_0x4254bf(0x1b9)](0xc8)[_0x4254bf(0x179)]({'message':_0x4254bf(0x1ba),'sensors':_0x437886});}catch(_0x465d88){console[_0x4254bf(0x1b5)]('❌\x20Error\x20in\x20getAllActiveSubSiteSensors:',_0x465d88),_0x17ee8d[_0x4254bf(0x1b9)](0x1f4)[_0x4254bf(0x179)]({'message':_0x10dcac[_0x4254bf(0x1ad)],'error':_0x465d88[_0x4254bf(0x199)]});}},reactivateSubSiteSensor=async(_0x5ec850,_0x614657)=>{const _0x4c38c7=a0_0x5b8833,_0x10ae72={'qnXNo':function(_0x57c288,_0x2b1dd5){return _0x57c288||_0x2b1dd5;},'jIhbc':function(_0x24239c){return _0x24239c();},'BNeBo':_0x4c38c7(0x1b0),'yLFlv':_0x4c38c7(0x18f),'TJofb':'Failed\x20to\x20reactivate\x20sensor'};try{const {sensorId:_0x45bc24,subsiteId:_0x4393a4}=_0x5ec850[_0x4c38c7(0x185)];if(_0x10ae72[_0x4c38c7(0x195)](!_0x45bc24,!_0x4393a4))return _0x614657[_0x4c38c7(0x1b9)](0x190)[_0x4c38c7(0x179)]({'message':'Sensor\x20ID\x20and\x20sub-site\x20ID\x20are\x20required'});const _0x1e4406=await _0x10ae72[_0x4c38c7(0x1fa)](getStoredToken),_0x18250e=await _0x10ae72[_0x4c38c7(0x1fa)](getAdminDetailsFromToken),_0x36ab7d=process[_0x4c38c7(0x1d5)][_0x4c38c7(0x1f6)]+_0x4c38c7(0x18c),_0x3f457b=await axios['post'](_0x36ab7d,{'sensorId':_0x45bc24,'subsiteId':_0x4393a4},{'headers':{'Authorization':_0x4c38c7(0x198)+_0x1e4406}});console[_0x4c38c7(0x186)](_0x10ae72[_0x4c38c7(0x1ee)],_0x3f457b['data']);const _0x5e34f0=_0x4c38c7(0x1fd)+_0x18250e+'_'+_0x4393a4;db[_0x4c38c7(0x1e2)](_0x4c38c7(0x1e6)+_0x5e34f0+_0x4c38c7(0x203),[_0x45bc24],_0x1ada79=>{const _0x15b284=_0x4c38c7;_0x1ada79?console[_0x15b284(0x1b5)](_0x15b284(0x206),_0x1ada79['message']):console['log'](_0x15b284(0x17b)+_0x45bc24+_0x15b284(0x1c0));}),_0x614657[_0x4c38c7(0x1b9)](0xc8)[_0x4c38c7(0x179)]({'message':_0x10ae72[_0x4c38c7(0x1a8)],'cloudResponse':_0x3f457b['data']});}catch(_0xddbf2b){console[_0x4c38c7(0x1b5)](_0x4c38c7(0x182),_0xddbf2b['response']?.['data']||_0xddbf2b[_0x4c38c7(0x199)]),_0x614657[_0x4c38c7(0x1b9)](0x1f4)[_0x4c38c7(0x179)]({'message':_0x10ae72[_0x4c38c7(0x174)],'error':_0xddbf2b[_0x4c38c7(0x199)]});}},updateSubSiteSensorSettings=async(_0x36bd2e,_0x175b94)=>{const _0x3e254e=a0_0x5b8833,_0x31710c={'zeASF':_0x3e254e(0x20e),'AetOf':function(_0x34ac18,_0x5671a4){return _0x34ac18===_0x5671a4;},'bpVCx':_0x3e254e(0x209),'rAirk':function(_0x4e19dd,_0x2dae7b){return _0x4e19dd==_0x2dae7b;},'FlXjX':function(_0x4bb8f5,_0x253a68){return _0x4bb8f5==_0x253a68;},'BTTMO':'All\x20fields\x20are\x20required','LhsXK':_0x3e254e(0x1bd)};try{const {sensorId:_0x325673,subsiteId:_0x410194,interval_seconds:_0x2662da,batch_size:_0x1abdf6}=_0x36bd2e[_0x3e254e(0x185)];if(!_0x325673||!_0x410194||_0x31710c[_0x3e254e(0x1ff)](_0x2662da,null)||_0x31710c[_0x3e254e(0x1e4)](_0x1abdf6,null))return _0x175b94['status'](0x190)[_0x3e254e(0x179)]({'message':_0x31710c[_0x3e254e(0x1ce)]});const {companyId:_0x2079e9}=await getAdminDetailsFromToken(),_0x3d6560=_0x3e254e(0x1fd)+_0x2079e9+'_'+_0x410194;db[_0x3e254e(0x1e2)](_0x3e254e(0x1e6)+_0x3d6560+'\x0a\x20\x20\x20\x20\x20\x20\x20SET\x20interval_seconds\x20=\x20?,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20batch_size\x20=\x20?,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20updated_at\x20=\x20CURRENT_TIMESTAMP\x20\x0a\x20\x20\x20\x20\x20\x20\x20WHERE\x20bank_id\x20=\x20?\x20AND\x20is_active\x20=\x200',[_0x2662da,_0x1abdf6,_0x325673],function(_0x4d80f1){const _0x37c6a7=_0x3e254e;if(_0x4d80f1)return console[_0x37c6a7(0x1b5)](_0x37c6a7(0x1ea),_0x4d80f1[_0x37c6a7(0x199)]),_0x175b94['status'](0x1f4)[_0x37c6a7(0x179)]({'message':_0x31710c[_0x37c6a7(0x19c)],'error':_0x4d80f1[_0x37c6a7(0x199)]});if(_0x31710c['AetOf'](this[_0x37c6a7(0x1f0)],0x0))return _0x175b94[_0x37c6a7(0x1b9)](0x190)[_0x37c6a7(0x179)]({'message':_0x31710c[_0x37c6a7(0x17e)]});console[_0x37c6a7(0x186)]('✅\x20Sensor\x20'+_0x325673+_0x37c6a7(0x1c1)),_0x175b94['status'](0xc8)[_0x37c6a7(0x179)]({'message':_0x37c6a7(0x1d0)+_0x325673+_0x37c6a7(0x1d6)});});}catch(_0x503a62){console[_0x3e254e(0x1b5)](_0x3e254e(0x1d9),_0x503a62[_0x3e254e(0x199)]),_0x175b94[_0x3e254e(0x1b9)](0x1f4)[_0x3e254e(0x179)]({'message':_0x31710c[_0x3e254e(0x19a)],'error':_0x503a62[_0x3e254e(0x199)]});}};module[a0_0x5b8833(0x1e5)]={'activateSubSiteSensor':activateSubSiteSensor,'deactivateSubSiteSensor':deactivateSubSiteSensor,'removeSubSiteSensor':removeSubSiteSensor,'getAllActiveSubSiteSensors':getAllActiveSubSiteSensors,'reactivateSubSiteSensor':reactivateSubSiteSensor,'updateSubSiteSensorSettings':updateSubSiteSensorSettings};