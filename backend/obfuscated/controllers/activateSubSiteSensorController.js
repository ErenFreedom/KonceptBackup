const a0_0x48ede0=a0_0x8364;(function(_0x21726e,_0x1d6d56){const _0x37fcd7=a0_0x8364,_0x246c38=_0x21726e();while(!![]){try{const _0x4fa02b=-parseInt(_0x37fcd7(0x1d5))/0x1*(parseInt(_0x37fcd7(0x175))/0x2)+-parseInt(_0x37fcd7(0x1a2))/0x3+parseInt(_0x37fcd7(0x1ef))/0x4*(-parseInt(_0x37fcd7(0x15e))/0x5)+parseInt(_0x37fcd7(0x18a))/0x6+parseInt(_0x37fcd7(0x1f9))/0x7*(parseInt(_0x37fcd7(0x1ae))/0x8)+-parseInt(_0x37fcd7(0x1ee))/0x9+parseInt(_0x37fcd7(0x1be))/0xa*(parseInt(_0x37fcd7(0x1b4))/0xb);if(_0x4fa02b===_0x1d6d56)break;else _0x246c38['push'](_0x246c38['shift']());}catch(_0x3e973b){_0x246c38['push'](_0x246c38['shift']());}}}(a0_0x1ed7,0x25692));const axios=require(a0_0x48ede0(0x1d4)),jwt=require(a0_0x48ede0(0x186)),{db,createSensorDataTable}=require(a0_0x48ede0(0x1c8));require(a0_0x48ede0(0x16d))[a0_0x48ede0(0x1bf)]();const getStoredToken=()=>{const _0x3b1e04=a0_0x48ede0,_0x112ce8={'qouGg':function(_0x599077,_0x4ef195){return _0x599077||_0x4ef195;},'SPOTi':function(_0x44ef13,_0x5e16cf){return _0x44ef13(_0x5e16cf);},'CpbTR':_0x3b1e04(0x1c2),'EdJEW':_0x3b1e04(0x176)};return new Promise((_0x4c08b3,_0x390d69)=>{const _0x27cd72=_0x3b1e04;db[_0x27cd72(0x1db)](_0x112ce8[_0x27cd72(0x1d9)],[],(_0x3a1cb3,_0x21d097)=>{const _0x54e950=_0x27cd72;if(_0x112ce8[_0x54e950(0x1e9)](_0x3a1cb3,!_0x21d097))return _0x112ce8[_0x54e950(0x1c5)](_0x390d69,_0x112ce8[_0x54e950(0x195)]);_0x112ce8[_0x54e950(0x1c5)](_0x4c08b3,_0x21d097[_0x54e950(0x189)]);});});},getAdminDetailsFromToken=_0x565057=>{const _0xc0c478=a0_0x48ede0,_0x5f4a1c={'VzWET':'Bearer\x20','cwpkl':_0xc0c478(0x192)};try{const _0x37eabf=_0x565057[_0xc0c478(0x1ac)][_0xc0c478(0x1a7)];if(!_0x37eabf||!_0x37eabf[_0xc0c478(0x162)](_0x5f4a1c['VzWET']))return null;const _0x459d75=_0x37eabf[_0xc0c478(0x171)]('\x20')[0x1],_0xafea13=jwt[_0xc0c478(0x1ba)](_0x459d75,process['env']['JWT_SECRET_APP']),_0x4232bd=_0xafea13[_0xc0c478(0x19d)],_0x46d854=_0xafea13[_0xc0c478(0x1b5)],_0x5e2c69=_0xafea13[_0xc0c478(0x181)];if(!_0x4232bd)return null;return{'companyId':_0x4232bd,'adminId':_0x46d854,'subSites':_0x5e2c69};}catch(_0x58d4a7){return console['error'](_0x5f4a1c[_0xc0c478(0x1f5)],_0x58d4a7[_0xc0c478(0x169)]),null;}},activateSubSiteSensor=async(_0x5c134a,_0x1dbc54)=>{const _0x3435dc=a0_0x48ede0,_0x283b11={'MrAqS':'Sensor\x20activated\x20successfully','wTHwT':_0x3435dc(0x1b0),'Wftxf':_0x3435dc(0x1b9),'tuLhs':function(_0x438db7,_0xd72268){return _0x438db7||_0xd72268;},'SPmnf':'Sensor\x20ID\x20and\x20Subsite\x20ID\x20required','UIstW':function(_0x1bd550,_0xd8f760){return _0x1bd550(_0xd8f760);},'uXIBR':_0x3435dc(0x1ab),'pqZDx':function(_0x263658,_0x134cfc){return _0x263658??_0x134cfc;},'BzdIo':_0x3435dc(0x15d),'IhXMh':_0x3435dc(0x1c4)};try{const {sensorId:_0xc19ccb,subsiteId:_0x4c7262,interval_seconds:_0x1823e6,batch_size:_0x53aecb}=_0x5c134a[_0x3435dc(0x15c)];if(_0x283b11[_0x3435dc(0x17d)](!_0xc19ccb,!_0x4c7262))return _0x1dbc54[_0x3435dc(0x200)](0x190)['json']({'message':_0x283b11[_0x3435dc(0x1fe)]});const _0x4e47d7=_0x283b11[_0x3435dc(0x155)](getAdminDetailsFromToken,_0x5c134a);if(!_0x4e47d7)return _0x1dbc54[_0x3435dc(0x200)](0x191)[_0x3435dc(0x1a6)]({'message':_0x283b11[_0x3435dc(0x199)]});const {companyId:_0x2cb731}=_0x4e47d7,_0xf0173c=await getStoredToken(),_0x442505=_0x1823e6??0xa,_0x5100ec=_0x283b11[_0x3435dc(0x1b6)](_0x53aecb,0x5),_0x30eb0f=process[_0x3435dc(0x18e)][_0x3435dc(0x194)]+_0x3435dc(0x17b);await axios[_0x3435dc(0x184)](_0x30eb0f,{'sensorId':_0xc19ccb,'subsiteId':_0x4c7262,'companyId':_0x2cb731},{'headers':{'Authorization':'Bearer\x20'+_0xf0173c}});const _0xf0e1f1=_0x3435dc(0x1fa)+_0x2cb731+'_'+_0x4c7262,_0x2dcc37=_0x3435dc(0x1cc)+_0x2cb731+'_'+_0x4c7262+'_'+_0xc19ccb;db[_0x3435dc(0x18c)](_0x3435dc(0x19c)+_0xf0e1f1+_0x3435dc(0x1ff),[_0xc19ccb,_0xc19ccb,_0x442505,_0x5100ec],_0x27c889=>{const _0xb0a224=_0x3435dc;if(_0x27c889)return console[_0xb0a224(0x19b)](_0x283b11[_0xb0a224(0x19f)],_0x27c889['message']),_0x1dbc54[_0xb0a224(0x200)](0x1f4)[_0xb0a224(0x1a6)]({'message':_0x283b11[_0xb0a224(0x1b8)]});db[_0xb0a224(0x18c)]('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x2dcc37+_0xb0a224(0x1c3)+_0x2cb731+'_'+_0x4c7262+_0xb0a224(0x1e5),_0x271839=>{const _0x31155f=_0xb0a224;if(_0x271839)return console[_0x31155f(0x19b)](_0x31155f(0x1f7)+_0x2dcc37+':',_0x271839[_0x31155f(0x169)]),_0x1dbc54[_0x31155f(0x200)](0x1f4)[_0x31155f(0x1a6)]({'message':_0x31155f(0x193)});_0x1dbc54[_0x31155f(0x200)](0xc8)[_0x31155f(0x1a6)]({'message':_0x283b11[_0x31155f(0x1d3)]});});});}catch(_0x52e435){console[_0x3435dc(0x19b)](_0x283b11['BzdIo'],_0x52e435[_0x3435dc(0x169)]),_0x1dbc54[_0x3435dc(0x200)](0x1f4)[_0x3435dc(0x1a6)]({'message':_0x283b11[_0x3435dc(0x1cb)],'error':_0x52e435[_0x3435dc(0x169)]});}},deactivateSubSiteSensor=async(_0x5d8d1f,_0x4c79f2)=>{const _0x5840f7=a0_0x48ede0,_0x369016={'zpXkt':_0x5840f7(0x196),'wHSri':'⚠️\x20No\x20IntervalControl\x20entry\x20found.\x20Proceeding\x20with\x20caution.','NsKFk':function(_0x491955,_0x3eb452){return _0x491955===_0x3eb452;},'TSwMd':_0x5840f7(0x165),'LYFAD':_0x5840f7(0x164),'xXOFO':_0x5840f7(0x18b),'TAiPm':function(_0x56a484,_0xf2d630){return _0x56a484||_0xf2d630;},'GuSJq':function(_0x3c8f39,_0x107b9e){return _0x3c8f39(_0x107b9e);},'PcsVN':_0x5840f7(0x1f6)};try{const {sensorId:_0x4a9685,subsiteId:_0x28ef47}=_0x5d8d1f['body'];if(_0x369016['TAiPm'](!_0x4a9685,!_0x28ef47))return _0x4c79f2[_0x5840f7(0x200)](0x190)[_0x5840f7(0x1a6)]({'message':_0x5840f7(0x17e)});const _0x143b03=_0x369016['GuSJq'](getAdminDetailsFromToken,_0x5d8d1f);if(!_0x143b03)return _0x4c79f2[_0x5840f7(0x200)](0x191)['json']({'message':_0x369016['PcsVN']});const {companyId:_0x55aa18}=_0x143b03,_0x21b436=_0x5d8d1f[_0x5840f7(0x1ac)][_0x5840f7(0x1a7)],_0x40cff5=_0x5840f7(0x198)+_0x55aa18+'_'+_0x28ef47,_0x2c6270=_0x5840f7(0x1fa)+_0x55aa18+'_'+_0x28ef47;db[_0x5840f7(0x1db)]('SELECT\x20id\x20FROM\x20'+_0x2c6270+_0x5840f7(0x1f3),[_0x4a9685],(_0x50e843,_0x3d8ff8)=>{const _0x10c32b=_0x5840f7,_0x40c7d3={'wWEMN':_0x10c32b(0x172),'GSilu':_0x369016[_0x10c32b(0x16f)],'rckAe':_0x369016['wHSri'],'DBfKK':function(_0x48c8cf,_0x24a1a1){const _0x1099bf=_0x10c32b;return _0x369016[_0x1099bf(0x1ed)](_0x48c8cf,_0x24a1a1);},'LBpEK':function(_0x3e3d04,_0x28e67b){const _0x4f080f=_0x10c32b;return _0x369016[_0x4f080f(0x1ed)](_0x3e3d04,_0x28e67b);},'ObeBk':_0x10c32b(0x1bd),'nkNdN':_0x369016['TSwMd']};if(_0x50e843||!_0x3d8ff8)return console[_0x10c32b(0x19b)](_0x369016[_0x10c32b(0x166)],_0x50e843?.[_0x10c32b(0x169)]),_0x4c79f2[_0x10c32b(0x200)](0x194)[_0x10c32b(0x1a6)]({'message':_0x369016['xXOFO']});const _0x3575ed=_0x3d8ff8['id'];db[_0x10c32b(0x1db)](_0x10c32b(0x1e2)+_0x40cff5+_0x10c32b(0x1ec),[_0x3575ed],async(_0x2d4f11,_0x2a6db7)=>{const _0xf6e804=_0x10c32b,_0x35f4ed={'eCEgF':_0x40c7d3[_0xf6e804(0x1d2)],'AKYUV':_0xf6e804(0x1a1)};if(_0x2d4f11)return console[_0xf6e804(0x19b)](_0xf6e804(0x151),_0x2d4f11['message']),_0x4c79f2['status'](0x1f4)['json']({'message':_0x40c7d3[_0xf6e804(0x1d7)]});if(!_0x2a6db7)console['warn'](_0x40c7d3[_0xf6e804(0x187)]);else{if(_0x40c7d3[_0xf6e804(0x188)](_0x2a6db7['is_fetching'],0x1)||_0x40c7d3[_0xf6e804(0x188)](_0x2a6db7[_0xf6e804(0x1c6)],0x1))return _0x4c79f2[_0xf6e804(0x200)](0x193)[_0xf6e804(0x1a6)]({'message':_0xf6e804(0x1c9),'is_fetching':_0x40c7d3[_0xf6e804(0x1e8)](_0x2a6db7[_0xf6e804(0x1e7)],0x1),'is_sending':_0x2a6db7['is_sending']===0x1});}const _0x3c92f7=process[_0xf6e804(0x18e)]['CLOUD_API_URL']+_0xf6e804(0x1c1);try{await axios[_0xf6e804(0x184)](_0x3c92f7,{'sensorId':_0x4a9685,'subsiteId':_0x28ef47},{'headers':{'Authorization':_0x21b436}}),db[_0xf6e804(0x18c)](_0xf6e804(0x170)+_0x2c6270+_0xf6e804(0x18f),[_0x4a9685],_0x3d0a86=>{const _0x50fda6=_0xf6e804;if(_0x3d0a86)return console['error'](_0x35f4ed[_0x50fda6(0x1b2)],_0x3d0a86[_0x50fda6(0x169)]),_0x4c79f2[_0x50fda6(0x200)](0x1f4)[_0x50fda6(0x1a6)]({'message':_0x50fda6(0x158)});return console[_0x50fda6(0x154)](_0x50fda6(0x157)+_0x4a9685+'\x20deactivated\x20in\x20sub-site\x20'+_0x28ef47),_0x4c79f2[_0x50fda6(0x200)](0xc8)[_0x50fda6(0x1a6)]({'message':_0x35f4ed['AKYUV']});});}catch(_0x18d5cf){return console[_0xf6e804(0x19b)](_0x40c7d3[_0xf6e804(0x1cf)],_0x18d5cf[_0xf6e804(0x19e)]?.[_0xf6e804(0x163)]||_0x18d5cf[_0xf6e804(0x169)]),_0x4c79f2[_0xf6e804(0x200)](0x1f4)[_0xf6e804(0x1a6)]({'message':_0x40c7d3[_0xf6e804(0x1e4)],'error':_0x18d5cf['response']?.[_0xf6e804(0x163)]||_0x18d5cf[_0xf6e804(0x169)]});}});});}catch(_0x4edeec){console[_0x5840f7(0x19b)]('❌\x20Error\x20deactivating\x20subsite\x20sensor:',_0x4edeec[_0x5840f7(0x169)]),_0x4c79f2[_0x5840f7(0x200)](0x1f4)[_0x5840f7(0x1a6)]({'message':_0x5840f7(0x1fd),'error':_0x4edeec['message']});}},removeSubSiteSensor=async(_0x34fdf3,_0x5c29e7)=>{const _0x3c3a80=a0_0x48ede0,_0x31d984={'GnCpH':_0x3c3a80(0x1df),'PfRdP':'Sensor\x20ID\x20and\x20Subsite\x20ID\x20required','jouSq':function(_0x2e4ca6,_0x13aee){return _0x2e4ca6(_0x13aee);},'vvfaI':_0x3c3a80(0x1d1),'aUViO':_0x3c3a80(0x1ad)};try{const {sensorId:_0x256e5d,subsiteId:_0x3883d3}=_0x34fdf3[_0x3c3a80(0x15c)];if(!_0x256e5d||!_0x3883d3)return _0x5c29e7[_0x3c3a80(0x200)](0x190)[_0x3c3a80(0x1a6)]({'message':_0x31d984['PfRdP']});const _0x58580c=_0x31d984['jouSq'](getAdminDetailsFromToken,_0x34fdf3);if(!_0x58580c)return _0x5c29e7[_0x3c3a80(0x200)](0x191)['json']({'message':'Unauthorized:\x20Invalid\x20token'});const {companyId:_0x2ceab4}=_0x58580c,_0x5ccfd0=_0x34fdf3['headers'][_0x3c3a80(0x1a7)],_0x39a86f=process[_0x3c3a80(0x18e)]['CLOUD_API_URL']+_0x3c3a80(0x1a3);await axios[_0x3c3a80(0x184)](_0x39a86f,{'sensorId':_0x256e5d,'subsiteId':_0x3883d3},{'headers':{'Authorization':_0x5ccfd0}});const _0x31a663=_0x3c3a80(0x1fa)+_0x2ceab4+'_'+_0x3883d3,_0x2fcec6=_0x3c3a80(0x1cc)+_0x2ceab4+'_'+_0x3883d3+'_'+_0x256e5d;db[_0x3c3a80(0x18c)](_0x3c3a80(0x183)+_0x31a663+'\x20WHERE\x20bank_id\x20=\x20?',[_0x256e5d],_0x53eac7=>{const _0x4c2215=_0x3c3a80,_0x195d9e={'qEuIo':_0x4c2215(0x1eb)};if(_0x53eac7)return console[_0x4c2215(0x19b)](_0x4c2215(0x1da)+_0x31a663+':',_0x53eac7[_0x4c2215(0x169)]),_0x5c29e7[_0x4c2215(0x200)](0x1f4)[_0x4c2215(0x1a6)]({'message':_0x31d984[_0x4c2215(0x1cd)]});db[_0x4c2215(0x18c)](_0x4c2215(0x174)+_0x2fcec6,_0x112f6f=>{const _0xe7a362=_0x4c2215;if(_0x112f6f)return console[_0xe7a362(0x19b)](_0xe7a362(0x168)+_0x2fcec6+':',_0x112f6f[_0xe7a362(0x169)]),_0x5c29e7['status'](0x1f4)[_0xe7a362(0x1a6)]({'message':_0x195d9e[_0xe7a362(0x17a)]});return console[_0xe7a362(0x154)](_0xe7a362(0x157)+_0x256e5d+_0xe7a362(0x16a)),_0x5c29e7['status'](0xc8)[_0xe7a362(0x1a6)]({'message':_0xe7a362(0x1a8)});});});}catch(_0x29e9ff){console[_0x3c3a80(0x19b)](_0x31d984[_0x3c3a80(0x1c0)],_0x29e9ff['message']),_0x5c29e7['status'](0x1f4)['json']({'message':_0x31d984[_0x3c3a80(0x1a9)],'error':_0x29e9ff[_0x3c3a80(0x169)]});}},getAllActiveSubSiteSensors=async(_0x1a380a,_0x23139c)=>{const _0x5d7bd7=a0_0x48ede0,_0x2c49e4={'McQqM':_0x5d7bd7(0x173),'unwbX':function(_0x5015d4,_0x4c7288){return _0x5015d4(_0x4c7288);},'syWbk':_0x5d7bd7(0x18d),'cHPtO':function(_0x3ed701,_0x2770b4){return _0x3ed701(_0x2770b4);},'CLuXz':_0x5d7bd7(0x1f6),'GKGSu':_0x5d7bd7(0x1c7),'tWRTv':'❌\x20Error\x20in\x20getAllActiveSubSiteSensors:','GiBsI':'Internal\x20Server\x20Error'};try{const _0x1adfa6=_0x1a380a['query'][_0x5d7bd7(0x1a0)]||_0x1a380a['query'][_0x5d7bd7(0x1e0)]||_0x1a380a[_0x5d7bd7(0x1ca)][_0x5d7bd7(0x178)];if(!_0x1adfa6)return _0x23139c[_0x5d7bd7(0x200)](0x190)[_0x5d7bd7(0x1a6)]({'message':_0x5d7bd7(0x1ea)});const _0x1cfcf6=_0x2c49e4[_0x5d7bd7(0x19a)](getAdminDetailsFromToken,_0x1a380a);if(!_0x1cfcf6)return _0x23139c['status'](0x191)['json']({'message':_0x2c49e4[_0x5d7bd7(0x167)]});const {companyId:_0x1bf8f3}=_0x1cfcf6,_0x5c685f=_0x1a380a[_0x5d7bd7(0x1ac)]['authorization'],_0x302537=process[_0x5d7bd7(0x18e)][_0x5d7bd7(0x194)]+_0x5d7bd7(0x1e6)+_0x1adfa6,_0x3c4d61=await axios[_0x5d7bd7(0x1db)](_0x302537,{'headers':{'Authorization':_0x5c685f}}),_0x1577e1=_0x3c4d61[_0x5d7bd7(0x163)]?.['sensors']||[],_0x31a86c='Sensor_'+_0x1bf8f3+'_'+_0x1adfa6,_0x3c9a77=_0x5d7bd7(0x1bc)+_0x1bf8f3+'_'+_0x1adfa6,_0x57cf94=await new Promise((_0x2abc60,_0x572bf5)=>{const _0x32223a=_0x5d7bd7;db[_0x32223a(0x1dc)](_0x32223a(0x179)+_0x31a86c+_0x32223a(0x191)+_0x3c9a77+'\x20a\x20ON\x20s.bank_id\x20=\x20a.sensor_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20s.is_active\x20=\x201',[],(_0x1ad82a,_0x464025)=>{const _0x2c6583=_0x32223a;if(_0x1ad82a)return console[_0x2c6583(0x19b)](_0x2c49e4[_0x2c6583(0x1d6)],_0x1ad82a[_0x2c6583(0x169)]),_0x2c49e4['unwbX'](_0x572bf5,_0x2c49e4[_0x2c6583(0x15b)]);_0x2c49e4[_0x2c6583(0x1f0)](_0x2abc60,_0x464025);});}),_0x27e7d9=_0x1577e1['map'](_0x3bbbb4=>{const _0x435918=_0x5d7bd7,_0x5a2cc3=_0x57cf94[_0x435918(0x1f4)](_0x549c5d=>Number(_0x549c5d[_0x435918(0x152)])===Number(_0x3bbbb4[_0x435918(0x152)]));return{..._0x3bbbb4,'interval_seconds':_0x5a2cc3?.[_0x435918(0x197)]||0xa,'batch_size':_0x5a2cc3?.[_0x435918(0x15f)]||0x1,'api_endpoint':_0x5a2cc3?.[_0x435918(0x16e)]||_0x435918(0x1ce)};});_0x23139c['status'](0xc8)[_0x5d7bd7(0x1a6)]({'message':_0x2c49e4[_0x5d7bd7(0x1b7)],'sensors':_0x27e7d9});}catch(_0x3d3064){console[_0x5d7bd7(0x19b)](_0x2c49e4['tWRTv'],_0x3d3064),_0x23139c[_0x5d7bd7(0x200)](0x1f4)[_0x5d7bd7(0x1a6)]({'message':_0x2c49e4[_0x5d7bd7(0x1bb)],'error':_0x3d3064[_0x5d7bd7(0x169)]});}},reactivateSubSiteSensor=async(_0x598cc9,_0x5f0848)=>{const _0x34b6ed=a0_0x48ede0,_0x23beaf={'VONew':_0x34b6ed(0x15a),'qFlMz':_0x34b6ed(0x1b3),'KkRQN':function(_0x517ebf,_0x213a76){return _0x517ebf(_0x213a76);},'lpgMV':'Unauthorized','pmxIY':_0x34b6ed(0x17f),'gwiwL':'❌\x20Failed\x20to\x20reactivate\x20sub-site\x20sensor:','eyzqp':_0x34b6ed(0x16b)};try{const {sensorId:_0xc26906,subsiteId:_0x44ad82}=_0x598cc9[_0x34b6ed(0x15c)];if(!_0xc26906||!_0x44ad82)return _0x5f0848[_0x34b6ed(0x200)](0x190)[_0x34b6ed(0x1a6)]({'message':_0x23beaf[_0x34b6ed(0x1f1)]});const _0x4ab5cb=_0x23beaf[_0x34b6ed(0x153)](getAdminDetailsFromToken,_0x598cc9);if(!_0x4ab5cb)return _0x5f0848[_0x34b6ed(0x200)](0x191)[_0x34b6ed(0x1a6)]({'message':_0x23beaf[_0x34b6ed(0x1f2)]});const {companyId:_0x551a68}=_0x4ab5cb,_0x401bf3=_0x598cc9[_0x34b6ed(0x1ac)]['authorization'],_0x3a412c=process[_0x34b6ed(0x18e)][_0x34b6ed(0x194)]+_0x34b6ed(0x1aa),_0x2ec4a1=await axios['post'](_0x3a412c,{'sensorId':_0xc26906,'subsiteId':_0x44ad82},{'headers':{'Authorization':_0x401bf3}});console[_0x34b6ed(0x154)](_0x23beaf['pmxIY'],_0x2ec4a1['data']);const _0xb6bf80=_0x34b6ed(0x1fa)+_0x551a68+'_'+_0x44ad82;db[_0x34b6ed(0x18c)](_0x34b6ed(0x170)+_0xb6bf80+_0x34b6ed(0x1de),[_0xc26906],_0x455954=>{const _0x1ee508=_0x34b6ed;_0x455954?console[_0x1ee508(0x19b)](_0x23beaf[_0x1ee508(0x1e1)],_0x455954[_0x1ee508(0x169)]):console[_0x1ee508(0x154)](_0x1ee508(0x185)+_0xc26906+_0x1ee508(0x160));}),_0x5f0848[_0x34b6ed(0x200)](0xc8)[_0x34b6ed(0x1a6)]({'message':_0x34b6ed(0x182),'cloudResponse':_0x2ec4a1['data']});}catch(_0x37e88a){console[_0x34b6ed(0x19b)](_0x23beaf[_0x34b6ed(0x156)],_0x37e88a['response']?.[_0x34b6ed(0x163)]||_0x37e88a[_0x34b6ed(0x169)]),_0x5f0848['status'](0x1f4)[_0x34b6ed(0x1a6)]({'message':_0x23beaf[_0x34b6ed(0x1dd)],'error':_0x37e88a['message']});}},updateSubSiteSensorSettings=async(_0x439437,_0x10fced)=>{const _0xeceea1=a0_0x48ede0,_0x248d81={'LWhra':_0xeceea1(0x1d8),'xjvKh':function(_0x51d42c,_0x2a7d41){return _0x51d42c===_0x2a7d41;},'hgdwG':_0xeceea1(0x177),'acDSl':function(_0x50f381,_0x4a6186){return _0x50f381||_0x4a6186;},'IQcJL':function(_0x3931f0,_0x38c6f1){return _0x3931f0==_0x38c6f1;},'Chddf':'All\x20fields\x20are\x20required','MWGJP':'Unauthorized:\x20Invalid\x20token','UhyoM':_0xeceea1(0x1a4),'bBqTS':_0xeceea1(0x159)};try{const {sensorId:_0x2ac5ff,subsiteId:_0x339eae,interval_seconds:_0x15ab26,batch_size:_0x20ad4a}=_0x439437[_0xeceea1(0x15c)];if(_0x248d81[_0xeceea1(0x150)](!_0x2ac5ff,!_0x339eae)||_0x15ab26==null||_0x248d81[_0xeceea1(0x180)](_0x20ad4a,null))return _0x10fced[_0xeceea1(0x200)](0x190)[_0xeceea1(0x1a6)]({'message':_0x248d81[_0xeceea1(0x1af)]});const _0x40204a=getAdminDetailsFromToken(_0x439437);if(!_0x40204a)return _0x10fced[_0xeceea1(0x200)](0x191)[_0xeceea1(0x1a6)]({'message':_0x248d81[_0xeceea1(0x190)]});const {companyId:_0x130c4f}=_0x40204a,_0x3563e8=_0xeceea1(0x1fa)+_0x130c4f+'_'+_0x339eae;db[_0xeceea1(0x18c)](_0xeceea1(0x170)+_0x3563e8+_0xeceea1(0x1e3),[_0x15ab26,_0x20ad4a,_0x2ac5ff],function(_0xdedbef){const _0x5b8df7=_0xeceea1;if(_0xdedbef)return console['error'](_0x248d81[_0x5b8df7(0x1fc)],_0xdedbef[_0x5b8df7(0x169)]),_0x10fced[_0x5b8df7(0x200)](0x1f4)[_0x5b8df7(0x1a6)]({'message':_0x5b8df7(0x1d0),'error':_0xdedbef[_0x5b8df7(0x169)]});if(_0x248d81[_0x5b8df7(0x1a5)](this[_0x5b8df7(0x1b1)],0x0))return _0x10fced[_0x5b8df7(0x200)](0x190)['json']({'message':_0x248d81[_0x5b8df7(0x17c)]});console[_0x5b8df7(0x154)](_0x5b8df7(0x157)+_0x2ac5ff+_0x5b8df7(0x161)),_0x10fced[_0x5b8df7(0x200)](0xc8)[_0x5b8df7(0x1a6)]({'message':_0x5b8df7(0x1f8)+_0x2ac5ff+_0x5b8df7(0x16c)});});}catch(_0x5b3e73){console[_0xeceea1(0x19b)](_0x248d81[_0xeceea1(0x1fb)],_0x5b3e73[_0xeceea1(0x169)]),_0x10fced['status'](0x1f4)[_0xeceea1(0x1a6)]({'message':_0x248d81['bBqTS'],'error':_0x5b3e73['message']});}};function a0_0x8364(_0x2d6ce0,_0x758dda){const _0x1ed796=a0_0x1ed7();return a0_0x8364=function(_0x83648f,_0x3ace02){_0x83648f=_0x83648f-0x150;let _0x13b22c=_0x1ed796[_0x83648f];return _0x13b22c;},a0_0x8364(_0x2d6ce0,_0x758dda);}function a0_0x1ed7(){const _0x579eb2=['Activation\x20failed','SPOTi','is_sending','Fetched\x20sub-site\x20active\x20sensors\x20with\x20local\x20settings\x20and\x20API\x20endpoint','../db/sensorDB','❌\x20Sensor\x20is\x20actively\x20fetching\x20or\x20sending.\x20Please\x20stop\x20it\x20first\x20before\x20deactivating.','query','IhXMh','SensorData_','GnCpH','N/A','ObeBk','Update\x20failed','❌\x20Error\x20removing\x20subsite\x20sensor:','wWEMN','MrAqS','axios','3sLMzpR','McQqM','GSilu','❌\x20Error\x20updating\x20sensor\x20settings:','EdJEW','❌\x20Failed\x20to\x20delete\x20from\x20','get','all','eyzqp','\x20SET\x20is_active\x20=\x201\x20WHERE\x20bank_id\x20=\x20?','Deletion\x20failed','subsite_id','VONew','SELECT\x20is_fetching,\x20is_sending\x20FROM\x20','\x0a\x20\x20\x20\x20\x20\x20\x20SET\x20interval_seconds\x20=\x20?,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20batch_size\x20=\x20?,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20updated_at\x20=\x20CURRENT_TIMESTAMP\x20\x0a\x20\x20\x20\x20\x20\x20\x20WHERE\x20bank_id\x20=\x20?\x20AND\x20is_active\x20=\x200','nkNdN','(id)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','/api/subsite/sensor/activation/active?subsite_id=','is_fetching','LBpEK','qouGg','Sub-site\x20ID\x20is\x20required','Drop\x20table\x20failed','\x20WHERE\x20sensor_id\x20=\x20?','NsKFk','110844myplbv','124figCYF','unwbX','qFlMz','lpgMV','\x20WHERE\x20bank_id\x20=\x20?','find','cwpkl','Unauthorized:\x20Invalid\x20token','❌\x20Failed\x20to\x20create\x20SensorData\x20table\x20','Sensor\x20','7yUfDVf','Sensor_','UhyoM','LWhra','Deactivation\x20failed','SPmnf','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20(id,\x20bank_id,\x20mode,\x20interval_seconds,\x20batch_size,\x20is_active,\x20created_at,\x20updated_at)\x0a\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20\x27manual\x27,\x20?,\x20?,\x201,\x20datetime(\x27now\x27),\x20datetime(\x27now\x27))\x0a\x20\x20\x20\x20\x20\x20\x20ON\x20CONFLICT(id)\x20DO\x20UPDATE\x20SET\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20is_active\x20=\x201,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20interval_seconds\x20=\x20excluded.interval_seconds,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20batch_size\x20=\x20excluded.batch_size','status','acDSl','❌\x20IntervalControl\x20check\x20failed:','bank_id','KkRQN','log','UIstW','gwiwL','✅\x20Sensor\x20','Local\x20deactivation\x20failed','Internal\x20Server\x20Error','❌\x20Error\x20updating\x20local\x20sub-site\x20DB:','syWbk','body','❌\x20Error\x20activating\x20sub-site\x20sensor:','30155cYgfJJ','batch_size','\x20reactivated\x20locally.','\x20settings\x20updated','startsWith','data','❌\x20Sensor\x20lookup\x20failed:','Failed\x20to\x20deactivate\x20sensor\x20in\x20Cloud','LYFAD','CLuXz','❌\x20Failed\x20to\x20drop\x20table\x20','message','\x20removed\x20and\x20table\x20dropped.','Failed\x20to\x20reactivate\x20sensor','\x20settings\x20updated\x20successfully','dotenv','api_endpoint','zpXkt','UPDATE\x20','split','❌\x20DB\x20update\x20failed:','❌\x20Local\x20DB\x20error:','DROP\x20TABLE\x20IF\x20EXISTS\x20','56570qHyDFA','SELECT\x20token\x20FROM\x20AuthTokens\x20ORDER\x20BY\x20id\x20DESC\x20LIMIT\x201','Sensor\x20must\x20be\x20deactivated\x20to\x20update\x20settings','subSiteId','SELECT\x20s.bank_id,\x20s.interval_seconds,\x20s.batch_size,\x20a.api_endpoint\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20','qEuIo','/api/subsite/sensor/activation/activate','hgdwG','tuLhs','Sensor\x20ID\x20and\x20Subsite\x20ID\x20required','✅\x20Sub-site\x20sensor\x20reactivated\x20in\x20Cloud:','IQcJL','subSites','Sensor\x20reactivated\x20successfully','DELETE\x20FROM\x20','post','✅\x20Sub-site\x20Sensor\x20','jsonwebtoken','rckAe','DBfKK','token','1269462YAgxBc','Sensor\x20not\x20found\x20in\x20local\x20DB','run','Failed\x20to\x20fetch\x20local\x20sub-site\x20sensors','env','\x20SET\x20is_active\x20=\x200\x20WHERE\x20bank_id\x20=\x20?','MWGJP','\x20s\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20','❌\x20Token\x20decoding\x20failed:','Table\x20creation\x20failed','CLOUD_API_URL','CpbTR','Database\x20error\x20while\x20checking\x20IntervalControl','interval_seconds','IntervalControl_','uXIBR','cHPtO','error','INSERT\x20INTO\x20','companyId','response','wTHwT','subsiteId','Sensor\x20deactivated\x20successfully','13056Zjjoma','/api/subsite/sensor/activation/remove','❌\x20Error\x20updating\x20sub-site\x20sensor\x20settings:','xjvKh','json','authorization','Sensor\x20removed\x20and\x20table\x20dropped','aUViO','/api/subsite/sensor/activation/reactivate','Unauthorized','headers','Removal\x20failed','1375816bMWklo','Chddf','❌\x20DB\x20Insert\x20failed:','changes','eCEgF','Sensor\x20ID\x20and\x20sub-site\x20ID\x20are\x20required','159951GMqYug','adminId','pqZDx','GKGSu','Wftxf','Local\x20DB\x20insert\x20failed','verify','GiBsI','SensorAPI_','❌\x20Cloud\x20deactivation\x20failed:','40mwNJeb','config','vvfaI','/api/subsite/sensor/activation/deactivate','No\x20token\x20found','\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20sensor_id\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20value\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20quality\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20quality_good\x20BOOLEAN,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20timestamp\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY(sensor_id)\x20REFERENCES\x20SensorBank_'];a0_0x1ed7=function(){return _0x579eb2;};return a0_0x1ed7();}module['exports']={'activateSubSiteSensor':activateSubSiteSensor,'deactivateSubSiteSensor':deactivateSubSiteSensor,'removeSubSiteSensor':removeSubSiteSensor,'getAllActiveSubSiteSensors':getAllActiveSubSiteSensors,'reactivateSubSiteSensor':reactivateSubSiteSensor,'updateSubSiteSensorSettings':updateSubSiteSensorSettings};