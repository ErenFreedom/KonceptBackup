const a0_0x3d3f48=a0_0x56b7;(function(_0x5ab540,_0xba28de){const _0x53cdcf=a0_0x56b7,_0xf98cbd=_0x5ab540();while(!![]){try{const _0x37c67e=-parseInt(_0x53cdcf(0x1e1))/0x1*(-parseInt(_0x53cdcf(0x1ee))/0x2)+-parseInt(_0x53cdcf(0x203))/0x3*(-parseInt(_0x53cdcf(0x201))/0x4)+-parseInt(_0x53cdcf(0x1d4))/0x5+-parseInt(_0x53cdcf(0x1de))/0x6+parseInt(_0x53cdcf(0x1e7))/0x7*(parseInt(_0x53cdcf(0x1dc))/0x8)+parseInt(_0x53cdcf(0x204))/0x9+-parseInt(_0x53cdcf(0x1df))/0xa*(parseInt(_0x53cdcf(0x1ff))/0xb);if(_0x37c67e===_0xba28de)break;else _0xf98cbd['push'](_0xf98cbd['shift']());}catch(_0x43a39c){_0xf98cbd['push'](_0xf98cbd['shift']());}}}(a0_0x1f1b,0x798bd));function a0_0x56b7(_0xd08f81,_0x45452a){const _0x1f1b4c=a0_0x1f1b();return a0_0x56b7=function(_0x56b7cb,_0x2d76c5){_0x56b7cb=_0x56b7cb-0x1ce;let _0x511060=_0x1f1b4c[_0x56b7cb];return _0x511060;},a0_0x56b7(_0xd08f81,_0x45452a);}const {db}=require(a0_0x3d3f48(0x1d3)),jwt=require(a0_0x3d3f48(0x1d0));require('dotenv')['config']();function a0_0x1f1b(){const _0x48c511=['2317810elFzyk','❌\x20DB\x20error\x20in\x20sub-site\x20job\x20status\x20fetch:','.is_fetching,\x0a\x20\x20\x20\x20\x20\x20','nNHhh','status','exports','message','LQRKo','35320KUrCDj','.is_sending\x0a\x20\x20\x20\x20FROM\x20','1019394FQLjOY','7603950yyqZNZ','Sensor_','19QoNCBH','kDbqN','split','\x0a\x20\x20\x20\x20SELECT\x20','Sensor\x20not\x20found\x20in\x20IntervalControl','Missing\x20bank_id\x20or\x20subsite_id\x20or\x20token','504oPIuFl','forEach','bank_id','EBCEr','DB\x20error','.id\x0a\x20\x20\x20\x20WHERE\x20','verify','30160eiXNum','all','companyId','.is_fetching,\x20','Missing\x20subsite_id\x20or\x20token','.sensor_id\x20=\x20','is_fetching','IntervalControl_','subsite_id','json','env','NghMr','.bank_id\x20=\x20?\x0a\x20\x20','fCjqr','\x0a\x20\x20\x20\x20JOIN\x20','❌\x20JWT\x20decode\x20error:','query','11GQrwIs','JWT_SECRET_APP','1461412aYePge','\x20ON\x20','3uzuPSm','8297604VITmxl','headers','\x0a\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20','jsonwebtoken','.bank_id\x20AS\x20bank_id,\x0a\x20\x20\x20\x20\x20\x20','error','../db/sensorDB'];a0_0x1f1b=function(){return _0x48c511;};return a0_0x1f1b();}const getCompanyIdFromToken=_0x3cb501=>{const _0x5f2146=a0_0x3d3f48,_0x1b018f={'EBCEr':_0x5f2146(0x1fd)};try{const _0x56cd97=_0x3cb501[_0x5f2146(0x1ce)]['authorization']?.[_0x5f2146(0x1e3)]('\x20')[0x1];if(!_0x56cd97)return null;const _0x1d61a9=jwt[_0x5f2146(0x1ed)](_0x56cd97,process[_0x5f2146(0x1f8)][_0x5f2146(0x200)]);return _0x1d61a9[_0x5f2146(0x1f0)];}catch(_0x51f6a5){return console[_0x5f2146(0x1d2)](_0x1b018f[_0x5f2146(0x1ea)],_0x51f6a5[_0x5f2146(0x1da)]),null;}},getSubsiteSensorJobStatus=(_0xdeff88,_0x173810)=>{const _0x1defc9=a0_0x3d3f48,_0x7f3f76={'kDbqN':_0x1defc9(0x1e5),'NghMr':function(_0xa32f85,_0x30795d){return _0xa32f85(_0x30795d);},'fCjqr':function(_0x3ffdd1,_0x2f9004){return _0x3ffdd1||_0x2f9004;},'NWpcL':_0x1defc9(0x1e6)},_0x4a8855=_0xdeff88[_0x1defc9(0x1fe)][_0x1defc9(0x1e9)],_0x2e9f8f=_0xdeff88[_0x1defc9(0x1fe)][_0x1defc9(0x1f6)],_0xc77f1e=_0x7f3f76[_0x1defc9(0x1f9)](getCompanyIdFromToken,_0xdeff88);if(_0x7f3f76[_0x1defc9(0x1fb)](!_0x4a8855,!_0x2e9f8f)||!_0xc77f1e)return _0x173810[_0x1defc9(0x1d8)](0x190)[_0x1defc9(0x1f7)]({'message':_0x7f3f76['NWpcL']});const _0x1226e0='Sensor_'+_0xc77f1e+'_'+_0x2e9f8f,_0x22344e=_0x1defc9(0x1f5)+_0xc77f1e+'_'+_0x2e9f8f,_0x393011=_0x1defc9(0x1e4)+_0x22344e+_0x1defc9(0x1f1)+_0x22344e+_0x1defc9(0x1dd)+_0x22344e+_0x1defc9(0x1fc)+_0x1226e0+_0x1defc9(0x202)+_0x22344e+_0x1defc9(0x1f3)+_0x1226e0+_0x1defc9(0x1ec)+_0x1226e0+_0x1defc9(0x1fa);db['get'](_0x393011,[_0x4a8855],(_0x47544b,_0xfe110e)=>{const _0x11efb9=_0x1defc9;if(_0x47544b)return console[_0x11efb9(0x1d2)](_0x11efb9(0x1d5),_0x47544b[_0x11efb9(0x1da)]),_0x173810[_0x11efb9(0x1d8)](0x1f4)['json']({'message':_0x11efb9(0x1eb)});if(!_0xfe110e)return _0x173810[_0x11efb9(0x1d8)](0x194)[_0x11efb9(0x1f7)]({'message':_0x7f3f76[_0x11efb9(0x1e2)]});return _0x173810[_0x11efb9(0x1d8)](0xc8)[_0x11efb9(0x1f7)]({'is_fetching':!!_0xfe110e['is_fetching'],'is_sending':!!_0xfe110e['is_sending']});});},getAllSubsiteSensorJobStatuses=(_0x3563ce,_0x1ddeb0)=>{const _0x3a3a45=a0_0x3d3f48,_0x21f642={'LQRKo':_0x3a3a45(0x1eb),'nNHhh':function(_0x2a60f7,_0x20074b){return _0x2a60f7(_0x20074b);},'cZXLi':_0x3a3a45(0x1f2)},_0x473fcf=_0x3563ce[_0x3a3a45(0x1fe)][_0x3a3a45(0x1f6)],_0x55cb65=_0x21f642[_0x3a3a45(0x1d7)](getCompanyIdFromToken,_0x3563ce);if(!_0x473fcf||!_0x55cb65)return _0x1ddeb0[_0x3a3a45(0x1d8)](0x190)[_0x3a3a45(0x1f7)]({'message':_0x21f642['cZXLi']});const _0x48d78d=_0x3a3a45(0x1e0)+_0x55cb65+'_'+_0x473fcf,_0xeaac6=_0x3a3a45(0x1f5)+_0x55cb65+'_'+_0x473fcf,_0x1adcbc=_0x3a3a45(0x1cf)+_0xeaac6+'.sensor_id\x20AS\x20local_id,\x0a\x20\x20\x20\x20\x20\x20'+_0x48d78d+_0x3a3a45(0x1d1)+_0xeaac6+_0x3a3a45(0x1d6)+_0xeaac6+'.is_sending\x0a\x20\x20\x20\x20FROM\x20'+_0xeaac6+'\x0a\x20\x20\x20\x20JOIN\x20'+_0x48d78d+_0x3a3a45(0x202)+_0xeaac6+_0x3a3a45(0x1f3)+_0x48d78d+'.id\x0a\x20\x20';db[_0x3a3a45(0x1ef)](_0x1adcbc,[],(_0x2dddec,_0x509edf)=>{const _0x4ec5f2=_0x3a3a45;if(_0x2dddec)return console[_0x4ec5f2(0x1d2)]('❌\x20DB\x20error\x20in\x20sub-site\x20job\x20status\x20fetch\x20all:',_0x2dddec[_0x4ec5f2(0x1da)]),_0x1ddeb0[_0x4ec5f2(0x1d8)](0x1f4)[_0x4ec5f2(0x1f7)]({'message':_0x21f642[_0x4ec5f2(0x1db)]});const _0x2f54ee={};return _0x509edf[_0x4ec5f2(0x1e8)](_0x200bed=>{const _0x5c7dcf=_0x4ec5f2;_0x2f54ee[_0x200bed['bank_id']]={'is_fetching':!!_0x200bed[_0x5c7dcf(0x1f4)],'is_sending':!!_0x200bed['is_sending']};}),_0x1ddeb0[_0x4ec5f2(0x1d8)](0xc8)[_0x4ec5f2(0x1f7)](_0x2f54ee);});};module[a0_0x3d3f48(0x1d9)]={'getSubsiteSensorJobStatus':getSubsiteSensorJobStatus,'getAllSubsiteSensorJobStatuses':getAllSubsiteSensorJobStatuses};