const a0_0x43d973=a0_0x5dda;function a0_0x5dda(_0x4e5f21,_0x545595){const _0x36f802=a0_0x36f8();return a0_0x5dda=function(_0x5ddabf,_0x51a480){_0x5ddabf=_0x5ddabf-0xa3;let _0x5ec358=_0x36f802[_0x5ddabf];return _0x5ec358;},a0_0x5dda(_0x4e5f21,_0x545595);}function a0_0x36f8(){const _0x11e83c=['status','forEach','rWpNO','IntervalControl_','26BQDtlW','173712dITkKm','LdMJx','verify','❌\x20Missing\x20or\x20malformed\x20Authorization\x20header','435225mHNnlv','env','8292FzGzeF','error','❌\x20companyId\x20missing\x20in\x20JWT\x20payload:','startsWith','auVEt','72tISefG','jsonwebtoken','config','split','KsBOs','9520WItRfp','685380qJCUcc','companyId','euwGX','../db/sensorDB','6522fqFvAd','UlDHt','json','52EXLlaz','authorization','message','SELECT\x20*\x20FROM\x20','is_fetching','wWgme','38488VSgjIH','❌\x20DB\x20error\x20fetching\x20interval\x20statuses\x20from\x20','companyId\x20and\x20subsite_id\x20are\x20required.','dotenv'];a0_0x36f8=function(){return _0x11e83c;};return a0_0x36f8();}(function(_0x295243,_0x3ee880){const _0x5462cd=a0_0x5dda,_0x115348=_0x295243();while(!![]){try{const _0x476930=-parseInt(_0x5462cd(0xbc))/0x1*(-parseInt(_0x5462cd(0xa6))/0x2)+-parseInt(_0x5462cd(0xad))/0x3*(-parseInt(_0x5462cd(0xbf))/0x4)+-parseInt(_0x5462cd(0xab))/0x5+-parseInt(_0x5462cd(0xa7))/0x6+-parseInt(_0x5462cd(0xb7))/0x7+parseInt(_0x5462cd(0xc5))/0x8*(parseInt(_0x5462cd(0xb2))/0x9)+parseInt(_0x5462cd(0xb8))/0xa;if(_0x476930===_0x3ee880)break;else _0x115348['push'](_0x115348['shift']());}catch(_0x3da386){_0x115348['push'](_0x115348['shift']());}}}(a0_0x36f8,0x1af33));const {db}=require(a0_0x43d973(0xbb)),jwt=require(a0_0x43d973(0xb3));require(a0_0x43d973(0xc8))[a0_0x43d973(0xb4)]();const getCompanyIdFromToken=_0x379c6b=>{const _0x1834b2=a0_0x43d973,_0x1d0fe7={'wWgme':'Bearer\x20','KsBOs':_0x1834b2(0xaa),'UlDHt':_0x1834b2(0xaf)};try{const _0x416414=_0x379c6b['headers'][_0x1834b2(0xc0)];if(!_0x416414||!_0x416414[_0x1834b2(0xb0)](_0x1d0fe7[_0x1834b2(0xc4)]))return console[_0x1834b2(0xae)](_0x1d0fe7[_0x1834b2(0xb6)]),null;const _0x5bb8f6=_0x416414[_0x1834b2(0xb5)]('\x20')[0x1],_0x4b6c96=jwt[_0x1834b2(0xa9)](_0x5bb8f6,process[_0x1834b2(0xac)]['JWT_SECRET_APP']);if(!_0x4b6c96[_0x1834b2(0xb9)])return console['error'](_0x1d0fe7[_0x1834b2(0xbd)],_0x4b6c96),null;return _0x4b6c96['companyId'];}catch(_0x28e275){return console[_0x1834b2(0xae)]('❌\x20Invalid\x20JWT\x20token:',_0x28e275[_0x1834b2(0xc1)]),null;}},getSubsiteIntervalStatus=(_0x49b6ab,_0xd62c14)=>{const _0x5b456a=a0_0x43d973,_0x201227={'jIUhj':function(_0x5e89eb,_0x1c269f){return _0x5e89eb===_0x1c269f;},'LdMJx':'Failed\x20to\x20fetch\x20interval\x20statuses\x20for\x20sub-site.','rWpNO':function(_0x1b6777,_0x37d5e1){return _0x1b6777(_0x37d5e1);},'euwGX':function(_0x548afb,_0x3faa8e){return _0x548afb||_0x3faa8e;},'auVEt':_0x5b456a(0xc7)},{subsite_id:_0x345b51}=_0x49b6ab['query'],_0x1247ac=_0x201227[_0x5b456a(0xa4)](getCompanyIdFromToken,_0x49b6ab);if(_0x201227[_0x5b456a(0xba)](!_0x1247ac,!_0x345b51))return _0xd62c14['status'](0x190)[_0x5b456a(0xbe)]({'message':_0x201227[_0x5b456a(0xb1)]});const _0x2379b3=_0x5b456a(0xa5)+_0x1247ac+'_'+_0x345b51;db['all'](_0x5b456a(0xc2)+_0x2379b3,[],(_0x39f51f,_0x52e6b7)=>{const _0x2fd243=_0x5b456a,_0x2014f0={'IkZYn':function(_0x34da30,_0xf306e6){return _0x201227['jIUhj'](_0x34da30,_0xf306e6);}};if(_0x39f51f)return console[_0x2fd243(0xae)](_0x2fd243(0xc6)+_0x2379b3+':',_0x39f51f[_0x2fd243(0xc1)]),_0xd62c14[_0x2fd243(0xc9)](0x1f4)[_0x2fd243(0xbe)]({'message':_0x201227[_0x2fd243(0xa8)]});const _0x1bf89d={};_0x52e6b7[_0x2fd243(0xa3)](_0x2454c5=>{const _0x49c89a=_0x2fd243;_0x1bf89d[_0x2454c5['sensor_id']]={'is_fetching':_0x2014f0['IkZYn'](_0x2454c5[_0x49c89a(0xc3)],0x1),'is_sending':_0x2014f0['IkZYn'](_0x2454c5['is_sending'],0x1)};}),_0xd62c14[_0x2fd243(0xc9)](0xc8)[_0x2fd243(0xbe)](_0x1bf89d);});};module['exports']={'getSubsiteIntervalStatus':getSubsiteIntervalStatus};