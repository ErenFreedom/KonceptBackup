const a3_0x3576b2=a3_0x58b0;function a3_0x15c9(){const _0x4637bf=['📦\x20Stored\x20Token\x20Length:','❌\x20Failed\x20to\x20insert\x20token:','FGTlk','569458itsIlq','5318481YnwCIj','qPtVT','📦\x20Stored\x20Token\x20Hash:','2224836oLOTKo','query','createHash','DB\x20error:\x20Token\x20insert','Username\x20and\x20Token\x20are\x20required','dhEEe','maSvk','NrHbT','Uyvgx','access_token','message','xFdzF','axios','DELETE\x20FROM\x20DesigoAuthTokens','INSERT\x20INTO\x20DesigoAuthTokens\x20(username,\x20token,\x20expires_at,\x20created_at)\x20VALUES\x20(?,\x20?,\x20?,\x20?)','SELECT\x20token,\x20expires_at\x20FROM\x20DesigoAuthTokens\x20WHERE\x20username\x20=\x20?','300pTaSuD','12428AyxFtH','post','kwAfa','OtJRe','&password=','expires_at','toISOString','encmP','10yEEEmA','ZzAKL','data','sha256','1299HaKkdZ','grant_type=password&username=','update','DB\x20error:\x20Token\x20delete','pGuRZ','🔑\x20Token\x20Length:','body','❌\x20Failed\x20to\x20delete\x20old\x20token:','❌\x20Error\x20deleting\x20token:','culss','❌\x20Error\x20fetching\x20Desigo\x20token:','ZKTax','aabfP','gOeOi','OKojP','aiLGO','Token\x20retrieved\x20successfully','length','ZdmTu','Failed\x20to\x20fetch\x20token\x20for\x20validation','run','🔐\x20Token\x20Hash:','warn','Agent','❌\x20Token\x20mismatch\x20after\x20DB\x20insert!','Invalid\x20response\x20from\x20Desigo\x20server','15393444zHgndS','eKPSy','huIab','../db/localDB','✅\x20Desigo\x20Token\x20Received:','ChbQy','config','Username\x20is\x20required','gvijk','ALGEb','application/x-www-form-urlencoded','Token\x20deleted\x20successfully','now','lBdeo','Fftrt','Failed\x20to\x20fetch\x20token','3CiIrJO','HeHQi','QIanh','dQmfv','DELETE\x20FROM\x20DesigoAuthTokens\x20WHERE\x20username\x20=\x20?','📝\x20Saving\x20Desigo\x20Token\x20for:','rwOiL','json','Database\x20error','lFoDQ','get','exports','❌\x20Error\x20saving\x20token:','Internal\x20error','yInnn','error','BmGmb','crypto','status','https','log','❌\x20Error\x20retrieving\x20stored\x20token:','aIKJV','WJPSF','QiOQN','9631464IcFNcH','Internal\x20Server\x20Error','149260efNtZy','serialize','zRkRw','response','digest','KaxMh','SMmLf'];a3_0x15c9=function(){return _0x4637bf;};return a3_0x15c9();}function a3_0x58b0(_0x49d066,_0x70bcd0){const _0x15c94b=a3_0x15c9();return a3_0x58b0=function(_0x58b0a4,_0x3c85c0){_0x58b0a4=_0x58b0a4-0x9e;let _0x6c4ff8=_0x15c94b[_0x58b0a4];return _0x6c4ff8;},a3_0x58b0(_0x49d066,_0x70bcd0);}(function(_0x5203c1,_0x1ef03d){const _0x160063=a3_0x58b0,_0x265234=_0x5203c1();while(!![]){try{const _0xada68d=-parseInt(_0x160063(0xfc))/0x1*(parseInt(_0x160063(0xb1))/0x2)+-parseInt(_0x160063(0xd2))/0x3*(parseInt(_0x160063(0xc6))/0x4)+-parseInt(_0x160063(0xa7))/0x5*(-parseInt(_0x160063(0xc5))/0x6)+-parseInt(_0x160063(0xb2))/0x7+parseInt(_0x160063(0xa5))/0x8+parseInt(_0x160063(0xb5))/0x9*(-parseInt(_0x160063(0xce))/0xa)+parseInt(_0x160063(0xec))/0xb;if(_0xada68d===_0x1ef03d)break;else _0x265234['push'](_0x265234['shift']());}catch(_0x36cfd8){_0x265234['push'](_0x265234['shift']());}}}(a3_0x15c9,0xd9258));const axios=require(a3_0x3576b2(0xc1)),db=require(a3_0x3576b2(0xef));require('dotenv')[a3_0x3576b2(0xf2)]();const https=require(a3_0x3576b2(0x9f)),crypto=require(a3_0x3576b2(0x10d)),saveDesigoToken=async(_0x372331,_0x1bf741)=>{const _0x5320c4=a3_0x3576b2,_0x1a860d={'Uyvgx':_0x5320c4(0xe5),'DIlxx':_0x5320c4(0xd1),'rwOiL':_0x5320c4(0xae),'SMmLf':function(_0x5811fd,_0x2bc0b0){return _0x5811fd===_0x2bc0b0;},'aabfP':'✅\x20Token\x20matched\x20exactly\x20after\x20DB\x20insert!','bxBDb':_0x5320c4(0xea),'lFoDQ':_0x5320c4(0xd9),'DqXDh':_0x5320c4(0xd5),'xFdzF':function(_0x56a759,_0x444414){return _0x56a759||_0x444414;},'qPtVT':_0x5320c4(0xb9),'dhEEe':function(_0x1de1ae,_0x5413b3){return _0x1de1ae+_0x5413b3;},'HeHQi':function(_0x57fc74,_0x18c881){return _0x57fc74*_0x18c881;},'pGuRZ':function(_0x19e965,_0x13b034){return _0x19e965*_0x13b034;},'wlunT':_0x5320c4(0x101),'kscnO':_0x5320c4(0xd7),'OKojP':_0x5320c4(0xe7),'culss':_0x5320c4(0x108),'gzeNl':_0x5320c4(0x109)};try{const {username:_0x1853a7,token:_0x18dae5}=_0x372331[_0x5320c4(0xd8)];if(_0x1a860d[_0x5320c4(0xc0)](!_0x1853a7,!_0x18dae5))return _0x1bf741[_0x5320c4(0x9e)](0x190)[_0x5320c4(0x103)]({'message':_0x1a860d[_0x5320c4(0xb3)]});const _0x1ced94=new Date()['toISOString'](),_0x5073d7=new Date(_0x1a860d[_0x5320c4(0xba)](Date[_0x5320c4(0xf8)](),_0x1a860d[_0x5320c4(0xfd)](_0x1a860d[_0x5320c4(0xd6)](0x6*0x3c,0x3c),0x3e8)))[_0x5320c4(0xcc)](),_0x265730=crypto[_0x5320c4(0xb7)](_0x5320c4(0xd1))['update'](_0x18dae5)[_0x5320c4(0xab)]('hex');console[_0x5320c4(0xa0)](_0x1a860d['wlunT'],_0x1853a7),console['log'](_0x1a860d['kscnO'],_0x18dae5[_0x5320c4(0xe3)]),console[_0x5320c4(0xa0)](_0x1a860d[_0x5320c4(0xe0)],_0x265730),db[_0x5320c4(0xa8)](()=>{const _0x20b326=_0x5320c4,_0x1bf96b={'maSvk':_0x20b326(0xaf),'kWWFP':_0x1a860d[_0x20b326(0xbd)],'VwBES':_0x1a860d['DIlxx'],'KaxMh':_0x1a860d[_0x20b326(0x102)],'CYbUi':_0x20b326(0xb4),'NrHbT':function(_0x5e13eb,_0x550a3a){const _0xe77330=_0x20b326;return _0x1a860d[_0xe77330(0xad)](_0x5e13eb,_0x550a3a);},'ZZwKi':_0x1a860d[_0x20b326(0xde)],'WJPSF':_0x1a860d['bxBDb'],'BmGmb':'Token\x20stored\x20and\x20verified.','kwAfa':_0x1a860d[_0x20b326(0x105)],'aiLGO':_0x1a860d['DqXDh']};db[_0x20b326(0xe6)](_0x20b326(0xc2),function(_0x5cb21f){const _0x51ea2f=_0x20b326,_0xcb40b3={'eKPSy':function(_0xbbc63e,_0x3524ae){return _0xbbc63e||_0x3524ae;},'VguXb':_0x1bf96b['kWWFP'],'aIKJV':_0x1bf96b['VwBES'],'ZzAKL':'hex','XwRkg':_0x1bf96b[_0x51ea2f(0xac)],'zRkRw':_0x1bf96b['CYbUi'],'QiOQN':function(_0x5d5abb,_0x27ff4e){const _0x28d171=_0x51ea2f;return _0x1bf96b[_0x28d171(0xbc)](_0x5d5abb,_0x27ff4e);},'QIanh':_0x1bf96b['ZZwKi'],'OtJRe':_0x1bf96b[_0x51ea2f(0xa3)],'FGTlk':_0x1bf96b[_0x51ea2f(0x10c)]};if(_0x5cb21f)return console[_0x51ea2f(0x10b)](_0x1bf96b[_0x51ea2f(0xc8)],_0x5cb21f[_0x51ea2f(0xbf)]),_0x1bf741[_0x51ea2f(0x9e)](0x1f4)[_0x51ea2f(0x103)]({'message':_0x1bf96b[_0x51ea2f(0xe1)]});db['run'](_0x51ea2f(0xc3),[_0x1853a7,_0x18dae5,_0x5073d7,_0x1ced94],function(_0x337074){const _0xf38d32=_0x51ea2f;if(_0x337074)return console[_0xf38d32(0x10b)](_0x1bf96b[_0xf38d32(0xbb)],_0x337074[_0xf38d32(0xbf)]),_0x1bf741['status'](0x1f4)[_0xf38d32(0x103)]({'message':_0xf38d32(0xb8),'error':_0x337074['message']});db[_0xf38d32(0x106)]('SELECT\x20token\x20FROM\x20DesigoAuthTokens\x20WHERE\x20username\x20=\x20?',[_0x1853a7],(_0x243b0f,_0x1eae84)=>{const _0x133464=_0xf38d32;if(_0xcb40b3[_0x133464(0xed)](_0x243b0f,!_0x1eae84))return _0x1bf741[_0x133464(0x9e)](0x1f4)[_0x133464(0x103)]({'message':_0xcb40b3['VguXb']});const _0x45c0be=_0x1eae84['token'],_0x1403ac=crypto[_0x133464(0xb7)](_0xcb40b3[_0x133464(0xa2)])[_0x133464(0xd4)](_0x45c0be)[_0x133464(0xab)](_0xcb40b3[_0x133464(0xcf)]);return console[_0x133464(0xa0)](_0xcb40b3['XwRkg'],_0x45c0be['length']),console[_0x133464(0xa0)](_0xcb40b3[_0x133464(0xa9)],_0x1403ac),_0xcb40b3[_0x133464(0xa4)](_0x45c0be,_0x18dae5)?console[_0x133464(0xa0)](_0xcb40b3[_0x133464(0xfe)]):console[_0x133464(0xe8)](_0xcb40b3[_0x133464(0xc9)]),_0x1bf741['status'](0xc8)[_0x133464(0x103)]({'message':_0xcb40b3[_0x133464(0xb0)]});});});});});}catch(_0x5715e9){return console['error'](_0x1a860d[_0x5320c4(0xdb)],_0x5715e9['message']),_0x1bf741['status'](0x1f4)[_0x5320c4(0x103)]({'message':_0x1a860d['gzeNl'],'error':_0x5715e9[_0x5320c4(0xbf)]});}},getDesigoAuthToken=async(_0x5688b6,_0x42a56f)=>{const _0x1931d6=a3_0x3576b2,_0x323ef2={'xNVVY':function(_0x22679b,_0x1fc4df){return _0x22679b||_0x1fc4df;},'lBdeo':'API\x20URL,\x20Username,\x20and\x20Password\x20are\x20required','ChbQy':'🔍\x20Requesting\x20token\x20from\x20Desigo\x20Server:','gvijk':_0x1931d6(0xf6),'dQmfv':_0x1931d6(0xeb),'yInnn':_0x1931d6(0xf0),'encmP':_0x1931d6(0xe2),'huIab':_0x1931d6(0xdc)};try{const {apiUrl:_0x54a1fd,username:_0x58b21c,password:_0x34ba78}=_0x5688b6[_0x1931d6(0xd8)];if(_0x323ef2['xNVVY'](!_0x54a1fd,!_0x58b21c)||!_0x34ba78)return _0x42a56f[_0x1931d6(0x9e)](0x190)[_0x1931d6(0x103)]({'message':_0x323ef2[_0x1931d6(0xf9)]});console[_0x1931d6(0xa0)](_0x323ef2[_0x1931d6(0xf1)],_0x54a1fd);const _0x485a4a=new https[(_0x1931d6(0xe9))]({'rejectUnauthorized':![]}),_0x186b7e=_0x1931d6(0xd3)+_0x58b21c+_0x1931d6(0xca)+_0x34ba78,_0x51e5d4=await axios[_0x1931d6(0xc7)](_0x54a1fd,_0x186b7e,{'headers':{'Content-Type':_0x323ef2[_0x1931d6(0xf4)]},'httpsAgent':_0x485a4a});if(!_0x51e5d4[_0x1931d6(0xd0)]||!_0x51e5d4[_0x1931d6(0xd0)]['access_token'])return _0x42a56f[_0x1931d6(0x9e)](0x1f4)['json']({'message':_0x323ef2[_0x1931d6(0xff)]});const _0x29d698=_0x51e5d4[_0x1931d6(0xd0)][_0x1931d6(0xbe)];console[_0x1931d6(0xa0)](_0x323ef2[_0x1931d6(0x10a)],_0x29d698),_0x42a56f['status'](0xc8)['json']({'message':_0x323ef2[_0x1931d6(0xcd)],'accessToken':_0x29d698});}catch(_0x391028){console[_0x1931d6(0x10b)](_0x323ef2[_0x1931d6(0xee)],_0x391028[_0x1931d6(0xaa)]?.[_0x1931d6(0xd0)]||_0x391028[_0x1931d6(0xbf)]),_0x42a56f[_0x1931d6(0x9e)](_0x391028[_0x1931d6(0xaa)]?.[_0x1931d6(0x9e)]||0x1f4)[_0x1931d6(0x103)]({'message':_0x1931d6(0xfb),'error':_0x391028[_0x1931d6(0xaa)]?.[_0x1931d6(0xd0)]||_0x391028[_0x1931d6(0xbf)]});}},getStoredDesigoToken=async(_0x2f7427,_0x3cb614)=>{const _0x3990c1=a3_0x3576b2,_0x51c0de={'ZKTax':'❌\x20Error\x20retrieving\x20Desigo\x20token:','AwFeP':_0x3990c1(0x104),'QIoqO':_0x3990c1(0xf3),'gOeOi':_0x3990c1(0xa1),'ALGEb':_0x3990c1(0xa6)};try{const {username:_0x419208}=_0x2f7427[_0x3990c1(0xb6)];if(!_0x419208)return _0x3cb614[_0x3990c1(0x9e)](0x190)[_0x3990c1(0x103)]({'message':_0x51c0de['QIoqO']});db[_0x3990c1(0x106)](_0x3990c1(0xc4),[_0x419208],(_0x2e8fff,_0x3a79da)=>{const _0x679982=_0x3990c1;if(_0x2e8fff)return console['error'](_0x51c0de[_0x679982(0xdd)],_0x2e8fff[_0x679982(0xbf)]),_0x3cb614['status'](0x1f4)[_0x679982(0x103)]({'message':_0x51c0de['AwFeP'],'error':_0x2e8fff[_0x679982(0xbf)]});if(!_0x3a79da)return _0x3cb614[_0x679982(0x9e)](0x194)[_0x679982(0x103)]({'message':'No\x20token\x20found\x20for\x20this\x20user'});_0x3cb614[_0x679982(0x9e)](0xc8)[_0x679982(0x103)]({'token':_0x3a79da['token'],'expiresAt':_0x3a79da[_0x679982(0xcb)]});});}catch(_0x4b110e){console[_0x3990c1(0x10b)](_0x51c0de[_0x3990c1(0xdf)],_0x4b110e['message']),_0x3cb614['status'](0x1f4)['json']({'message':_0x51c0de[_0x3990c1(0xf5)],'error':_0x4b110e[_0x3990c1(0xbf)]});}},deleteDesigoToken=async(_0x41d5f0,_0x5815d2)=>{const _0x3e29bf=a3_0x3576b2,_0x3d2223={'Fftrt':'❌\x20Error\x20deleting\x20Desigo\x20token:','ZdmTu':_0x3e29bf(0xf7),'seaeP':'Username\x20is\x20required','MOTQv':_0x3e29bf(0xa6)};try{const {username:_0x148e08}=_0x41d5f0[_0x3e29bf(0xd8)];if(!_0x148e08)return _0x5815d2['status'](0x190)['json']({'message':_0x3d2223['seaeP']});db['run'](_0x3e29bf(0x100),[_0x148e08],_0x4d8e7d=>{const _0x3f9707=_0x3e29bf;if(_0x4d8e7d)return console[_0x3f9707(0x10b)](_0x3d2223[_0x3f9707(0xfa)],_0x4d8e7d[_0x3f9707(0xbf)]),_0x5815d2['status'](0x1f4)[_0x3f9707(0x103)]({'message':'Database\x20error','error':_0x4d8e7d[_0x3f9707(0xbf)]});_0x5815d2[_0x3f9707(0x9e)](0xc8)[_0x3f9707(0x103)]({'message':_0x3d2223[_0x3f9707(0xe4)]});});}catch(_0x2ffd9e){console[_0x3e29bf(0x10b)](_0x3e29bf(0xda),_0x2ffd9e[_0x3e29bf(0xbf)]),_0x5815d2[_0x3e29bf(0x9e)](0x1f4)[_0x3e29bf(0x103)]({'message':_0x3d2223['MOTQv'],'error':_0x2ffd9e[_0x3e29bf(0xbf)]});}};module[a3_0x3576b2(0x107)]={'getDesigoAuthToken':getDesigoAuthToken,'getStoredDesigoToken':getStoredDesigoToken,'deleteDesigoToken':deleteDesigoToken,'saveDesigoToken':saveDesigoToken};