const a1_0x3c0169=a1_0xc746;(function(_0x452a28,_0x39abf9){const _0x49fddf=a1_0xc746,_0x6a318d=_0x452a28();while(!![]){try{const _0x4c929e=-parseInt(_0x49fddf(0x199))/0x1*(parseInt(_0x49fddf(0x185))/0x2)+-parseInt(_0x49fddf(0x16a))/0x3+-parseInt(_0x49fddf(0x171))/0x4+-parseInt(_0x49fddf(0x19c))/0x5*(-parseInt(_0x49fddf(0x170))/0x6)+parseInt(_0x49fddf(0x189))/0x7*(-parseInt(_0x49fddf(0x182))/0x8)+-parseInt(_0x49fddf(0x191))/0x9*(parseInt(_0x49fddf(0x19a))/0xa)+parseInt(_0x49fddf(0x17e))/0xb*(parseInt(_0x49fddf(0x178))/0xc);if(_0x4c929e===_0x39abf9)break;else _0x6a318d['push'](_0x6a318d['shift']());}catch(_0x1d960d){_0x6a318d['push'](_0x6a318d['shift']());}}}(a1_0xbfd1,0xea077));const axios=require(a1_0x3c0169(0x192)),jwt=require(a1_0x3c0169(0x18f));function a1_0xbfd1(){const _0x83370b=['❌\x20Failed\x20to\x20update\x20LocalSensorAPIs\x20ID=','Bearer\x20','../db/sensorDB','log','2jrFgir','31410VpgDdN','warn','6270slAQKb','length','SELECT\x20id\x20FROM\x20LocalSensorBank\x20WHERE\x20object_id\x20=\x20?','exports','JMZhU','UPDATE\x20LocalActiveSensors\x20SET\x20bank_id\x20=\x20?\x20WHERE\x20bank_id\x20=\x20?','/api/sensors/list','env','3357018mnnaaE','SELECT\x20token\x20FROM\x20AuthTokens\x20ORDER\x20BY\x20id\x20DESC\x20LIMIT\x201','YnUGk','config','verify','sensors','3366GffYdo','3216148EqAihc','❌\x20Failed\x20to\x20update\x20LocalSensorBank\x20ID=','token','JWT_SECRET_APP','CLOUD_API_URL','message','\x20→\x20cloud=','1020nmVGfI','uazct','companyId','qSZXW','forEach','❌\x20No\x20stored\x20token\x20found','865293FIbAKg','oVfII','UPDATE\x20LocalSensorBank\x20SET\x20id\x20=\x20?\x20WHERE\x20id\x20=\x20?','error','223568gHEVBG','RCCvS','✅\x20Synced\x20IDs\x20for\x20object_id=','1881734pNGYHJ','lbpHz','get','zREeH','259gHiXAZ','data','❌\x20Error\x20reading\x20LocalSensorBank\x20for\x20object_id=','❌\x20Failed\x20to\x20update\x20LocalActiveSensors\x20ID=','RkJKP','iJVxt','jsonwebtoken','Uaeak','4563Dmbupe','axios','run','kEdAG'];a1_0xbfd1=function(){return _0x83370b;};return a1_0xbfd1();}require('dotenv')[a1_0x3c0169(0x16d)]();const {db}=require(a1_0x3c0169(0x197)),getStoredToken=()=>{const _0x24808a=a1_0x3c0169,_0x669dff={'YnUGk':function(_0x8e7ec9,_0x2801b1){return _0x8e7ec9||_0x2801b1;},'Uaeak':_0x24808a(0x16b)};return new Promise((_0x15ebdf,_0x4048db)=>{const _0x393423=_0x24808a,_0x224efa={'BHvEw':function(_0x1a3095,_0x55373f){const _0xfc6f98=a1_0xc746;return _0x669dff[_0xfc6f98(0x16c)](_0x1a3095,_0x55373f);},'uazct':_0x393423(0x17d),'zREeH':function(_0x33d83b,_0x405346){return _0x33d83b(_0x405346);}};db['get'](_0x669dff[_0x393423(0x190)],[],(_0x108c25,_0x356d14)=>{const _0x586794=_0x393423;if(_0x224efa['BHvEw'](_0x108c25,!_0x356d14))return _0x4048db(_0x224efa[_0x586794(0x179)]);_0x224efa[_0x586794(0x188)](_0x15ebdf,_0x356d14[_0x586794(0x173)]);});});},getCompanyIdFromToken=async()=>{const _0x543f8b=a1_0x3c0169,_0x4ab344=await getStoredToken(),_0x3c9180=jwt[_0x543f8b(0x16e)](_0x4ab344,process[_0x543f8b(0x169)][_0x543f8b(0x174)]);return{'token':_0x4ab344,'companyId':_0x3c9180[_0x543f8b(0x17a)]};},fetchCloudSensors=async _0x32a930=>{const _0xdf3815=a1_0x3c0169,_0x187471=process[_0xdf3815(0x169)][_0xdf3815(0x175)]+_0xdf3815(0x168),_0x38f9d0=await axios[_0xdf3815(0x187)](_0x187471,{'headers':{'Authorization':_0xdf3815(0x196)+_0x32a930}});return _0x38f9d0[_0xdf3815(0x18a)]?.[_0xdf3815(0x16f)]||[];},syncAllSensorTables=async()=>{const _0x35008f=a1_0x3c0169,_0xdec53e={'EKeiu':_0x35008f(0x19e),'RCCvS':function(_0x34d88e,_0x58913e){return _0x34d88e===_0x58913e;},'RkJKP':'UPDATE\x20LocalSensorAPIs\x20SET\x20sensor_id\x20=\x20?\x20WHERE\x20sensor_id\x20=\x20?','oVfII':function(_0x39265f){return _0x39265f();},'lbpHz':'⚠\x20No\x20sensors\x20received\x20from\x20Cloud.','mvSBV':'✅\x20Sensor\x20ID\x20sync\x20across\x20local\x20tables\x20completed.','JMZhU':'❌\x20syncAllSensorTables\x20error:'};try{const {token:_0x5c309b}=await _0xdec53e[_0x35008f(0x17f)](getCompanyIdFromToken),_0x54cb0d=await fetchCloudSensors(_0x5c309b);if(_0xdec53e[_0x35008f(0x183)](_0x54cb0d[_0x35008f(0x19d)],0x0)){console[_0x35008f(0x19b)](_0xdec53e[_0x35008f(0x186)]);return;}db['serialize'](()=>{const _0xfff492=_0x35008f,_0x15211a={'qSZXW':function(_0x3ba2f9,_0x4c1e84){const _0x680d55=a1_0xc746;return _0xdec53e[_0x680d55(0x183)](_0x3ba2f9,_0x4c1e84);},'ZbjBO':_0xfff492(0x180),'kEdAG':_0xfff492(0x1a1),'iJVxt':_0xdec53e[_0xfff492(0x18d)]};_0x54cb0d[_0xfff492(0x17c)](({id:_0x38619a,object_id:_0x1cd072})=>{const _0x1c03a8=_0xfff492;if(!_0x1cd072)return;db[_0x1c03a8(0x187)](_0xdec53e['EKeiu'],[_0x1cd072],(_0xfa4e96,_0x3c7ca1)=>{const _0x3113bf=_0x1c03a8;if(_0xfa4e96)return console[_0x3113bf(0x181)](_0x3113bf(0x18b)+_0x1cd072+':',_0xfa4e96['message']);if(!_0x3c7ca1)return;const _0x551be5=_0x3c7ca1['id'];if(_0x15211a[_0x3113bf(0x17b)](_0x551be5,_0x38619a))return;db[_0x3113bf(0x193)](_0x15211a['ZbjBO'],[_0x38619a,_0x551be5],_0x4d25d2=>{const _0x1c3f19=_0x3113bf;if(_0x4d25d2)console['error'](_0x1c3f19(0x172)+_0x551be5+':',_0x4d25d2[_0x1c3f19(0x176)]);}),db[_0x3113bf(0x193)](_0x15211a[_0x3113bf(0x194)],[_0x38619a,_0x551be5],_0x528474=>{const _0x2539af=_0x3113bf;if(_0x528474)console[_0x2539af(0x181)](_0x2539af(0x18c)+_0x551be5+':',_0x528474[_0x2539af(0x176)]);}),db[_0x3113bf(0x193)](_0x15211a[_0x3113bf(0x18e)],[_0x38619a,_0x551be5],_0x4dc414=>{const _0x507d63=_0x3113bf;if(_0x4dc414)console[_0x507d63(0x181)](_0x507d63(0x195)+_0x551be5+':',_0x4dc414[_0x507d63(0x176)]);}),console[_0x3113bf(0x198)](_0x3113bf(0x184)+_0x1cd072+':\x20local='+_0x551be5+_0x3113bf(0x177)+_0x38619a);});});}),console[_0x35008f(0x198)](_0xdec53e['mvSBV']);}catch(_0x4d8e85){console[_0x35008f(0x181)](_0xdec53e[_0x35008f(0x1a0)],_0x4d8e85[_0x35008f(0x176)]||_0x4d8e85);}};function a1_0xc746(_0x5a5399,_0x1d7c33){const _0xbfd12a=a1_0xbfd1();return a1_0xc746=function(_0xc74613,_0x109753){_0xc74613=_0xc74613-0x168;let _0x86363a=_0xbfd12a[_0xc74613];return _0x86363a;},a1_0xc746(_0x5a5399,_0x1d7c33);}module[a1_0x3c0169(0x19f)]={'syncAllSensorTables':syncAllSensorTables};