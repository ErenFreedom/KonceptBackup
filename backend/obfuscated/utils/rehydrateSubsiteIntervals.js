const a0_0x521c06=a0_0x3acd;(function(_0x1394a0,_0x3bccae){const _0x2bde11=a0_0x3acd,_0x343608=_0x1394a0();while(!![]){try{const _0x52c04c=parseInt(_0x2bde11(0x148))/0x1+parseInt(_0x2bde11(0x12b))/0x2+parseInt(_0x2bde11(0x12d))/0x3+parseInt(_0x2bde11(0x139))/0x4+-parseInt(_0x2bde11(0x12c))/0x5*(-parseInt(_0x2bde11(0x154))/0x6)+-parseInt(_0x2bde11(0x147))/0x7+-parseInt(_0x2bde11(0x13f))/0x8*(parseInt(_0x2bde11(0x145))/0x9);if(_0x52c04c===_0x3bccae)break;else _0x343608['push'](_0x343608['shift']());}catch(_0x2ffb41){_0x343608['push'](_0x343608['shift']());}}}(a0_0x111d,0xea4bb));const {db}=require('../db/sensorDB'),intervalManager=require(a0_0x521c06(0x13a)),{insertSubsiteLog}=require(a0_0x521c06(0x149)),getAllCompanySubsitePairs=()=>{const _0x394ba9={'NMMuL':function(_0x100ec5,_0x3e7145){return _0x100ec5(_0x3e7145);}};return new Promise((_0x6cb450,_0x954672)=>{const _0x2826a4=a0_0x3acd;db[_0x2826a4(0x153)](_0x2826a4(0x131),[],(_0x4b07c,_0x330be8)=>{const _0xe4a797=_0x2826a4;if(_0x4b07c)return _0x394ba9['NMMuL'](_0x954672,_0x4b07c);const _0x2e46a9=_0x330be8[_0xe4a797(0x132)](_0x4902ff=>{const _0x3edf4c=_0xe4a797,_0x2b21cc=_0x4902ff[_0x3edf4c(0x12f)][_0x3edf4c(0x136)]('_');return{'companyId':_0x2b21cc[0x1],'subsiteId':_0x2b21cc[0x2]};});_0x394ba9['NMMuL'](_0x6cb450,_0x2e46a9);});});},rehydrateSubsiteIntervals=async(_0x207df5,_0x236b85)=>{const _0x2b4c1a=a0_0x521c06,_0x5366f4={'IlgJU':function(_0x388712,_0x1f1b00){return _0x388712===_0x1f1b00;},'IWycD':function(_0xe5b5c7,_0xd7aa58,_0x58dd00,_0x4f0d8e,_0xd8b6bb){return _0xe5b5c7(_0xd7aa58,_0x58dd00,_0x4f0d8e,_0xd8b6bb);},'VcEFp':_0x2b4c1a(0x144)},_0x24be55=_0x2b4c1a(0x140)+_0x207df5+'_'+_0x236b85,_0x1749fa=_0x2b4c1a(0x13b)+_0x207df5+'_'+_0x236b85;db[_0x2b4c1a(0x153)](_0x2b4c1a(0x13e)+_0x24be55+_0x2b4c1a(0x13c)+_0x1749fa+_0x2b4c1a(0x12a),[],(_0xed17c2,_0x43a028)=>{const _0x29b6ea=_0x2b4c1a,_0x1856a5={'BZAAY':function(_0xc6fd4f,_0x6fa833){return _0xc6fd4f||_0x6fa833;},'pmIoU':function(_0x5e5444,_0xe35bc8){const _0x1c9e95=a0_0x3acd;return _0x5366f4[_0x1c9e95(0x138)](_0x5e5444,_0xe35bc8);},'pLtCq':function(_0xb6d8e2,_0x1a14ea){return _0xb6d8e2*_0x1a14ea;},'FjqTp':function(_0x440da1,_0x3bba0e,_0x177d2f,_0x3d9054,_0x5085e1){return _0x5366f4['IWycD'](_0x440da1,_0x3bba0e,_0x177d2f,_0x3d9054,_0x5085e1);},'JTOpu':_0x5366f4[_0x29b6ea(0x14c)]};if(_0xed17c2){console[_0x29b6ea(0x14f)]('❌\x20Failed\x20to\x20rehydrate\x20for\x20'+_0x207df5+'-'+_0x236b85+':',_0xed17c2[_0x29b6ea(0x151)]);return;}_0x43a028[_0x29b6ea(0x135)](_0x7ff3bd=>{const _0x4b9b8a=_0x29b6ea,_0x22f7a8={'ylwpZ':function(_0x5a1958,_0x16974e){const _0x376126=a0_0x3acd;return _0x1856a5[_0x376126(0x12e)](_0x5a1958,_0x16974e);},'VujSX':function(_0x2eff6a,_0x78c061){const _0x56aad2=a0_0x3acd;return _0x1856a5[_0x56aad2(0x129)](_0x2eff6a,_0x78c061);},'Nxwyp':function(_0x2d7f37,_0x5323d2){const _0x36facb=a0_0x3acd;return _0x1856a5[_0x36facb(0x13d)](_0x2d7f37,_0x5323d2);},'hqScn':function(_0xc2f79e,_0x40c60e,_0x301967,_0x30b345,_0x394ef){return _0x1856a5['FjqTp'](_0xc2f79e,_0x40c60e,_0x301967,_0x30b345,_0x394ef);},'hUwgo':_0x4b9b8a(0x130),'jkgww':function(_0x3b8730,_0x3bd519){return _0x3b8730*_0x3bd519;},'nKEYj':function(_0x57b480,_0x54058f,_0x1fc2b7,_0x2adacc,_0x594cbc){const _0x3805bb=_0x4b9b8a;return _0x1856a5[_0x3805bb(0x141)](_0x57b480,_0x54058f,_0x1fc2b7,_0x2adacc,_0x594cbc);},'LvdQi':_0x1856a5[_0x4b9b8a(0x142)]},{bank_id:_0x34b863,interval_seconds:_0x105298}=_0x7ff3bd;db[_0x4b9b8a(0x150)](_0x4b9b8a(0x137)+_0x1749fa+'\x20c\x20JOIN\x20'+_0x24be55+_0x4b9b8a(0x14a),[_0x34b863],(_0x39d617,_0x8b3bc6)=>{const _0x2c4cab=_0x4b9b8a;if(_0x22f7a8[_0x2c4cab(0x146)](_0x39d617,!_0x8b3bc6))return;_0x22f7a8[_0x2c4cab(0x134)](_0x8b3bc6[_0x2c4cab(0x128)],0x1)&&(intervalManager[_0x2c4cab(0x14b)](_0x34b863,_0x22f7a8['Nxwyp'](_0x105298,0x3e8),_0x207df5,_0x236b85),_0x22f7a8[_0x2c4cab(0x14e)](insertSubsiteLog,_0x34b863,_0x22f7a8['hUwgo'],_0x207df5,_0x236b85)),_0x8b3bc6[_0x2c4cab(0x143)]===0x1&&(intervalManager['startSend'](_0x34b863,_0x207df5,_0x236b85,_0x22f7a8[_0x2c4cab(0x14d)](_0x105298,0x3e8)),_0x22f7a8[_0x2c4cab(0x152)](insertSubsiteLog,_0x34b863,_0x22f7a8['LvdQi'],_0x207df5,_0x236b85));});});});};module[a0_0x521c06(0x133)]={'rehydrateSubsiteIntervals':rehydrateSubsiteIntervals,'getAllCompanySubsitePairs':getAllCompanySubsitePairs};function a0_0x3acd(_0x6efd66,_0xf694ac){const _0x111d74=a0_0x111d();return a0_0x3acd=function(_0x3acdff,_0x58e6a6){_0x3acdff=_0x3acdff-0x128;let _0x578564=_0x111d74[_0x3acdff];return _0x578564;},a0_0x3acd(_0x6efd66,_0xf694ac);}function a0_0x111d(){const _0x45323c=['45005AaksIO','126735OalocR','BZAAY','name','♻️\x20Rehydrated\x20fetching\x20job','SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27\x20AND\x20name\x20LIKE\x20\x27Sensor_%_%\x27','map','exports','VujSX','forEach','split','SELECT\x20is_fetching,\x20is_sending\x20FROM\x20','IlgJU','2536516EtIMGg','./intervalManagerSubSite','IntervalControl_','\x20s\x0a\x20\x20\x20\x20\x20JOIN\x20','pLtCq','SELECT\x20s.bank_id,\x20s.interval_seconds,\x20s.batch_size\x20\x0a\x20\x20\x20\x20\x20FROM\x20','32xNNclZ','Sensor_','FjqTp','JTOpu','is_sending','♻️\x20Rehydrated\x20sending\x20job','6635079UuluOu','ylwpZ','11358151XNLGRZ','1633369DyfAel','./logHelpersSubSite','\x20s\x20ON\x20c.sensor_id\x20=\x20s.id\x20WHERE\x20s.bank_id\x20=\x20?','startFetch','VcEFp','jkgww','hqScn','error','get','message','nKEYj','all','1014hNAwJL','is_fetching','pmIoU','\x20c\x20ON\x20s.id\x20=\x20c.sensor_id\x0a\x20\x20\x20\x20\x20WHERE\x20s.is_active\x20=\x201\x20AND\x20(c.is_fetching\x20=\x201\x20OR\x20c.is_sending\x20=\x201)','3400560dHvUNR'];a0_0x111d=function(){return _0x45323c;};return a0_0x111d();}