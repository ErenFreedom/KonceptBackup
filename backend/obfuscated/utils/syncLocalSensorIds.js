const a3_0x22e1a7=a3_0x35e3;(function(_0x5de218,_0x9a4744){const _0x408124=a3_0x35e3,_0x50038a=_0x5de218();while(!![]){try{const _0x47e87c=parseInt(_0x408124(0xea))/0x1*(-parseInt(_0x408124(0xe0))/0x2)+parseInt(_0x408124(0x102))/0x3+parseInt(_0x408124(0xd7))/0x4*(-parseInt(_0x408124(0xf3))/0x5)+parseInt(_0x408124(0xce))/0x6*(parseInt(_0x408124(0xcd))/0x7)+-parseInt(_0x408124(0x100))/0x8*(-parseInt(_0x408124(0xd3))/0x9)+-parseInt(_0x408124(0x103))/0xa+parseInt(_0x408124(0xe4))/0xb;if(_0x47e87c===_0x9a4744)break;else _0x50038a['push'](_0x50038a['shift']());}catch(_0x4bdd63){_0x50038a['push'](_0x50038a['shift']());}}}(a3_0x4dce,0xdae9b));const axios=require('axios'),jwt=require(a3_0x22e1a7(0xdf));function a3_0x35e3(_0xafca1a,_0x17de11){const _0x4dce38=a3_0x4dce();return a3_0x35e3=function(_0x35e347,_0x221441){_0x35e347=_0x35e347-0xcc;let _0x282b9d=_0x4dce38[_0x35e347];return _0x282b9d;},a3_0x35e3(_0xafca1a,_0x17de11);}require('dotenv')[a3_0x22e1a7(0xff)]();const {db}=require(a3_0x22e1a7(0xd5)),getStoredToken=()=>{const _0x5570=a3_0x22e1a7,_0x3ded13={'BhvLc':'‚ùå\x20Error\x20fetching\x20token:','HVpWV':function(_0xacb2b0,_0x23b882){return _0xacb2b0(_0x23b882);},'tgvNy':'Error\x20fetching\x20token\x20from\x20database','CMSRd':_0x5570(0xe1)};return new Promise((_0x4f11b4,_0x212144)=>{const _0x28d3aa=_0x5570;db[_0x28d3aa(0xe5)](_0x28d3aa(0xec),[],(_0x42fc2e,_0x3ba5ef)=>{const _0x28b268=_0x28d3aa;if(_0x42fc2e)console[_0x28b268(0xed)](_0x3ded13[_0x28b268(0xf7)],_0x42fc2e['message']),_0x3ded13[_0x28b268(0xeb)](_0x212144,_0x3ded13['tgvNy']);else!_0x3ba5ef?_0x3ded13[_0x28b268(0xeb)](_0x212144,_0x3ded13[_0x28b268(0xfd)]):_0x3ded13['HVpWV'](_0x4f11b4,_0x3ba5ef[_0x28b268(0xe2)]);});});},getCompanyIdFromToken=async()=>{const _0x245390=a3_0x22e1a7,_0x373d0e={'GcYdE':function(_0x201072){return _0x201072();},'JmNtQ':_0x245390(0xfe),'boxLq':_0x245390(0xd9)};try{const _0x3fa057=await _0x373d0e[_0x245390(0xf4)](getStoredToken),_0x2d499a=jwt[_0x245390(0xdd)](_0x3fa057,process[_0x245390(0xcf)]['JWT_SECRET_APP']);return console['log'](_0x245390(0xfc)+_0x2d499a['companyId']),{'token':_0x3fa057,'companyId':_0x2d499a[_0x245390(0xe8)]};}catch(_0x4f02bc){console[_0x245390(0xed)](_0x373d0e[_0x245390(0xdb)],_0x4f02bc['message']);throw new Error(_0x373d0e['boxLq']);}},fetchCloudSensors=async _0x35f834=>{const _0x1adbe8=a3_0x22e1a7,_0x47d8c8={'rrLal':function(_0x4ed391,_0x2784ea){return _0x4ed391===_0x2784ea;},'bQyJN':_0x1adbe8(0xef),'rUdIr':_0x1adbe8(0xe6),'lutvr':_0x1adbe8(0xe3)};try{const _0x3d986f=process['env'][_0x1adbe8(0xf2)]+_0x1adbe8(0xf5);console['log'](_0x1adbe8(0xd2)+_0x3d986f);const _0x2cd81f=await axios[_0x1adbe8(0xe5)](_0x3d986f,{'headers':{'Authorization':'Bearer\x20'+_0x35f834}});if(!_0x2cd81f['data'][_0x1adbe8(0xe9)]||_0x47d8c8[_0x1adbe8(0x105)](_0x2cd81f[_0x1adbe8(0xf9)]['sensors'][_0x1adbe8(0xf0)],0x0))return console['log'](_0x47d8c8[_0x1adbe8(0x101)]),[];return console['log'](_0x1adbe8(0xd6)+_0x2cd81f['data'][_0x1adbe8(0xe9)]['length']+'\x20sensors\x20from\x20Cloud.'),_0x2cd81f[_0x1adbe8(0xf9)][_0x1adbe8(0xe9)];}catch(_0xf7f3c3){console['error'](_0x47d8c8[_0x1adbe8(0xf1)],_0xf7f3c3[_0x1adbe8(0xfb)]?.['data']||_0xf7f3c3[_0x1adbe8(0xcc)]);throw new Error(_0x47d8c8[_0x1adbe8(0xd0)]);}},updateLocalSensorIds=async()=>{const _0x187858=a3_0x22e1a7,_0x5a04f9={'QWgyJ':function(_0x2a7fa3,_0x1690fe){return _0x2a7fa3===_0x1690fe;},'nqzxe':_0x187858(0xd1)};try{const {token:_0x38c84f,companyId:_0x3e9f3e}=await getCompanyIdFromToken(),_0x4b4bd3=await fetchCloudSensors(_0x38c84f);if(_0x5a04f9[_0x187858(0xde)](_0x4b4bd3[_0x187858(0xf0)],0x0)){console[_0x187858(0xe7)](_0x187858(0xd8));return;}_0x4b4bd3[_0x187858(0xda)](_0x47f5b3=>{const _0x35f4f6=_0x187858;db[_0x35f4f6(0xf8)](_0x35f4f6(0xdc),[_0x47f5b3['id'],_0x47f5b3['object_id']],_0x134367=>{const _0x491049=_0x35f4f6;_0x134367?console['error'](_0x491049(0xee)+_0x47f5b3[_0x491049(0xd4)]+':',_0x134367['message']):console[_0x491049(0xe7)]('‚úÖ\x20Updated\x20Local\x20SensorBank:\x20object_id='+_0x47f5b3['object_id']+_0x491049(0x104)+_0x47f5b3['id']);});}),console[_0x187858(0xe7)](_0x5a04f9[_0x187858(0xfa)]);}catch(_0x4b0fa3){console[_0x187858(0xed)](_0x187858(0xf6),_0x4b0fa3[_0x187858(0xcc)]);}};module[a3_0x22e1a7(0x106)]={'updateLocalSensorIds':updateLocalSensorIds};function a3_0x4dce(){const _0x46974a=['bQyJN','402699InMxKy','11525090qMwvQw','\x20‚Üí\x20id=','rrLal','exports','message','66409vKFEyB','78pTYADM','env','lutvr','‚úÖ\x20ID\x20Sync\x20completed\x20successfully!','üì§\x20Fetching\x20sensors\x20from\x20Cloud:\x20','18CEDahq','object_id','../db/sensorDB','‚úÖ\x20Received\x20','4PTmsBy','‚ö†\x20No\x20sensors\x20to\x20update\x20in\x20Local\x20DB.','Invalid\x20token','forEach','JmNtQ','UPDATE\x20LocalSensorBank\x20SET\x20id\x20=\x20?\x20WHERE\x20object_id\x20=\x20?','verify','QWgyJ','jsonwebtoken','2AqQxRg','No\x20stored\x20token\x20found.','token','Failed\x20to\x20fetch\x20sensors\x20from\x20Cloud\x20DB','40889365tmwVRR','get','‚ùå\x20Error\x20fetching\x20sensors\x20from\x20Cloud:','log','companyId','sensors','974402ubvMmb','HVpWV','SELECT\x20token\x20FROM\x20AuthTokens\x20ORDER\x20BY\x20id\x20DESC\x20LIMIT\x201','error','‚ùå\x20Error\x20updating\x20Sensor\x20ID\x20for\x20','‚ö†\x20No\x20sensors\x20found\x20in\x20Cloud\x20DB.','length','rUdIr','CLOUD_API_URL','6600275kkQHEO','GcYdE','/api/sensors/list','‚ùå\x20Error\x20syncing\x20Local\x20Sensor\x20IDs:','BhvLc','run','data','nqzxe','response','üîç\x20Extracted\x20companyId:\x20','CMSRd','‚ùå\x20Error\x20decoding\x20JWT:','config','1475416kPpBOg'];a3_0x4dce=function(){return _0x46974a;};return a3_0x4dce();}